	.FILE	'CARN.ASM'
;RANDOMIZE, ADJUST DIFFICULTY OF ELECTROCUTION SCENE
;SOUNDS CYC AT INITIALS

;NOFL	CLR	A0			;CORRECT?
;	MOVE	A0,@IRQSKYE		;BLACK BACKGROUND BEHIND DICTATOR

;   .WORD   032H	;>C0000010 -- HEBLNK	;WAS A 2DH!! IN MAIN.ASM
;FINAL RELEASE CHANGES:
;FACCHECK IN MENU.ASM SHOULD SLEEP 60 NOT 1
;SORT RECTANGLE CHECKS! GET OUT OF SORT SOONER!

	.TITLE	'TOTAL CARNAGE GAME PROGRAM'
	.WIDTH	132
	.OPTION	B,D,L,T
	.MNOLIST
;
; INITIATED:		 JULY 17,1990
; MODIFIED:		 !
; SOFTWARE:		 MARK TURMELL
;
; COPYRIGHT (C) 1990 WILLIAMS ELECTRONICS GAMES, INC.
;
;
; GET THE SYSTEM STUFF

	.INCLUDE	"MPROC.EQU"		;MPROC EQUATES
	.INCLUDE	"DISP.EQU"		;DISPLAY PROC. EQUATES
	.INCLUDE	"\VIDEO\SYS\GSP.INC"	;GSP ASSEMBLER EQUATES
	.INCLUDE	"\VIDEO\SYS\SYS.INC"	;Z UNIT SYSTEM EQUATES
	.INCLUDE	"\VIDEO\SYS\MACROS.HDR"	;MACROS DEFINITIONS
	.INCLUDE	"IMGTBL.GLO"
	.INCLUDE	"GAME.EQU"
	.INCLUDE	"AUDIT.EQU"
	.INCLUDE	"PLYR.TBL"
;
;SOUNDS EXTERNAL
;
	.REF	EXP1,ELECTRO,DIESCRM,AIRSCRM,FIREDI,NOWAY,MTING
	.REF	MEUGH,UGH2
	.REF	MUSICOFF
;
;SYMBOLS EXTERNALLY DEFINED
;
	.REF	RGTJETS,LOCK_NUM
	.REF	STRLNRMO,HEXTOASC,WRLD,STRCNRMO,RD15FONT
	.REF	OFFBSCRN,DOLORD,JET_KILLS
	.REF	DOSHIFT2,DOSHIFT,JDOSHIFT
	.REF	AIRRECT2A,AIRBRECT2,ERECT13,STRT_D,MINE_FLG,ICN7,ADDBMB
	.REF	AIRRECT1,AIRBRECT1,LOTS_FLAG,RNDRNG0
	.REF	bomb_neutron,SEND_ICON,ICONS_DN,ICN5
	.REF	ENRECT13,ENRECT14,INIT_TAB,ONEJEEP,DO_EXTRA,DELZ10
	.REF	DRECT8,DBRECT8,FND_NOWLK,IRQSKYE
	.REF	DRECT7,DBRECT7,WAITTNT
	.REF	DRECT6,DBRECT6
	.REF	DRECT5,DBRECT5,NO_BONUS
	.REF	DRECT4,DBRECT4,ENRECT11,ERECT11,CLNPAL,ENRECT12,KILL_CRT3
	.REF	DRECT3,DBRECT3,VULN,BURST
	.REF	GOBACK
	.REF	DRECT3A,DBRECT3A,TAUNTOUT,KP_TAUNT
	.REF	STATUS,DEF_PAGE,GAMSTATE,INIT_ALL,UNSTACK,GET_AUD,PCNT
	.REF	FACCHECK,KILBGND,CLSCRACH,RANDOM,POWERTST,SCORE_FLAG,PCTOT
	.REF	ADD_DUMP,STRT_WPN,P1CTRL,P2CTRL,SENDH_TOP
	.REF	FRANIM,BLOOD_LST2,EXPMINE2,SCRADD2,SNDPRC
	.REF	OBJOFF,OBJON,MSG_PROC2,GAMEOVER,GETFPAL,SHORT_PLYR,COLCYC
	.REF	P1DATA,P2DATA,PSTAT,CNTDIG1,CNTDIG2,HALT,STUFF_LVADDR
	.REF	THIS_PLYR,GETCPNT,BGND_UD1,SCRIPTPLAY,OFFSCRN,START,ICN2
	.REF	ONARRW,ARWOFF,PUMP_RED,RANGRAND,GOOBP,ZONE_TXT,RUNIN
	.REF	WAVE,FRANIM_DIE,BEGIN_CHNK,ICLIST
	.REF	HULK_CNT,SEND_TOP,DO_ALL_STUFF,ENRECT4
	.REF	ERECT2,EN_CURRENT,ERECT3,ENRECT3,KEEPIT,ERECT4,LSHIT,SHAKER
	.REF	PULLOBJ,JUMPXY,JUMPXY2,RANDPER,ERECT7,ERECT8
	.REF	TBOMBD,STRT_S,DELAYALL,ZONE_TXT2
	.REF	DBRECT2,DRECT2,TBLST,LAY_EXP
	.REF	ERECT10,CTOTAL
	.REF	SKIPR_DN,JEEPCYC
	.REF	SHIFTLM
;
;SYMBOLS DEFINED IN THIS FILE
;
	.DEF	AIR_ER
	.DEF	AIRRECT3A,AIRBRECT3,TUFFMINE
	.DEF	DELOFFBOTL,SLOW_DWN,POL2,GATE_PLYR,MAYBE_UD1,STATSNDS
	.DEF	STATIC_COVER,XOUT0,JEPCYC
	.DEF	INIT_PROG,DRAW_PLYR_TORSO,EHALT,CTRLS,BNC_PLYR,ANI_FLAG
	.DEF	PLYRPRCS,PLYROBJS,KILLP1,KILLP2,BNC_PLYR2,CURRENT,RECT1
	.DEF	WARMSET,KILL_PLYR,TARGET,TARGET_NUM,BCURRENT,BRECT1,RINGS
	.DEF	CPULEFT,CPUAVG,ANI_STAT
	.DEF	ANI_EYES,ANI_HD,ANI_LARM,ANI_RARM,ANI_TYP,ANI_MTH,ENEMY_RECT
	.DEF	STRT_G,KPLARM,INTRO,ISTATE,SHOTKILL,ENDWV
	.DEF	CKFORY,SETPXY2,SETPXY1,HZSPD,PATHA,HSTGS_LOST
	.DEF	HSTGSET,WARP_KIL
	.def	timeron,timerp1,timerp1sd,timerp2,timerp2sd
	.def	bombn_killp

	.if	DEBUG
	.def	SLDEBUG
	.bss	SLDEBUG	,16		;Shawn's debug
	.endif

	.IF	DEBUG
	.DEF	FORDBG
;	.BSS	KEEPA0,32
;	.BSS	KEEPA5,32
	.ENDIF

;UNINITIALIZED RAM DEFINITIONS
;
	.BSS	HSTGS_LOST,16		;TOTAL HOSTAGES NOT RESCUED
	.BSS	PALTMP,13*16*2		;ALLOCATE 2 X COLOR AREA IN RAM
	.BSS	PLYROBJS,64		;2 ENTRIES-PLYR1,PLYR2 TORSO PTR
	.BSS	PLYRPRCS,64		;2 ENTRIES-PLYR1,PLYR2 PROCESS PTR
	.BSS	EHALT,16
	.BSS	SLOW_DWN,16		;SLOW DOWN SCROLL CNTR
	.BSS	RAMLST,32*35		;IMG PNTRS FOR DELETION WHILE SCROLL
	.BSS	CPUAVG,16
	.BSS	CPULEFT,16
	.BSS	TARGET_NUM,16		;TARGET NUM FOR SCROLLING
	.BSS	KPLARM,32		;GI WALKIE TALKIE ARM
	.BSS	INTRO,16		;INTRO # FOR CONTROL RM 0=PROF,1=GEN
	.BSS	ISTATE,16		
	.BSS	HSTGSET,16
	.BSS	HZSPD,32		;BOTH HZ/VT SPEED
	.BSS	TMP,16
	.BSS	CURRENT,32		;PNTR TO LIST OF RECTANGLES
	.BSS	BCURRENT,32		;PNTR TO LIST OF RECTANGLES (BULLETS)
	.BSS	ENEMY_RECT,32		;PNTR TO ENEMY SPAWN RECTANGLES


* Timer variables. Must stay in order!!

	.bss	timertcnt	,16	;Tick count
	.bss	timeron		,16	;!0=Running
	.bss	timerp1		,16	;Player 1 seconds of play
	.bss	timerp1sd	,16	;Player 1 seconds since death
	.bss	timerp2		,16	;Player 2 seconds of play
	.bss	timerp2sd	,16	;Player 2 seconds since death


;EQUATES FOR THIS FILE
;
;VNORMVEL	.EQU	016000H
;HNORMVEL	.EQU	016000H
;VSLOVEL		.EQU	0FA00H		;VNORMVEL*.707
;HSLOVEL		.EQU	0FA00H		;HNORMVEL*.707
;
VNORMVEL	.EQU	018333H
HNORMVEL	.EQU	018333H
VSLOVEL		.EQU	011300H		;VNORMVEL*.707
HSLOVEL		.EQU	011300H		;HNORMVEL*.707
;
VNORMVEL2	.EQU	01F000H
HNORMVEL2	.EQU	01F000H
VSLOVEL2	.EQU	018000H		;VNORMVEL*.707
HSLOVEL2	.EQU	018000H		;HNORMVEL*.707
;
VNORMVEL3	.EQU	025000H
HNORMVEL3	.EQU	027000H
VSLOVEL3	.EQU	01CA00H		;VNORMVEL*.707
HSLOVEL3	.EQU	01CA00H		;HNORMVEL*.707
;
TEMP	.EQU	PDATA

MYLIST	.EQU	PDATA+64	;UHL	FRANIM LIST FOR THIS PC UPON DEATH
;SAME AS FROM MINE.ASM

	.TEXT

INIT_PROG
	DINT				;DISABLE INTERRUPTS
;
; SET FIELD PARAMETERS
	SETF	16,1,0			;WORD SIGN EXTEND (FIELD 0)
	SETF	32,1,1			;LONG WORD	  (FIELD 1)

; SET THE STACK POINTER TO THE END OF SCRATCHPAD
	MOVI	STCKST,SP,L		;MOVE STACK ADDR IN SP (32 BITS)

;	MOVE	@WDOGRAM,A0,L		;MARK SYSTEM AS INITIALIZED
;	CMPI	WDOGNUM,A0
;	JRNZ	WARMSET0
;	MOVI	AUDLOCK,A0
;	CALLA	AUD1
;DUMP REPORT OF WATCHDOG
;	.IF	DEBUG
;	.ELSE
;	CALLERR	11,0
;	.ENDIF
;JUMP TO RECOVER CODE
;	MOVI	AUDSTAT,A0
;	CALLA	GET_AUD
;	MOVE	A1,A1
;	JREQ	WARMSET			;ATTRACT MODE GLITCH
;	CLR	A1
;	CALLA	STORE_AUDIT		;WARP ONLY ONCE, DUDE!!!
;
;	JAUC	BONUS_WARP

;WARMSET0
;	JAUC	POWERTST
WARMSET
	DINT				;DISABLE INTERRUPTS
;
; SET FIELD PARAMETERS
	SETF	16,1,0			;WORD SIGN EXTEND (FIELD 0)
	SETF	32,1,1			;LONG WORD	  (FIELD 1)

; SET THE STACK POINTER TO THE END OF SCRATCHPAD
	MOVI	STCKST,SP,L		;MOVE STACK ADDR IN SP (32 BITS)
; RESET TODAYS HIGH SCORE TABLE
	CALLA	INIT_TAB

		
; CLEAR SCRATCHPAD, INITIALIZE PROCESSES
	CALLA	CLSCRACH		;CLR SCRATCH RAM
	CALLA	INIT_ALL		;INITIALIZE Z-UNIT

MAIN0
	CREATE	0,FACCHECK		;START ATTRACT IF THINGS O.K.
	CREATE	PLIST_ID,UNSTACK	;CREATE SWITCH UNSTACKER
;
; MAIN LINE LOGIC LOOP
;
MAINLP
	CALLA	PRCDSP			;DISPATCH PROCESSES
	CALLA	RANDOM
	.if	DEBUG
	move	@SLDEBUG,a0
	jrnn	skipline
	movi	5*32,a0
	move	a0,@ERASELOC
skipline
	.endif

	MOVE	A13,A13
	JRZ	MAINPOK
	.IF	DEBUG
	LOCKUP
	EINT
	.ELSE
	CALLERR	10,0
	.ENDIF
;
MAINPOK

;	CLR	A9
;	MOVI	HULKPID,A0
;	MOVI	ACTIVE,A2,L
;EXNXT
;	MOVE	*A2,A2,L	;GET NEXT
;	JREQ	EXSC		;ALL DONE
;	MOVE	*A2(PROCID),A4
;	CMP	A0,A4		;MATCH?
;	JRNE	EXNXT		;NO
;	INC	A9
;	JRUC	EXNXT
;EXSC
;	MOVE	@HULK_CNT,A0
;	CMP	A9,A0
;	JRZ	OKAYH
;	LOCKUP
;	EINT
;OKAYH

	move	@timertcnt,a3		;>Update player timers
	subk	1,a3
	jrgt	mlp20
	movi	timeron,a0		;Get * to Timer variables
	move	*a0+,a1
	jrz	mlp10
	move	@STATUS,a2
	btst	0,a2			;P1 in game?
	jrz	mlp5
	move	*a0,a1,L		;+1 to game time & time since death
	addi	>10001,a1
	move	a1,*a0,L
mlp5	addk	32,a0			;Next set
	btst	1,a2			;P2 in game?
	jrz	mlp10
	move	*a0,a1,L		;+1 to game time & time since death
	addi	>10001,a1
	move	a1,*a0,L
mlp10	movi	60,a3			;Ticks per second
mlp20	move	a3,@timertcnt


	CALLA	SNDPRC			;DISPATCH AND TIME THE SOUND CALLS
	.IF DEBUG
	callr	StCpuLft
	.ENDIF

; TEST ROM PROTECT INTERRUPT
;
;	.IF	DEBUG
;	JRUC	SKIPCK
;	dint
;	MOVE	@INTENB,A0,0	;ENABLE ROM PROTECT INTERRUPT (ext2)
;	ORI	X2E,A0
;	MOVE	A0,@INTENB,0
;	eint
;	move	@>ffe00000,a0,0
;	move	a0,@>ffe00000,0
;SKIPCK
;	.ENDIF


	MOVE	@PCNT,A0
	DEC	A0
	MOVE	A0,@PCNT

	MOVE	@GAMSTATE,A0
	CMPI	INDIAG,A0
	JRNZ	NODIAG

	MOVI	AMDEPID,A0
	CLR	A1
	NOT	A1
	CALLA	KILALL
	CALLA	KILBGND
	CLR	A0
	MOVE	A0,@SCORE_FLAG
NODIAG
	JRUC	MAINLP



RINGS
;A10=TIME RINGS ARE ON
;A9=PLAYER NUMBER 1/2 TO RING
;TURN OFF EXISTING RINGS AROUND THIS PLAYER PLUS ITS COLOR CYCLE
	MOVE	A9,*A13(MYPLYR)
;SET BOUNDARIES TO ORBITING TYPE BNDRY
;SET BOUNDARIES FOR CORRECT PLAYER!
	DEC	A9
	SLL	5,A9
	MOVI	PLYRPRCS,A1,L
	ADD	A9,A1
	MOVE	*A1,A1,L
	MOVE	*A1(LEG_PTR),A11,L
	MOVI	CLSPLYR|TYPPLYR|SUBRNG1,A5	;FOR BOTH PLYRS
	MOVE	A5,*A11(OID)
	MOVK	5,A0
	MOVE	A0,*A13(TEMP)
	MOVI	01FEH,A0
	MOVE	A0,*A1(DELYDET)		;KEEP STUFFING A VALUE IN HERE
RTP
	MOVI	PLYRPRCS,A1,L
	ADD	A9,A1
	MOVE	*A1,A1,L
	MOVE	*A1(TSO_PTR),A8,L
	MOVE	*A1(LEG_PTR),A11,L
;GIVE THESE IMAGES OTHER PAL
	MOVI	nup1a,A0
	MOVE	*A13(TEMP),A1
	CMPI	2,A1
	JRNZ	RCL
	MOVI	nup2a,A0
RCL	CALLA	GETFPAL			;GET A COLOR MAP ASSIGNMENT
	MOVE	A0,*A8(OPAL),W		;STORE THE NEW PALETTE
	MOVE	A0,*A11(OPAL),W		;STORE THE NEW PALETTE
	MOVE	*A13(TEMP),A0
	CALLA	PRCSLP
XOUT0	MOVE	A9,A9
	JRZ	P01
	MOVI	nup2,A0
	JRUC	P001
P01	MOVI	nup1,A0
P001	CALLA	GETFPAL			;GET A COLOR MAP ASSIGNMENT
;GIVE THESE IMAGES OTHER PAL
	MOVE	A0,*A8(OPAL),W		;STORE THE NEW PALETTE
	MOVE	A0,*A11(OPAL),W
	MOVE	*A13(TEMP),A0
	JRZ	XOUT
	CALLA	PRCSLP
	DEC	A10
	JRZ	XOUT
	CMPI	25,A10
	JRNZ	RTP
	MOVK	2,A0
	MOVE	A0,*A13(TEMP)
	JRUC	RTP
XOUT
;RESTORE CORRECT OID
	MOVI	RESTUF,A1
	ADD	A9,A1
	MOVE	*A1,A1,L
	MOVE	A1,*A11(OID)
;GIVE TORSO SOME DELAY DETECTION
	MOVE	*A8(OPLINK),A0,L
	MOVI	70,A1			;10
	MOVE	A1,*A0(DELYDET)		;KEEP STUFFING A VALUE IN HERE
	DIE

RESTUF	.LONG	CLSPLYR|TYPPLYR|SUBPL_1,CLSPLYR|TYPPLYR|SUBPL_2

ANI_STAT:
;A8=STATIC IMAGE FROM BACKGROUND UPDATER
	SLEEPK	1
	MOVE	@DELAYALL,A0
	JRNZ	ANI_STAT
	MOVE	@TAUNTOUT,A0
	JRNZ	ANS
	SLEEPK	1CH		;1C FOR REPORTER, 6C FOR MONSTER
	MOVE	@INTRO,A0
	JRZ	ANS
;PURPLE MONSTER AND FOR RACKUP
	SLEEP	50H
ANS
	MOVI	STATLST,A9
	MOVK	1,A1
	JSRP	FRANIM
	MOVE	A8,A0
	CALLA	DELOBJ
	DIE

STATLST .LONG	STAT2
	.WORD	7
	.LONG	STAT3
	.WORD	7
	.LONG	STAT4
	.WORD	5
	.LONG	STAT5
	.WORD	5
	.LONG	STAT6
	.WORD	4
	.LONG	0

ANI_TYP:
;A8=TYPIST ARM IMAGE FROM BACKGROUND UPDATER
;ANIMATE, THEN KILL OFF ONCE IT IS OFF SCREEN
	SLEEP	4*60
	MOVE	*A8(OYPOS),A0
	SUBI	46H,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	*A8(OXPOS),A0
	SUBK	1DH,A0
	MOVE	A0,*A8(OXPOS)
ANI_TYP2:
	MOVI	TYPLST,A9
	MOVK	1,A1
	JSRP	FRANIM
	JRUC	ANI_TYP2

TYPLST	.LONG	TARM1
	.WORD	30
	.LONG	TARM2
	.WORD	5
	.LONG	TARM3
	.WORD	3
	.LONG	TARM2
	.WORD	3
	.LONG	TARM3
	.WORD	6
	.LONG	TARM2
	.WORD	3
	.LONG	TARM3
	.WORD	3
	.LONG	TARM2
	.WORD	3
	.LONG	TARM3
	.WORD	20
	.LONG	TARM2
	.WORD	4
	.LONG	TARM3
	.WORD	3
	.LONG	TARM2
	.WORD	4
	.LONG	TARM1
	.WORD	5
	.LONG	0

ANI_HD:
;A8=GENERAL HEAD IMAGE FROM BACKGROUND UPDATER
;ANIMATE, THEN KILL OFF ONCE IT IS OFF SCREEN
	MOVE	*A8(OYPOS),A0
	SUBK	4,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	*A8(OXPOS),A0
	ADDK	11H,A0
	MOVE	A0,*A8(OXPOS)
	MOVE	@KP_TAUNT,A0
	JRZ	IM0
;TAUNT, SPEEK BRIEFLY
	MOVI 	HDLST3_T,A9
	MOVK	1,A1
	JSRP	FRANIM
	MOVK	2,A10
	JRUC	IMP0
;FOR IRAQ MAP
IM0	MOVI 	HDLST3,A9
	MOVK	1,A1
	JSRP	FRANIM
	MOVK	5,A10
IMP0	MOVI 	HDLST3A,A9
	MOVK	1,A1
	JSRP	FRANIM
	DSJS	A10,IMP0
	SLEEP	0C0H
	MOVK	15,A10
IMP	MOVI	HDLST,A9
	MOVK	1,A1
	JSRP	FRANIM
	DSJS	A10,IMP
	DIE

;FOR PURPLE MONSTER
;	MOVK	2,A10
;ANI_HD2:
;	MOVI	HDLST,A9
;	MOVK	1,A1
;	JSRP	FRANIM
;	DSJS	A10,ANI_HD2
;	SLEEPK	20
;	MOVI	HDLST2,A9
;	MOVK	1,A1
;	JSRP	FRANIM
;	MOVK	10,A10
;	JRUC	ANI_HD2
HDLST3
	.LONG	GH2
	.WORD	5
	.LONG	GH1
	.WORD	03EH
	.LONG	GH2
	.WORD	5
	.LONG	GH3
	.WORD	10
	.LONG	GH2
	.WORD	5
	.LONG	GH1
	.WORD	30
	.LONG	GH2
	.WORD	5
	.LONG	0
HDLST3_T	;TAUNT
	.LONG	GH2
	.WORD	5
	.LONG	GH1
	.WORD	5H
	.LONG	GH2
	.WORD	5
	.LONG	GH3
	.WORD	5
	.LONG	GH2
	.WORD	5
	.LONG	GH1
	.WORD	5
	.LONG	GH2
	.WORD	5
	.LONG	0
HDLST3A
	.LONG	GH3
	.WORD	5
	.LONG	GH3A
	.WORD	5
	.LONG	GH3
	.WORD	5
	.LONG	GH3A
	.WORD	5
	.LONG	GH3
	.WORD	10
	.LONG	GH3A
	.WORD	5
	.LONG	GH3
	.WORD	5
	.LONG	GH3A
	.WORD	5
	.LONG	GH3
	.WORD	8
	.LONG	GH3A
	.WORD	5
	.LONG	GH3
	.WORD	5
	.LONG	GH3A
	.WORD	5
	.LONG	GH3
	.WORD	5
	.LONG	0

;HDLST2	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	5
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	10
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	5
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	8
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	5
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	10
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	5
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	10
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	10
;	.LONG	GH3A
;	.WORD	5
;	.LONG	GH3
;	.WORD	120
;	.LONG	0

HDLST
	.LONG	GH2
	.WORD	5
	.LONG	GH1
	.WORD	30
	.LONG	GH2
	.WORD	5
	.LONG	GH3
	.WORD	50
	.LONG	GH2
	.WORD	5
	.LONG	GH1
	.WORD	0D0H
	.LONG	GH2
	.WORD	5
	.LONG	GH3
	.WORD	58H
	.LONG	0

ANI_LARM:
;A8=GENERAL LARM IMAGE FROM BACKGROUND UPDATER
;ANIMATE, THEN KILL OFF ONCE IT IS OFF SCREEN
	SLEEPK	1
	MOVE	@DELAYALL,A0
	JRNZ	ANI_LARM
	MOVE	*A8(OYPOS),A0
	SUBI	3AH,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	*A8(OXPOS),A0
	ADDI	23H,A0
	MOVE	A0,*A8(OXPOS)
	CREATE	INTROPID,UPR
ANI_LARM2:
	MOVI	LARMLST,A9
	MOVK	1,A1
	JSRP	FRANIM
	JRUC	ANI_LARM2
UPR	SLEEP	120
	MOVI	20000-10,A0	;7FD3H,A0
	MOVE	A0,*A8(OZPOS)
	DIE

LARMLST
	.LONG	GLARM1
	.WORD	40
	.LONG	GLARM2
	.WORD	5
	.LONG	GLARM3
	.WORD	60
	.LONG	GLARM2
	.WORD	5
	.LONG	GLARM1
	.WORD	60*3
	.LONG	GLARM2
	.WORD	5
	.LONG	GLARM3
	.WORD	098H
	.LONG	GLARM2
	.WORD	5
	.LONG	GLARM1
	.WORD	108H	;60*6
	.LONG	GLARM2
	.WORD	5
	.LONG	GLARM3
	.WORD	60
	.LONG	GLARM4
	.WORD	5
	.LONG	GLARM5
	.WORD	5
	.LONG	GLARM6
	.WORD	08FH
	.LONG	GLARM5
	.WORD	5
	.LONG	GLARM4
	.WORD	5
	.LONG	GLARM3
	.WORD	30
	.LONG	GLARM2
	.WORD	5
	.LONG	GLARM1
	.WORD	60*3
	.LONG	0
RARMLST
	.LONG	GRARM1
	.WORD	40
	.LONG	GRARM2
	.WORD	5
	.LONG	GRARM3
	.WORD	60
	.LONG	GRARM2
	.WORD	5
	.LONG	GRARM1
	.WORD	60*3
	.LONG	GRARM2
	.WORD	5
	.LONG	GRARM3
	.WORD	098H
	.LONG	GRARM2
	.WORD	5
	.LONG	GRARM1
	.WORD	108H	;60*6
	.LONG	GRARM2
	.WORD	5
	.LONG	GRARM3
	.WORD	60
	.LONG	GRARM4
	.WORD	5
	.LONG	GRARM5
	.WORD	5
	.LONG	GRARM6
	.WORD	08FH
	.LONG	GRARM5
	.WORD	5
	.LONG	GRARM4
	.WORD	5
	.LONG	GRARM3
	.WORD	30
	.LONG	GRARM2
	.WORD	5
	.LONG	GRARM1
	.WORD	60*3
	.LONG	0
ANI_RARM:
;A8=GENERAL RARM IMAGE FROM BACKGROUND UPDATER
;ANIMATE, THEN KILL OFF ONCE IT IS OFF SCREEN
	SLEEPK	1
	MOVE	@DELAYALL,A0
	JRNZ	ANI_RARM
	MOVE	*A8(OYPOS),A0
	SUBI	39H,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	*A8(OXPOS),A0
	SUBK	1EH,A0
	MOVE	A0,*A8(OXPOS)
ANI_RARM2:
	MOVI	RARMLST,A9
	MOVK	1,A1
	JSRP	FRANIM
	JRUC	ANI_RARM2


ANI_MTH:
	MOVE	@INTRO,A0
	JRZ	AM2
;GI MOUTH
	SLEEP	7AH
	MOVI	T0G,A9
AM1	MOVE	*A9+,A0,W
	JRZ	OUY
	CALLA	PRCSLP
	MOVE	A8,A0
	CALLA	OBJOFF
	MOVE	*A9+,A0,W
	CALLA	PRCSLP
	MOVE	A8,A0
	CALLA	OBJON
	JRUC	AM1
OUY	MOVE	A8,A0
	CALLA	DELOBJ
	MOVK	1,A0
	MOVE	A0,@ISTATE
;TRIGGER INTO MOUTH
;TURN ON SOLDIER TILT IMAGE
;DELETE SOLDIER HALVES - GIPID OID!
	MOVI	SOLD,A14
	CALLA	DO_ALL_STUFF
;	MOVE	A8,A0
;	CALLA	ADJSTWTL
	MOVI	GIPID,A0		;TWO SOLDIER HALVES
	CLR	A1
	NOT	A1
	CALLA	KILOBJ
	SLEEPK	5
	MOVI	SOLDR3,A1
	MOVE	*A8(OFLAGS),A4
	CALLA	ANI
	MOVI	087H+20,A0
	MOVE	A0,*A8(OXPOS)
	MOVI	042H,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	A8,A0
	CALLA	ADJSTWTL
	SLEEPK	5
	CREATE	INTROPID,KIP
	DIE
SOLD:
	.LONG	[09FH+20,0],[038FH,0],SOLDR1
	.WORD	103H,DMAWNZ|M_NOCOLL,CLSNEUT|TYPNEUT	;109
	.LONG	0,0
T0G	.WORD	20,3,10,4,40,5,5,5,20,2,15,5,10,50,5,5,5,20,2,15,5,10
	.WORD	2,15,5,10,0
AM2
;A8=PROF MOUTH IMAGE FROM BACKGROUND UPDATER
;ANIMATE, THEN KILL OFF ONCE IT IS OFF SCREEN
	SLEEP	0C0H
	MOVE	*A8(OYPOS),A0
	SUBI	56H,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	*A8(OXPOS),A0
	ADDK	0CH,A0
	MOVE	A0,*A8(OXPOS)
	MOVI	MTHLST0,A9
	MOVK	1,A1
	JSRP	FRANIM
	MOVK	8,A10			;8
ANI_MTH2:
	MOVI	MTHLST,A9
	MOVK	1,A1
	JSRP	FRANIM
	DSJS	A10,ANI_MTH2
	SLEEPK	8
	MOVI	PMTH4,A1
	MOVE	*A8(OFLAGS),A4
	CALLA	ANI
	DIE

MTHLST0 .LONG	PMTH2
	.WORD	4
	.LONG	PMTH1
	.WORD	4
	.LONG	PMTH2
	.WORD	4
	.LONG	PMTH3
	.WORD	10H+28	;30H
	.LONG	0
MTHLST	.LONG	PMTH3
	.WORD	4
	.LONG	PMTH2
	.WORD	4
	.LONG	PMTH1
	.WORD	5
	.LONG	PMTH2
	.WORD	4
	.LONG	PMTH3
	.WORD	18
	.LONG	PMTH2
	.WORD	4
	.LONG	PMTH1
	.WORD	11
	.LONG	PMTH2
	.WORD	4
	.LONG	0

ANI_EYES:
	MOVE	@INTRO,A0
	JRZ	AE2
	SLEEP	120
;INTRO WITH GI
FT	SLEEPK	1
	MOVE	@ISTATE,A0
	JRZ	FT
;ABOUT TO SLIDE INTO MOUTH
	MOVE	A8,A0
	CALLA	OBJOFF
	MOVE	@KPLARM,A0,L
	CALLA	OBJOFF
	SLEEPK	5
;TURN ON A LEG AT NEW LOCATION
	MOVI	SOLDR4,A1
	MOVE	*A8(OFLAGS),A4
	ORI	M_FLIPH,A4
	CALLA	ANI
	MOVE	A8,A0
	CALLA	OBJON
	MOVI	087H+23+20,A0
	MOVE	A0,*A8(OXPOS)
	MOVI	042H+29,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	A8,A0
	CALLA	ADJSTWTL
	

	PUSH	A8
	MOVE	@KPLARM,A8,L
	MOVI	SOLDR4,A1
	MOVE	*A8(OFLAGS),A4
	CALLA	ANI
	MOVE	A8,A0
	CALLA	OBJON
	MOVI	087H-25+20,A0
	MOVE	A0,*A8(OXPOS)
	MOVI	042H+29,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	A8,A0
	CALLA	ADJSTWTL
	CREATE	INTROPID,KIP
	PULL	A8
	CREATE	INTROPID,KIP
	DIE
KIP
;MOVE IT AROUND AND KPLARM AROUND
;DELETE IT
	MOVK	6,A10
LP9	MOVK	10,A9
LPS	MOVE	A9,A0
	CALLR	DOXY
	SLEEPK	3
	DSJS	A9,LPS
	CMPI	3,A10
	JRNZ	LKI
	MOVE	*A8(OYPOS),A0
	SUBK	0FH,A0
	MOVE	A0,*A8(OYPOS)
	CREATE	INTROPID,OOUP
LKI	DSJ	A10,LP9
	SLEEPK	10
	MOVE	A8,A0
	CALLA	DELOBJ
	DIE
OOUP	MOVE	*A8(OIMG),A0,L
	CMPI	SOLDR3,A0
	JRZ	OP2
	SLEEP	034H
OP1	MOVI	100H,A0
	MOVE	A0,*A8(OZPOS)
	MOVE	A8,A0
	CALLA	PULLOBJ
	CALLA	INSOBJ
	DIE
OP2	MOVI	1200,A0
	MOVE	A0,*A8(OZPOS)
	MOVE	A8,A0
	CALLA	PULLOBJ
	CALLA	INSOBJ
	SLEEPK	20
	MOVK	10H,A0
	MOVE	A0,*A8(OZPOS)
	MOVE	A8,A0
	CALLA	PULLOBJ
	CALLA	INSOBJ
	DIE

DOXY
	SLL	3,A0
	MOVI	SHKX,A1
	ADD	A0,A1
	MOVB	*A1,A1
	ADDI	SHKY,A0
	MOVB	*A0,A0
	MOVE	*A8(OXPOS),A2,W
	ADD	A1,A2
	MOVE	A2,*A8(OXPOS),W
	MOVE	*A8(OYPOS),A2,W
	ADD	A0,A2
	MOVE	A2,*A8(OYPOS),W
	RETS

SHKX	.BYTE	0,-7,0,7,-7,0,7,-4,-4,7,0
SHKY	.BYTE	0,0,7,-4,4,-7,7,-4,0,-7,4
	.EVEN

AE2
;ANIMATE, THEN KILL OFF ONCE IT IS OFF SCREEN
	MOVE	*A8(OYPOS),A0
	SUBI	30H,A0
	MOVE	A0,*A8(OYPOS)
	MOVE	*A8(OXPOS),A0
	ADDI	1DH,A0
	MOVE	A0,*A8(OXPOS)
	MOVK	2,A10
ANI_EYES2:
	MOVI	EYELST,A9
	MOVK	1,A1
	JSRP	FRANIM
	DSJS	A10,ANI_EYES2
	SLEEPK	1+20
	MOVI	EYELST2,A9
	MOVK	1,A1
	JSRP	FRANIM
	SLEEPK	30
	CLR	A11				;0=OVER REPORTER,1=RACKUP
	CREATE	0,STATIC_COVER
	DIE
STATSNDS
;A9=LOOPS
	MOVI	STATIC1,A0
	CALLA	ONESND
	SLEEP	30
	MOVI	STATIC2,A0
	CALLA	ONESND
	SLEEP	30
	DSJ	A9,STATSNDS
	DIE

STATIC1	.WORD	>F5F0,>20,>811D,0		;STATIC
STATIC2	.WORD	>F4F0,>20,>811A,0		;STATIC

STATIC_COVER
;A11=0=OVER REPORTER,1=RACKUP
;TURN ON STATIC TO COVER REPORTER
	PUSH	A11
	CALLA	STRT_S
	PULL	A11
	MOVK	6,A10
	MOVI	[10,0],A1
	MOVE	A1,*A13(PDATA+32),L
XSLP0	MOVI	[15,0],A0
	MOVE	A0,*A13(PDATA),L
	MOVK	6,A9
XSLP
	MOVE	*A13(PDATA),A0,L
	MOVE	*A13(PDATA+32),A1,L
	MOVI	STAT6,A2
	MOVI	279,A3		  
	MOVI	DMAWNZ,A4
	MOVI	CLSENMY|TYPGATE,A5		;STATIC
	CLR	A6
	CLR	A7
	CALLA	BEGINOBJ
	MOVE	A11,A11
	JRNZ	XL1
	PUSH	A9
	MOVK	2,A9
	CREATE0	STATSNDS
	PULL	A9
	CREATE	INTROPID,ANI_S2	;INTROPID,ANI_S2
	JRUC	XL2
XL1
	PUSH	A9
	MOVK	1,A9
	CREATE0	STATSNDS
	PULL	A9
	CREATE	INTROPID,ANI_S3	;INTROPID,ANI_S3			;FOR RACKUP
XL2	MOVE	*A13(PDATA),A0,L
	ADDI	[03CH,0],A0
	MOVE	A0,*A13(PDATA),L
	DSJ	A9,XSLP
	MOVE	*A13(PDATA+32),A0,L
	ADDI	[31,0],A0
	MOVE	A0,*A13(PDATA+32),L
	DSJ	A10,XSLP0
	DIE
ANI_S2
;A8=STATIC IMAGE FROM BACKGROUND UPDATER
	MOVI	STATLST2,A9
	MOVK	1,A1
	JSRP	FRANIM
;REPORTER HAS SCROLLED OFF SCREEN TO LEFT
	SLEEP	0190H
	MOVE	A8,A0
	CALLA	DELOBJ
	DIE
ANI_S3
;A8=STATIC IMAGE FROM BACKGROUND UPDATER
	MOVI	STATLST3,A9
	MOVK	1,A1
	JSRP	FRANIM
	MOVE	A8,A0
	CALLA	DELOBJ
	DIE
STATLST2
	.LONG	STAT6
	.WORD	2
	.LONG	STAT5
	.WORD	4
	.LONG	STAT4
	.WORD	4
	.LONG	STAT3
	.WORD	4
	.LONG	STAT2
	.WORD	4
	.LONG	STAT1
	.WORD	5
	.LONG	0
STATLST3
	.LONG	STAT6
	.WORD	2
	.LONG	STAT5
	.WORD	4
	.LONG	STAT4
	.WORD	4
	.LONG	STAT3
	.WORD	4
	.LONG	STAT2
	.WORD	4
	.LONG	STAT1
	.WORD	20
	.LONG	STAT2
	.WORD	4
	.LONG	STAT3
	.WORD	4
	.LONG	STAT4
	.WORD	4
	.LONG	STAT5
	.WORD	4
	.LONG	0

EYELST2
	.LONG	PEYE4
	.WORD	02CH+50
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	3
	.LONG	PEYE3
	.WORD	3
	.LONG	PEYE4
	.WORD	10
	.LONG	0

EYELST
	.LONG	PEYE1
	.WORD	5
	.LONG	PEYE2
	.WORD	5
	.LONG	PEYE3
	.WORD	9
	.LONG	PEYE2
	.WORD	5
	.LONG	PEYE1
	.WORD	1*60
	.LONG	PEYE2
	.WORD	4
	.LONG	PEYE3
	.WORD	4
	.LONG	PEYE2
	.WORD	4
	.LONG	PEYE1
	.WORD	30
	.LONG	PEYE2
	.WORD	4
	.LONG	PEYE3
	.WORD	4
	.LONG	PEYE2
	.WORD	4
	.LONG	PEYE1
	.WORD	2*60-50
	.LONG	PEYE2
	.WORD	5
	.LONG	PEYE3
	.WORD	20
	.LONG	PEYE2
	.WORD	5
	.LONG	PEYE1
	.WORD	1*60
	.LONG	0


ANI_FLAG:
;A8=FLAG IMAGE FROM BACKGROUND UPDATER
;ANIMATE, THEN KILL OFF ONCE IT IS OFF SCREEN
	MOVK	8,A10
ANIF1	MOVI	FLGLST,A9
	MOVK	1,A1
	JSRP	FRANIM
	DSJ	A10,ANIF1
	CALLA	SCRTST
	JRZ	ANI_FLAG
	MOVE	A8,A0
	CALLA	DELOBJ
	MOVE	@WAVE,A0
	CMPI	2,A0
	JRNZ	FORGO
FORDBG
	MOVI	-30,A0
	MOVE	A0,@JUMPXY
	MOVI	RECT2,A0
	MOVE	A0,@CURRENT,L
	MOVI	BRECT2,A0
	MOVE	A0,@BCURRENT,L
	CALLR	STRT_G
FORGO	DIE

STRT_G
	MOVI	GOOBP,A8		;PAL NAME
	MOVI	PALTMP,A9		;RAM AREA
	MOVI	[1,13],A10		;BEGIN/END COLOR #
	MOVK	6,A11			;RATE IN TICKS
	CREATE	CYCPID,COLCYC		;COLOR CYCLER ON
	RETS

FLGLST	.LONG	FLAG1	;IRAQFLG1
	.WORD	5
	.LONG	FLAG2	;IRAQFLG2
	.WORD	5
	.LONG	FLAG3	;IRAQFLG3
	.WORD	5
	.LONG	FLAG4	;IRAQFLG4
	.WORD	5
	.LONG	FLAG5	;IRAQFLG5
	.WORD	5
	.LONG	0

TARGET:
;PROCESS WHICH RUNS WHEN SCREEN IS STATIONARY.
;WHEN STARTED, IT WAITS FOR PLAYERS TO REACH A CERTAIN X OR Y TARGET AND
;THEN STARTS AN APPROPRIATE SCROLL
;A8=X TARGET OR 0 IF NONE
;A9=Y TARGET OR 0 (POS WORD)
;A10=0=OLD SCROLL, OR A10=TABLE OF SCROLL DIRECTION, AND CNT, END WITH 0


	MOVE	A8,A8
	JRZ	YCHK
XCHK
;CHECK PLAYERS FOR X TARGET
	MOVE	@STATUS,A0
	CMPI	3,A0
	JRNZ	ONEPX
;BOTH PLYRS IN GAME
	MOVE	@PLYROBJS,A0,L
	MOVE	@PLYROBJS+32,A1,L
	MOVE	*A0(OXPOS),A2
	MOVE	*A1(OXPOS),A3
	CMP	A8,A2
	JRNC	YESHITX
	CMP	A8,A3
	JRNC	YESHITX
NOHITX	SLEEPK	10
	JRUC	XCHK
YESHITX
;ONE OF PLAYERS IS TO RIGHT OF TARGET LINE
	SUB	A2,A3
	ABS	A3
	CMPI	200,A3
	JRNC	NOHITX
DOHORZ
;START HORZ SCROLL!
	MOVE	A10,A10
	JRNZ	NEWSCRL
	MOVE	@WORLDTLX,A9,L
	MOVE	@TARGET_NUM,A0
	CMPI	2,A0
	JRNZ	NOCH
;FROM REACTOR TO ELEVATOR
	PUSH	A0
	MOVI	[0E0H,0],A10
	CREATE	0,SETRUNIN
	PULL	A0
	MOVI	RECT4,A1
	MOVE	A1,@CURRENT,L
	MOVI	BRECT3,A1
	MOVE	A1,@BCURRENT,L
;IF THEY HAD A MAP, THEY DIDN'T USE IT.  THROW IT AWAY
;	CLR 	A1
;	MOVE	A1,@MAPON

NOCH	SLL	5,A0
	ADDI	TARGET_LST,A0
	MOVE	*A0,A0,L
	ADD	A0,A9
	CREATE	TARGPID,SCROLLFT
	CREATE	DELPID,DELOFFH			;IMAGES OFF LEFT OF SCREEN
	DIE
STOPO	MOVI	DELPID,A0
	CLR	A1
	NOT	A1
	CALLA	KILALL
	CALLA	OFFSCRN
	MOVE	@WAVE,A0
	CMPI	18,A0
	JRZ	AIRSTP
	CMPI	27,A0
	JRZ	AIRSTP0
	CMPI	17,A0
	JRZ	RD_END
	CMPI	15,A0
	JRZ	TRY_RCK
	CMPI	12,A0			;12 OR 11 TO GET TO 1ST LOCKDOWN
	JRZ	LCK1
	CMPI	11,A0
	JRNZ	SDIE

LCK1
;AT FIRST HUT
;DO TEXT
;START WAVE
;NEW LOCK DOWN RECTANGLES
	MOVI	DRECT4,A0		;FOR LOCKDOWN AT HUT
	MOVE	A0,@CURRENT,L
	MOVI	DBRECT4,A0
	MOVE	A0,@BCURRENT,L
	MOVI	ENRECT12,A0
	MOVE	A0,@EN_CURRENT,L	;FOR BOX COLLISIONS
	MOVI	ERECT11,A0
	MOVE	A0,@ENEMY_RECT,L	;FOR SPAWNING

	SLEEPK	20

	MOVK	6,A10			;HUT LOCKDOWN
	MOVI	[-16,0],A9		;Y ADD IN VALUE
	CREATE	0,ZONE_TXT2

	SLEEPK	30			;40
	MOVK	13,A0
	CALLA	DOLORD			;STORE WAVE #, START WAVE CODE
SDIE	DIE
AIRSTP0
;TURN ON A WARP BACK DISC!
;GO BACK FROM WARP LOCKDOWN #2
;SEND OUT CHASER!
	MOVK	1,A0
	MOVE	A0,@ICONS_DN
	SLEEP	90
	MOVE	@JET_KILLS,A0
	MOVK	12,A10			;NO
	SUBK	20,A0
	JRNZ	YESBB
;GOT ALL JETS
	MOVK	13,A10			;YES
	MOVI	P1DATA,A2
	MOVE	@PLYRPRCS,A0,L
	JRZ	RD3B
	CALLR	RD4B
RD3B
	MOVI	P2DATA,A2
	MOVE	@PLYRPRCS+32,A0,L
	JRZ	YESB
	CALLR	RD4B
	JRUC	YESB
YESBB
;NO BONUS
YESB	MOVI	[-16,0],A9		;Y ADD IN VALUE
	CREATE	0,ZONE_TXT2
	SLEEP	4*60
	CREATE	WARPPID,GOBACK
       	DIE
AIRSTP
;FIRST LOCKDOWN IN AIRPORT
	MOVE	@WORLDTLY,A0,L
	CMPI	[1250H,0],A0
	JRGT	SDIE

	MOVI	AIRRECT2A,A0
	MOVE	A0,@CURRENT,L
	MOVI	AIRBRECT2,A0
	MOVE	A0,@BCURRENT,L
	MOVK	19,A0
	CALLA	DOLORD			;STORE WAVE #, START WAVE CODE
	CLR	A0  			;1=STUCK IN GOO, 0=BALL AND CHAIN
	MOVE	A0,@HSTGSET
	MOVE	A0,@EN_CURRENT,L	;FOR BOX COLLISIONS
	MOVI	ERECT13,A0
	MOVE	A0,@ENEMY_RECT,L	;FOR SPAWNING
	DIE
RD_END
	SLEEP	10*60
;A FEW MORE TRUCKS ALONG ROAD
	MOVK	18,A0
	MOVE	A0,@WAVE
	SLEEP	5*60
	MOVK	9,A10			;NO BONUS
	CLR	A9			;Y ADD IN VALUE
	MOVE	@NO_BONUS,A0
	JRNZ	RD2
	MOVK	8,A10			;YES BONUS
	MOVI	[-16,0],A9		;Y ADD IN VALUE
RD2	CREATE	0,ZONE_TXT2
	MOVE	A9,A9
	JRZ	GOAIR
;GOT ALL TRUCKS
	MOVI	P1DATA,A2
	MOVE	@PLYRPRCS,A0,L
	JRZ	RD3
	CALLR	RD4
RD3
	MOVI	P2DATA,A2
	MOVE	@PLYRPRCS+32,A0,L
	JRZ	GOAIR
	CALLR	RD4

GOAIR
	SLEEPK	30
;DISPLAY TRUCKS GOT AWAY CNT
	MOVI	3E3EH,A6		;COLOR CYCLE DIGITS
	MOVI	GWAY,A8
	MOVI	[180,0BCH],A9		;SCRN Y/X
	MOVI	RD15FONT,A11		;FONT TABLE
	MOVK	2,A10			;Y,X SPACING BETWEEN CHARCTERS
	CLR	A0
	MOVE	A0,@WRLD
	JSRP	STRCNRMO
;DIGITS
	MOVE	@JET_KILLS,A8
	CALLA	HEXTOASC
	MOVI	3E3EH,A6		;COLOR CYCLE DIGITS
	MOVI	[180,011DH],A9		;SCRN Y/X
	CLR	A0
	JSRP	STRLNRMO

	MOVI	FIXPID,A0
	CLR	A1
	NOT	A1
	CALLA	EXISTP
* Z BIT CLR = MATCH,	A0 = PTR TO PROCESS
	JRZ	GO1
	CALLA	KILL
GO1	SLEEP	3*60
;START TOWARD AIRPORT GATES

	MOVI	08000H,A0
	MOVE	A0,@HZSPD,L
	MOVE	@WORLDTLY,A9,L
	SRL	16,A9
	ADDI	80,A9	    		;A9=Y TARGET LINE TO TRIGGER SCROLL
	CLR	A8			;A8=0 MEANS NOT CHECKING FOR X TARGET
	MOVI	PATHU,A10		;INDICATES NEW SCROLL WITH SCRL TABLE
	CREATE	TARGPID,TARGET

	MOVK	18,A0
	CALLA	DOLORD
	CLR	A9			;A9=0 FOR UP, 1 FOR RGT
	CREATE	ARWPID,ONARRW		;TURN ON UP ARROW
	CREATE	0,FIX			;ARROW OFF AFTER A TIME
	MOVK	8,A0			;10
	MOVE	A0,@CTOTAL
	MOVI	ICN2,A0
	MOVE	A0,@ICLIST,L
	CLR	A0
	MOVE	A0,@TARGET_NUM
	MOVE	A0,@EN_CURRENT,L

	MOVI	AIRRECT1,A0
	MOVE	A0,@CURRENT,L
	MOVI	AIRBRECT1,A0
	MOVE	A0,@BCURRENT,L

	MOVI	TUNE5,A0
	CALLA	ONESND

	MOVK	1,A0
	MOVE	A0,@ICONS_DN
	SLEEP	12*60
	CREATE	ICONPID,SEND_ICON
	DIE

TUNE5	.WORD	>F3F0,2,>8008,0		;AIRPORT TUNE

GWAY	.BYTE "TRUCKS ESCAPED:",0
	.EVEN

RD4 
	MOVI	>25000,A1		;AMOUNT OF SCORE FOR ALL TRUCKS
	CALLA	SCRADD2			;DO IT!
	CALLA	DO_EXTRA
	RETS
RD4B
	MOVI	>25000,A1		;AMOUNT OF SCORE FOR ALL JETS
	CALLA	SCRADD2			;DO IT!
	RETS
TRY_RCK
;AT ROAD, BRING ON ORCUS
	CLR	A0
	MOVE	A0,@WORLDTLY,L
	MOVE	A0,@CURRENT,L
	MOVE	A0,@BCURRENT,L
	MOVE	A0,@EN_CURRENT,L	;FOR BOX COLLISIONS
	MOVE	A0,@FND_NOWLK		;FIENDS CAN WALK AGAIN
	MOVI	ERECT11,A0
	MOVE	A0,@ENEMY_RECT,L	;FOR SPAWNING






;	MOVK	11,A10			;NO DOUBLE SCORE BONUS
;	MOVI	[-16,0],A9		;Y ADD IN VALUE
;	CREATE	0,ZONE_TXT2
;;DISPLAY GOT AWAY #
;	MOVI	3E3EH,A6		;COLOR CYCLE DIGITS
;	MOVI	GWAY,A8
;	MOVI	[180,0C4H],A9		;SCRN Y/X
;	MOVI	RD15FONT,A11		;FONT TABLE
;	MOVK	2,A10			;Y,X SPACING BETWEEN CHARCTERS
;	CLR	A0
;	MOVE	A0,@WRLD
;	JSRP	STRCNRMO
;;DIGITS
;	MOVE	@JET_KILLS,A8
;	CALLA	HEXTOASC
;	MOVI	3E3EH,A6		;COLOR CYCLE DIGITS
;	MOVI	[180,011DH+8],A9	;SCRN Y/X
;	CLR	A0
;	JSRP	STRLNRMO
;	SLEEP	180
;	CREATE	WARPPID,GOBACK
;	DIE
;GWAY	.BYTE "JEEPS ESCAPED:",0
;	.EVEN
;







	MOVK	7,A10			;ORCUS HERE
	MOVI	[-16,0],A9		;Y ADD IN VALUE
	CREATE	0,ZONE_TXT2

	MOVK	16,A0
	CALLA	DOLORD			;STORE WAVE #, START WAVE CODE

	MOVI	ICN5,A0
	MOVE	A0,@ICLIST,L
	MOVI	(  5 *32*32)+(	5 *32)+(  5 ),A1	;SAND COLOR
	MOVE	A1,@IRQSKYE
	CALLA	DELZ10
	MOVK	1,A0
	MOVE	A0,@ICONS_DN
	SLEEP	15*60
;STUFF ORCUS ICONS HERE
	CREATE	ICONPID,SEND_ICON
	CREATE	ICONPID,SEND_ICON
	DIE

PATHU	;DIR,CNT
	.WORD	1,700,0
PATHA	.WORD	8,17EH,1,438H,2,2E0H,3,40,14,1,9,120,7,2EAH+40,1,290H,0	;DIR,CNT
PATHB	.WORD	2,16AH,1,340H,8,2F4H,1,388H,0			;DIR,CNT
NEWSCRL
;A10=LIST OF ANGLES,CNTS
;TURN OF DELETE OFF BOTTOM
	CLR	A0
	MOVE	A0,@SLOW_DWN
	MOVE	@WAVE,A0
	CMPI	17,A0
	JRNZ	UPS
;ON ROAD
	CREATE	DELPID,DELOFFH			;IMAGES OFF LEFT OF SCREEN
	JRUC	UP2
UPS	CREATE	DELPID,DELOFF		;DELETE OFF BOTM OF SCRN ONLY
UP2
	CMPI	PATHA,A10
	JRNZ	NEWS1
	MOVI	ENRECT11,A0
	MOVE	A0,@EN_CURRENT,L	;FOR BOX COLLISIONS
	MOVI	ERECT11,A0
	MOVE	A0,@ENEMY_RECT,L	;FOR SPAWNING
NOT_YETT
	SLEEPK	1
;DECIDE WHICH PATH
	MOVE	@WORLDTLX,A0,L
	SRL	16,A0
	ADDI	150,A0
	MOVE	A0,A1
	ADDI	100,A1
	MOVE	@STATUS,A2
	CMPI	3,A2
	JRZ	TWOPLYRS
	MOVE	@PLYROBJS,A2,L
	JRNZ	CKNOW
	MOVE	@PLYROBJS+32,A2,L
CKNOW
	MOVE	*A2(OXPOS),A3
	CMP	A0,A3
	JRC	NEWS0
	CMP	A1,A3
       	JRNC	GOINRGT
	MOVE	@SLOW_DWN,A0
	INC	A0
	MOVE	A0,@SLOW_DWN
	CMPI	190,A0
	JRLO	NOT_YETT
	PUSH	A8
	MOVK	1,A8
	CREATE	FUTUREPID,bomb_neutron
	PULL	A8
	CLR	A0
	MOVE	A0,@SLOW_DWN
	JRUC	NOT_YETT		;BR=NOT GOING TO LEFT OR RGT
TWOPLYRS
	MOVE	@PLYROBJS,A2,L
	MOVE	@PLYROBJS+32,A4,L
	MOVE	*A2(OXPOS),A3
	CMP	A0,A3
	JRC	MAYBL
	CMP	A1,A3
       	JRNC	MAYBR
	JRUC	NOT_YETT		;BR=NOT GOING TO LEFT OR RGT
MAYBL	
	MOVE	*A4(OXPOS),A3
	CMP	A0,A3
	JRC	NEWS0
	JRNC	NOT_YETT
MAYBR	MOVE	*A4(OXPOS),A3
	CMP	A1,A3
       	JRC	NOT_YETT
GOINRGT
	CALLA	STRT_D			;CYCLE SAT DISH
	MOVI	PATHB,A10		;INDICATES NEW SCROLL WITH SCRL TABLE
;NOW SWITCH OVER TO OTHER RECTANGLE LIST FOR PATH B
	CREATE	FUTRPID,CKFORY3		;START LAND MINES MOVING LATER ON!
	MOVK	11,A0			;IT IS PATHB!
	CALLA	DOLORD
	MOVI	DRECT3,A8		;PATH B LIST
	MOVI	DBRECT3,A9
	MOVI	[250,0],A11		;LINES BEFORE STUFFING
	JRUC	NEWS00
NEWS0
	CALLA	STRT_D			;CYCLE SAT DISH
	CREATE	FUTRPID,CKFORY4		;START JEEP COMING DOWN AT PLAYER
;	CREATE	0,BEACONS		;SHOW AREA AROUND DISHES ETC.
	MOVK	12,A0			;ASSUME PATH A LIST
	CALLA	DOLORD
	MOVI	DRECT3A,A8		;PATH A LIST
	MOVI	DBRECT3A,A9
	MOVI	[150,0],A11		;LINES BEFORE STUFFING
NEWS00	CREATE	TARGPID,STUFFRECT

NEWS1
	MOVE	*A10+,A11,W		;A11=DIR OF SCROLL
	JRZ	STOPO
	MOVE	*A10+,A9,W		;A9=LENGTH OF SCROLL
NEWS2	MOVE	@HALT,A0
	JRZ	NEW1
	SLEEPK	1
	JRUC	NEWS2
NEW1 	MOVE	A11,A0
	SLL	5,A0
	ADDI	JTBLS,A0
	MOVE	*A0,A0,L
	JUMP	A0
STUFFRECT
	MOVE	@WORLDTLY,A0,L
	SUB	A11,A0	
	MOVE	A0,A11
STF	SLEEPK	30
	MOVE	@WORLDTLY,A0,L
	CMP	A0,A11
	JRLT	STF
;REACHED Y TRIGGER LINE, STUFF CORRECT RECT INFO
	MOVE	A8,@CURRENT,L
	MOVE	A9,@BCURRENT,L
	DIE
JTBLS	.LONG	0,SUP,SUPRGT,SRGT,0,0,0,SLFT,SUPLFT,WAIT_HR,UPDT1,UPDT2
	.LONG	UPDT3,UPDT4,UPDT5,UPDT6,UPDT7,UPDT8,UPDT9,UPDT10	;19
UPDT10
	MOVK	29,A0
	CALLA	DOLORD
	MOVI	097AH,A0			;FOR JUMPING DOWN VERTICALLY
	MOVE	A0,@JUMPXY
;PUT IN RECTANGLES FOR ENEMY COLLISIONS HERE!
	MOVI	AIR_ER,A0
	MOVE	A0,@ENEMY_RECT,L	;FOR SPAWNING
	CREATE	ICONPID,SEND_ICON
	CREATE	ICONPID,SEND_ICON
	JRUC	NEWS1
AIR_ER
	.WORD	0,1,1370H+180,09A1H+265,1370H+190,09A1H+275
	.WORD	0,3,1350H,09A1H+115,1350H+10,09A1H+125
	.WORD	0,7,1370H+410,9A1H+115,1370H+420,9A1H+135
	.WORD	0,1,1370H+180,09A1H+265,1370H+190,09A1H+275
	.WORD	0,3,1350H,09A1H+115,1350H+10,09A1H+125
	.WORD	0,7,1370H+410,9A1H+115,1370H+420,9A1H+135
	.WORD	6,5,1370H+100,9A1H-50,1370H+290,9A1H-50+10
	.WORD	6,5,1370H+100,9A1H-50,1370H+290,9A1H-50+10
UPDT9
;AT END OF PLANE AREA LOCKDOWN
;	CALLA	OFFBSCRN
	CLR	A0
	MOVE	A0,@MINE_FLG
;	CALLA	OFFSCRN
	MOVI	LK6RECT,A0
	MOVE	A0,@CURRENT,L
	MOVI	LK6BRECT,A0
	MOVE	A0,@BCURRENT,L
	JRUC	NEWS1
LK6RECT
	.WORD	0AAH,098H,0367H,0EEH		;TOP FENCE
	.WORD	0
LK6BRECT
	.WORD	0AAH,098H,0367H-10,0EEH-18		;TOP FENCE
	.WORD	0
UPDT8
	CALLA	OFFBSCRN
	JRUC	NEWS1
UPDT7	CLR	A0
	MOVE	A0,@MINE_FLG
	CALLA	OFFSCRN
	MOVI	AIRRECT3A,A0
	MOVE	A0,@CURRENT,L
	MOVI	AIRBRECT3,A0
	MOVE	A0,@BCURRENT,L
	MOVK	25,A0
	CALLA	DOLORD
;	MOVE	A0,@WAVE
	CREATE	0,RGTJETS
	JRUC	NEWS1

AIRRECT3A	;AFTER AIRPLANE AREA
	.WORD	01082H,0BF5H,0136AH,0C43H		;TOP FENCE AFTER PLANES
	.WORD	014B8H,0BACH,01540H,0C40H		;FENCED IN AREA ON RGHT
;LOWER HUT
	.WORD	0134EH,0A5FH,013AEH,0B1DH		;UPPER LEFT OF HUT
	.WORD	0134EH,0B95H,013B2H,0BD4H		;LOWER LFT OF HUT
;UPPER HUT/FENCE
	.WORD	0134EH,096DH,013AEH,09F8H		;UPPER LEFT OF HUT
	.WORD	0C7CH+1782,0FECH-1663,0E34H+1782-80,1044H-1663	;TOP LFT FENCE
;TOP RIGHT HANGAR
	.WORD	0C7CH+1782,0FECH-1663,0E34H+1782-80,1044H-1663	;TOP LFT FENCE
	.WORD	0C7CH+1782,0FECH-1663,0E34H+1782-80,1044H-1663	;TOP LFT FENCE
	.WORD	0
AIRBRECT3	;AFTER AIRPLANE AREA FOR BULLETS
	.WORD	01082H,0BF5H,01360H,0C36H		;TOP FENCE AFTER PLANES
	.WORD	014B0H,0BACH,01540H,0C38H     		;FENCED IN AREA ON RGHT
;LOWER HUT
	.WORD	0134EH,0A5FH-8,013AEH-8,0B1DH-15	;UPPER LEFT OF HUT
	.WORD	0134EH,0B95H,013B2H-8,0BD4H-15		;LOWER LFT OF HUT
;UPPER HUT/FENCE
	.WORD	0134EH,096DH,013AEH-8,09F8H-15		;UPPER LEFT OF HUT
	.WORD	0C7CH+1782,0FECH-1663,0E34H+1782-80,9B0H		;TOP LFT FENCE
;TOP RIGHT HANGAR
	.WORD	0C7CH+1782,0FECH-1663,0E34H+1782-80,9B0H		;TOP LFT FENCE
	.WORD	0C7CH+1782,0FECH-1663,0E34H+1782-80,9B0H		;TOP LFT FENCE
	.WORD	0
UPDT6
;UP INTO AIRPLANE AREA
;START LAND MINES MOVING
	MOVI	ICN7,A0
	MOVE	A0,@ICLIST		;NO WEAPONS
	CLR	A0
	MOVE	A0,@CURRENT,L
	MOVE	A0,@BCURRENT,L
	CREATE	FUTUREPID,TUFFMINE
	MOVI	GLUCK,A0
	CALLA	ONESND
	MOVE	@PLYROBJS,A0,L
	JRZ	JU2
	MOVI	P1DATA+BMB_CNT,A0
	CALLA	ADDBMB
	CALLA	ADDBMB
	CALLA	ADDBMB
	CALLA	ADDBMB
JU2	MOVE	@PLYROBJS+32,A0,L
	JRZ	NEWS1
	MOVI	P2DATA+BMB_CNT,A0
	CALLA	ADDBMB
	CALLA	ADDBMB
	CALLA	ADDBMB
	CALLA	ADDBMB
	JRUC	NEWS1
GLUCK	.WORD	>F1F7,>40,>80E5,0		;"GOOD LUCK"
TUFFMINE
	MOVK	24,A0
	MOVE	A0,@WAVE
	MOVE	A0,@MINE_FLG
;START THEM MOVING
DCKF3	CALLA	JDOSHIFT
	SLEEPK	30
;NOW STOP THEM
	CALLA	DOSHIFT2
;DIFFICULTY SETTING HERE!
	SLEEPK	5		;SLEEP 1 FOR HARD DIFFICULTY
	MOVE	@MINE_FLG,A0
	JRNZ	DCKF3
	DIE
UPDT5
;TURN ON ARROW TO LEFT
	MOVK	2,A9			;A9=0 FOR UP, 1 FOR RGT ,2=LFT
	CREATE	ARWPID,ONARRW		;TURN ON UP ARROW
	CREATE	0,FIX
	JRUC	NEWS1
UPDT4
;AS WE SCROLL UP TOWARD CLIFFS
	MOVI	ENRECT14,A0
	MOVE	A0,@EN_CURRENT,L

	MOVI	DRECT8,A8
	MOVI	DBRECT8,A9
	MOVI	[242,0],A11		;LINES BEFORE STUFFING
	CREATE	TARGPID,STUFFRECT
	JRUC	NEWS1
UPDT3
;AS WE SCROLL UP AWAY FROM DISH, SET RECTANGLE CHECK TABLES
	MOVI	DRECT7,A0
	MOVE	A0,@CURRENT,L
	MOVI	DBRECT7,A0
	MOVE	A0,@BCURRENT,L
	JRUC	NEWS1
UPDT2
;AS WE SCROLL UP AWAY FROM DISH, SET RECTANGLE CHECK TABLES
	MOVI	DRECT6,A8
	MOVI	DBRECT6,A9
	MOVI	[200,0],A11		;LINES BEFORE STUFFING
	CREATE	TARGPID,STUFFRECT
	MOVK	1,A0
	MOVE	A0,@FND_NOWLK		;FIENDS CAN'T WALK NOW!
	MOVI	ENRECT13,A0
	MOVE	A0,@EN_CURRENT,L
;	.REF	BEACONS
;	CREATE	0,BEACONS		;SHOW AREA AROUND DISHES ETC.
	JRUC	NEWS1
UPDT1
;AS WE SCROLL UP INTO DESERT, SET RECTANGLE CHECK TABLES
	MOVI	DRECT5,A0
	MOVE	A0,@CURRENT,L
	MOVI	DBRECT5,A0
	MOVE	A0,@BCURRENT,L
	JRUC	NEWS1
FIX	SLEEP	54
	MOVK	10,A0
	MOVE	A0,@ARWOFF
	DIE

WAIT_HR
	MOVE	A9,A0
	CALLA	PRCSLP
	JRUC	NEWS1
;WAIT HERE FOR THIS LONG
SLFT	MOVE	@HALT,A0
	JRNZ	ISTUK6
	DEC	A9
	JRZ	NEWS1
	MOVE	@WORLDTLX,A0,L
	MOVE	@HZSPD,A1,L
	SUB	A1,A0
	MOVE	A0,@WORLDTLX,L
	CALLR	MAYBE_UD1
	SLEEPK	2
	CALLR	CK_RGTSD		;CHECK FOR PLAYERS DRAGGING AT RGT
	JRNC	SLFT
ISTUK6	SLEEPK	2
	CALLR	SEND_NEUT
	CALLR	PAUSEX2
	JRC	ISTUK6
	JRUC	SLFT
SRGT
	MOVE	@HALT,A0
	JRNZ	ISTUK6A
	DEC	A9
	JRZ	NEWS1
	MOVE	@WORLDTLX,A0,L
	MOVE	@HZSPD,A1,L
	ADD	A1,A0
	MOVE	A0,@WORLDTLX,L
	CALLR	MAYBE_UD1
	SLEEPK	2
	CALLR	CK_LFTSD		;CHECK FOR PLAYERS DRAGGING AT LFT SD
	JRC	SRGT
ISTUK6A	SLEEPK	2
	CALLR	SEND_NEUT
	CALLR	PAUSEX
	JRNC	ISTUK6A
	JRUC	SRGT

SUPLFT	MOVE	@HALT,A0
	JRNZ	ISTUK5
	DEC	A9
	JRZ	NEWS1
	MOVE	@WORLDTLY,A0,L
	MOVE	@HZSPD,A1,L
	SUB	A1,A0
	MOVE	A0,@WORLDTLY,L
	MOVE	@WORLDTLX,A0,L
	SUB	A1,A0
	MOVE	A0,@WORLDTLX,L
	CALLR	MAYBE_UD1
	SLEEPK	2
	CALLR	CK_BTMSD		;CHECK FOR PLAYERS DRAGGING AT BOTM
	JRC	ISTUK5
	CALLR	CK_RGTSD		;CHECK FOR PLAYERS DRAGGING AT RGT SD
	JRNC	SUPLFT
;STUCK UNTIL PLAYERS MOVE
ISTUK5	SLEEPK	2
	CALLR	SEND_NEUT
	CALLR	PAUSE
	JRC	ISTUK5
	CALLR	PAUSEX2			;FOR RGT SIDE OF SCRN
	JRC	ISTUK5
;CONTINUE SCROLL, I HAVE MOVED AWAY FROM WALLS
	JRUC	SUPLFT

SUP	MOVE	@HALT,A0
	JRNZ	ISTUK3
	DEC	A9
	JRZ	NEWS1
	MOVE	@WORLDTLY,A0,L
	MOVE	@HZSPD,A1,L
	SUB	A1,A0
	MOVE	A0,@WORLDTLY,L
	CALLR	MAYBE_UD1
	SLEEPK	2
	CALLR	CK_BTMSD		;CHECK FOR PLAYERS DRAGGING AT BOTM
	JRNC	SUP
ISTUK3	SLEEPK	2
	CALLR	SEND_NEUT
	CALLR	PAUSE
	JRC	ISTUK3
	JRUC	SUP
SUPRGT 	MOVE	@HALT,A0
	JRNZ	ISTUK4
	DEC	A9
	JRZ	NEWS1
	MOVE	@WORLDTLY,A0,L
	MOVE	@HZSPD,A1,L
	SUB	A1,A0
	MOVE	A0,@WORLDTLY,L
	MOVE	@WORLDTLX,A0,L
	ADD	A1,A0
	MOVE	A0,@WORLDTLX,L
	CALLR	MAYBE_UD1
	SLEEPK	2
	CALLR	CK_BTMSD		;CHECK FOR PLAYERS DRAGGING AT BOTM
	JRC	ISTUK4
	CALLR	CK_LFTSD		;CHECK FOR PLAYERS DRAGGING AT LFT SD
	JRC	SUPRGT
;STUCK UNTIL PLAYERS MOVE
ISTUK4	SLEEPK	2
	CALLR	SEND_NEUT
	CALLR	PAUSE
	JRC	ISTUK4
	CALLR	PAUSEX
	JRNC	ISTUK4
;CONTINUE SCROLL, I HAVE MOVED AWAY FROM WALLS
	JRUC	SUPRGT
	

ONEPX	DEC	A0
	SLL	5,A0
	ADDI	PLYROBJS,A0
	MOVE	*A0,A0,L
	MOVE	*A0(OXPOS),A2
	CMP	A8,A2
	JRNC	DOHORZ
	JRUC	NOHITX

SCROLLFT:
;A9=WORLDTLX TARGET TO STOP AT
	MOVE	@HALT,A0
	JRZ	SCR1X
	SLEEPK	1
	JRUC	SCROLLFT
SCR1X	MOVE	@WORLDTLX,A0,L
	SUB	A9,A0
	ABS	A0
	CMPI	10000H,A0
	JRC	STOPITX
	MOVE	@WORLDTLX,A0,L
	MOVE	@HZSPD,A1,L
	ADD	A1,A0
	MOVE	A0,@WORLDTLX,L
	CALLR	MAYBE_UD1

	SLEEPK	2

	CALLR	CK_LFTSD		;CHECK FOR PLAYERS DRAGGING AT LEFT
;IF CARRY CLEAR, THE SCROLLER IS STUCK RIGHT HERE
;IF CARRY SET, KEEP SCROLLING
	JRC	SCROLLFT
;STUCK UNTIL PLAYERS MOVE
ISTUK	SLEEPK	2
	CALLR	SEND_NEUT
	CALLR	PAUSEX
	JRNC	ISTUK
;CONTINUE SCROLL, I HAVE MOVED
	JRUC	SCROLLFT


****************************************************************************


CK_LFTSD
	MOVE	@WORLDTLX,A1,L
	SRL	16,A1
	ADDK	10,A1			;STOP SCROLL IF < THIS FROM EDGE
	MOVE	@PLYROBJS,A0,L
	JRZ	CK2X
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
	JRNC	CKRT
CK2X	MOVE	@PLYROBJS+32,A0,L
	JRZ	SETME
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
CKRT	RETS
PAUSEX:
;ONE OF THE PLAYERS IS TO FAR LEFT
;WAIT UNTIL THIS IS NOT THE CASE THEN CONTINUE SCROLL
	MOVE	@WORLDTLX,A1,L
	SRL	16,A1
	ADDI	50,A1		;70
	MOVE	@PLYROBJS,A0,L
	JRZ	CK2AX
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
	JRNC	PAUSE2X
CK2AX	MOVE	@PLYROBJS+32,A0,L
	JRZ	SETME
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
PAUSE2X	RETS
SETME	SETC
	RETS
CK_RGTSD
	MOVE	@WORLDTLX,A1,L
	SRL	16,A1
	ADDI	370,A1			;STOP SCROLL IF < THIS FROM EDGE
	MOVE	@PLYROBJS,A0,L
	JRZ	CK3X
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
	JRNC	CKRT2
CK3X	MOVE	@PLYROBJS+32,A0,L
	JRZ	SETME
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
CKRT2	RETS
PAUSEX2:
;ONE OF THE PLAYERS IS TO FAR RGT
;WAIT UNTIL THIS IS NOT THE CASE THEN CONTINUE SCROLL
	MOVE	@WORLDTLX,A1,L
	SRL	16,A1
	ADDI	340,A1		;320
	MOVE	@PLYROBJS,A0,L
	JRZ	CK2AX2
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
	JRNC	PAUSE2X2
CK2AX2	MOVE	@PLYROBJS+32,A0,L
	JRZ	SETME
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
PAUSE2X2
	RETS
SEND_NEUT
	MOVE	@SLOW_DWN,A0
	INC	A0
	MOVE	A0,@SLOW_DWN
	CMPI	280,A0
	JRLO	PAUSE2X2
;PLAYER HAS DILLY DALLIED, SEND A BOMB DOWN AT HIM

;	PUSH	A8
;	MOVK	1,A8
;	CREATE	FUTUREPID,bomb_neutron
;	PULL	A8
	NOP
	CLR	A0
	MOVE	A0,@SLOW_DWN
	RETS

STOPITX MOVI	DELPID,A0
	CLR	A1
	NOT	A1
	CALLA	KILALL
	CALLA	OFFSCRN

	MOVE	@TARGET_NUM,A0
	CMPI	2,A0
	JRNZ	STPOUT

;IN FRONT OF ELEVATOR
	MOVI	RECT5,A0
	MOVE	A0,@CURRENT,L
	CLR	A0
	MOVE	A0,@RUNIN			;FROM BOTTOM AGAIN

;DELAY START OF NEW HULK WAVE NEAR ELEVATOR
	MOVI	ERECT4,A0
	MOVE	A0,@ENEMY_RECT,L
	MOVK	4,A0
	CALLA	DOLORD

	MOVK	16,A0			;FOR JUMPING DOWN VERTICALLY
	MOVE	A0,@JUMPXY
	MOVI	035DH,A0		;FOR JUMPING DOWN HORIZONTALLY
	MOVE	A0,@JUMPXY2

;PUT IN RECTANGLES FOR ENEMY COLLISIONS HERE!
	MOVI	ENRECT4,A0
	MOVE	A0,@EN_CURRENT,L
	CREATE	FUTUREPID,POL2			 ;BRING ON SIDE POOL
	DIE

YCHK
;CHECK PLAYERS FOR Y TARGET
	MOVE	@STATUS,A0
	CMPI	3,A0
	JRNZ	ONEP
;BOTH PLYRS IN GAME
	MOVE	@PLYROBJS,A0,L
	MOVE	@PLYROBJS+32,A1,L
	MOVE	*A0(OYPOS),A2
	MOVE	*A1(OYPOS),A3
	CMP	A9,A2
	JRC	YESHIT
	CMP	A9,A3
	JRC	YESHIT
NOHIT	SLEEPK	10
	JRUC	YCHK
YESHIT
;ONE OF PLAYERS IS ABOVE TARGET LINE
	SUB	A2,A3
	ABS	A3
	CMPI	90,A3
	JRNC	NOHIT
DOVERT
;START VERT SCROLL!
	MOVE	A10,A10
	JRNZ	NEWSCRL
	MOVE	@TARGET_NUM,A10
	MOVE	@WORLDTLY,A9,L
	CMPI	7,A10			;AFTER 1ST LOCK DOWN
	JRNZ	DZL
;START HZ SCROLL ALSO
	CREATE	TARGPID,SCRDHZ
DZL
;PUT UP TEXT MESSAGE OF ZONE ZULU!
	CMPI	1,A10
	JRNZ	SKP
	.IF	DEBUG
	MOVE	@START,A0
	CMPI	3,A0
	JRNZ	SKP
	.ENDIF
	MOVI	0C0CH,A8		;0C0C	;3E3E
	CREATE	0,DO_ZONE_TXT
SKP	SLL	5,A10
	ADDI	TARGET_LST,A10
	MOVE	*A10,A0,L
	SUB	A0,A9
	JRNN	OUTA
	CLR	A9
OUTA
	CREATE	TARGPID,SCROLLDWN
	CREATE	DELPID,DELOFF
	DIE
DO_ZONE_TXT
	CMPI	1,A10
	JRNZ	ASLP
	CREATE	FUTUREPID,SEND_TOP
ASLP	SLEEP	60
	MOVE	@WORLDTLY,A0,L
	CMPI	[1F0H,0],A0
	JRGT	ASLP
	CREATE	0,ZONE_TXT
	SLEEP	60
;	CREATE	FUTUREPID,SENDH_TOP
	CREATE	FUTUREPID,SHIFTLM
	SLEEP	120
;DELAY START OF NEW HULK WAVE
	MOVI	ERECT2,A0
	MOVE	A0,@ENEMY_RECT,L
	MOVK	2,A0
	CALLA	DOLORD
;POSSIBLY PUT IN RECTANGLES FOR COLLISIONS HERE!
	CLR	A0
	MOVE	A0,@EN_CURRENT,L
	DIE

TARGET_LST:
	.LONG	[0204H,0],[0275H,0],[01E0H,0],[0701H,0],0
	.LONG	[26DH+2,0],[0,0],[1100,0],[0,0],0 		;DESERT START 26D

CKFORY2	SLEEP	60
	MOVE	@WORLDTLY,A0,L
	CMPI	[3F8H,0],A0
	JRGT	CKFORY2
;READY FOR JEEPS TO COME DOWN AT ME
	MOVK	7,A0
	CALLA	DOLORD
	MOVI	ERECT7,A0
	MOVE	A0,@ENEMY_RECT,L	;FOR SPAWNING
	MOVI	SRECT1A,A0
	MOVE	A0,@CURRENT,L
	MOVI	BSRECT1A,A0
	MOVE	A0,@BCURRENT,L
	MOVK	16,A0			;FOR JUMPING DOWN VERTICALLY
	MOVE	A0,@JUMPXY
	DIE

JEPCYC
	CALLA	JEEPCYC
;TURN ON A JEEP AND SEND HIM DOWN AT PLAYER
	MOVE	A0,*A13(PDATA+32),L	;KEEP COLOR CYCLE PROC PNTR
	SLEEP	14*60			;LAST JEEP IS OFF SCRN
	CALLR	KILJC
	DIE

CKFORY3	SLEEP	60			;FOR DESERT MINE FIELD BEFORE
	MOVE	@WORLDTLY,A0,L		;2ND LOCKDOWN!  PATHA
	CMPI	[0E42H,0],A0
	JRGT	CKFORY3
	CALLA	JEEPCYC
;TURN ON A JEEP AND SEND HIM DOWN AT PLAYER
	MOVE	A0,*A13(PDATA+32),L	;KEEP COLOR CYCLE PROC PNTR
	MOVE	@PCNT,A11
	ANDI	01,A11
	ADDK	2,A11
JP2
	MOVI	[10CH,0],B0		;X POS
	MOVI	[11EH,0],B1
	CALLA	RANGRAND
	MOVE	A0,A10
	MOVI	[1,0],B0		;JEEP SPEED
	MOVI	[2,0E000H],B1
	CALLA	RANGRAND
	MOVE	A0,A9			;VERT SPEED FOR JEEP
	CREATE	JEEPID,ONEJEEP  ;FUTUREPID
	MOVI	60*4,B0
	MOVI	60*7,B1
	CALLA	RANGRAND
	CALLA	PRCSLP
	DSJ	A11,JP2
	SLEEP	200			;LAST JEEP IS OFF SCRN
	CALLR	KILJC
CKFORY3A
	SLEEP	60			;FOR DESERT MINE FIELD BEFORE
	MOVE	@WORLDTLY,A0,L		;2ND LOCKDOWN!
	CMPI	[0CD2H,0],A0
	JRGT	CKFORY3A

	MOVE	@WORLDTLX,A9,L
;	ADDI	[70,0],A9
	MOVE	A9,A10
	ADDI	[400,0],A10		;300

	MOVK	6,A8
;START THEM MOVING
CKF3	CALLA	DOSHIFT
	SLEEP	60
;NOW STOP THEM
	CALLA	DOSHIFT2
;DIFFICULTY SETTING HERE!
	SLEEP	50		;SLEEP 1 FOR HARD DIFFICULTY
	DSJ	A8,CKF3
	DIE
KILJC
	MOVE	*A13(PDATA+32),A0,L
	CALLA	PEXIST
	JRZ	CRT
	MOVE	*A0(PROCID),A1
	CMPI	CYCPID,A1
	JRNZ	CRT
	CALLA	KILL			;KILL COLOR CYCLE PROCESS
CRT	RETS

CKFORY4
	SLEEP	120			;FOR JEEPS
	MOVE	@WORLDTLY,A0,L
	CMPI	[0FD2H,0],A0
	JRGT	CKFORY4

	CALLA	JEEPCYC
;TURN ON A JEEP AND SEND HIM DOWN AT PLAYER
	MOVE	A0,*A13(PDATA+32),L	;KEEP COLOR CYCLE PROC PNTR
	MOVE	@PCNT,A11
	ANDI	03H,A11
	ADDK	7,A11
JP1
	MOVI	[125,0],B0
	MOVI	[185,0],B1
	CALLA	RANGRAND
	MOVE	A0,A10			;XPOS FOR JEEP
	MOVI	[1,0],B0
	MOVI	[2,0E000H],B1
	CALLA	RANGRAND
	MOVE	A0,A9			;VERT SPEED FOR JEEP
	CREATE	JEEPID,ONEJEEP ;FUTUREPID
	MOVI	60*4,B0
	MOVI	60*7,B1
	CALLA	RANGRAND
	CALLA	PRCSLP
	DSJ	A11,JP1
	
	SLEEP	200			;LAST JEEP IS OFF SCRN
	CALLR	KILJC
;	MOVE	*A13(PDATA+32),A0,L
;	CALLA	KILL			;KILL COLOR CYCLE PROCESS
	SLEEP	30*60
CK4A	SLEEP	90
	MOVE	@WORLDTLY,A0,L		
	CMPI	[0BD0H,0],A0
	JRGT	CK4A
	MOVE	@WORLDTLX,A0,L		
	CMPI	[0160H,0],A0
	JRGT	CK4A
;START LAND MINES SHIFTING AT END OF PATHA!
	MOVE	@WORLDTLX,A9,L
	SUBI	[170,0],A9
	MOVE	A9,A10
	ADDI	[900,0],A10
	MOVK	4,A8
;START THEM MOVING
CKF5	CALLA	DOSHIFT
	SLEEP	60
;NOW STOP THEM
	CALLA	DOSHIFT2
;DIFFICULTY SETTING HERE!
	SLEEPK	5		;SLEEP 1 FOR HARD DIFFICULTY
	DSJ	A8,CKF3
	DIE
CKFORY	SLEEP	60
	MOVE	@WORLDTLY,A0,L
	CMPI	[780H,0],A0
	JRGT	CKFORY
	MOVE	@WORLDTLX,A9,L
	ADDI	[76,0],A9
	MOVE	A9,A10
	ADDI	[170,0],A10
	
	MOVK	6,A8
	MOVE	A8,@WAVE
	MOVK	17,A8
;START THEM MOVING
CKF	CALLA	DOSHIFT
	SLEEP	60
;NOW STOP THEM
	CALLA	DOSHIFT2
;DIFFICULTY SETTING HERE!
	SLEEP	50		;SLEEP 1 FOR HARD DIFFICULTY
	DSJ	A8,CKF

	MOVE	@WORLDTLY,A0,L
	MOVK	1,A8
	CMPI	[580H,0],A0
	JRGT	CKF
	MOVK	7,A8		;FOR BARRELS ALONG FREEWAY
	MOVE	A8,@WAVE
	CREATE	FUTRPID,CKFORY2
	DIE



ONEP	DEC	A0
	SLL	5,A0
	ADDI	PLYROBJS,A0
	MOVE	*A0,A0,L
	JRZ	NOHIT
	MOVE	*A0(OYPOS),A2
	CMP	A9,A2
	JRC	DOVERT
	JRUC	NOHIT
SCRDHZ
;MAYBE SCROLL SCREEN HORIZ
;CHECK TO SEE IF BOTH PLAYERS ARE IN FIXED Y COLUMN
;IF SO,
;CHECK CURRENT WORLDX
;IF IT IS AT BORDER, EXIT, IF NOT, SCROLL
;A9=WORLDTLY TARGET TO STOP AT
	CLR	A0
	MOVE	A0,*A13(PDATA),L		;BOTH LFT/RGT MINIMUM SCROLL
SCRDHZA
	MOVE	@HALT,A0
	JRZ	OSCR1
	SLEEPK	1
	JRUC	SCRDHZA
OSCR1
	MOVE	*A13(PDATA),A0			;GOING LEFT?
	JRNZ	GOL
	MOVE	*A13(PDATA+16),A0			;GOING RIGHT
	JRNZ	GOR
	MOVE	@WORLDTLX,A1,L
	SRL	16,A1
	ADDI	140,A1
	MOVE	@PLYROBJS,A0,L
	JRZ	PK2
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
	JRC	NOTL		;NOT ON LEFT SIDE
;THIS GUY IS ON LEFT OF SCREEN
PK2	MOVE	@PLYROBJS+32,A0,L
	JRZ	GOLZ		;GO LEFT
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
	JRC	NOTL
GOLZ
;SCROLL TO LEFT
	MOVK	30,A0
	MOVE	A0,*A13(PDATA)			;TIME GOING LEFT
	JRUC	GOL	
NOTL
;DO NOT SCROLL LEFT
;CHECK FOR RIGHT SIDE SCROLL
	ADDI	120,A1
	MOVE	@PLYROBJS,A0,L
	JRZ	XPK2
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
	JRNC	NOTR		;NOT ON RGT SIDE
;THIS GUY IS ON RGT OF SCREEN
XPK2	MOVE	@PLYROBJS+32,A0,L
	JRZ	GORZ		;GO LEFT
	MOVE	*A0(OXPOS),A0
	CMP	A0,A1
	JRNC	NOTR
GORZ
;SCROLL TO RIGHT
	MOVK	30,A0
	MOVE	A0,*A13(PDATA+16)			;TIME GOING LEFT
	JRUC	GOR
NOTRZ	CLR	A0
	MOVE	A0,*A13(PDATA+16)			;NO MORE TO RIGHT
NOTR
;NOT SCROLLING TO RIGHT
	SLEEPK	2
	JRUC	SCRDHZA
NOMORE	CLR	A0
	MOVE	A0,*A13(PDATA)
	JRUC	NOTR
GOL
;SCROLL LEFT
	DEC	A0
	MOVE	A0,*A13(PDATA)
	MOVE	@WORLDTLX,A0,L
	CMPI	[01CH,0],A0
	JRLT	NOMORE
;CAN GO FARTHER TO LEFT
	MOVE	@HZSPD,A1,L
	SUB	A1,A0
INH1	MOVE	A0,@WORLDTLX,L
	CALLR	MAYBE_UD1
	JRUC	NOTR
GOR
;SCROLL LEFT
	DEC	A0
	MOVE	A0,*A13(PDATA+16)
	MOVE	@WORLDTLX,A0,L
	CMPI	[01A0H,0],A0
	JRGT	NOTRZ
;CAN GO FARTHER TO RIGHT
	MOVE	@HZSPD,A1,L
	ADD	A1,A0
	JRUC	INH1

SCROLLDWN:
;A9=WORLDTLY TARGET TO STOP AT
	MOVE	@HALT,A0
	JRZ	SCR1
	SLEEPK	1
	JRUC	SCROLLDWN
SCR1	MOVE	@WORLDTLY,A0,L
	SUB	A9,A0
	ABS	A0
	CMPI	10000H,A0
	JRC	STOPIT
	MOVE	@WORLDTLY,A0,L
	MOVE	@HZSPD,A1,L
	SUB	A1,A0
	MOVE	A0,@WORLDTLY,L

	CALLR	MAYBE_UD1

	SLEEPK	2

	CALLR	CK_BTMSD		;CHECK FOR PLAYERS DRAGGING AT BOTM
	JRNC	SCROLLDWN
ISTUK2	SLEEPK	2
	CALLR	SEND_NEUT
	CALLR	PAUSE
	JRC	ISTUK2
	JRUC	SCROLLDWN

CK_BTMSD
	MOVE	@WORLDTLY,A1,L
	SRL	16,A1
	ADDI	220,A1
	MOVE	@PLYROBJS,A0,L
	JRZ	CK2
	MOVE	*A0(OYPOS),A0
	CMP	A0,A1
	JRC	CKBR
CK2	MOVE	@PLYROBJS+32,A0,L
	JRZ	SETME2
	MOVE	*A0(OYPOS),A0
	CMP	A0,A1
CKBR	RETS

PAUSE:
;ONE OF THE PLAYERS IS TO LOW
;WAIT UNTIL THIS IS NOT THE CASE THEN CONTINUE SCROLL
	MOVE	@WORLDTLY,A1,L
	SRL	16,A1
	ADDI	195,A1		;190
	MOVE	@PLYROBJS,A0,L
	JRZ	CK2A
	MOVE	*A0(OYPOS),A0
	CMP	A0,A1
	JRC	PAUSE2
CK2A	MOVE	@PLYROBJS+32,A0,L
	JRZ	SETME2
	MOVE	*A0(OYPOS),A0
	CMP	A0,A1
PAUSE2	RETS
SETME2	CLRC
	RETS

MAYBE_UD1
	DEC	A8
	MOVE	A8,A0
	MOVK	1FH,A0
	AND	A8,A0
	JRNZ	NOBGND
;CALL BGND_UD1 OCCASIONALLY
	MOVE	A0,@SLOW_DWN
	JAUC	BGND_UD1
NOBGND
	RETS

STOPIT	MOVI	DELPID,A0
	CLR	A1
	NOT	A1
	CALLA	KILALL
	CALLA	OFFSCRN
	MOVE	@TARGET_NUM,A0
	CMPI	8,A0
	JRZ	LCK1
	CMPI	6,A0
	JRZ	YEA
	CMPI	5,A0
	JRNZ	STP0
YEA
;DESERT AREA 1ST STOPPAGE
	MOVK	2,A0
	MOVE	A0,@ARWOFF		;BLINK ARROW X MORE TIMES THEN KILL!
	MOVI	DRECT2,A0
	MOVE	A0,@CURRENT,L
	MOVI	DBRECT2,A0
	MOVE	A0,@BCURRENT,L

	SLEEPK	20

	MOVK	5,A10
	MOVI	[-16,0],A9		;Y ADD IN VALUE
	CREATE	0,ZONE_TXT2
;NO COLLISIONS
	CLR	A0
	MOVE	A0,@EN_CURRENT,L	;FOR BOX COLLISIONS
	MOVI	ERECT10,A0
	MOVE	A0,@ENEMY_RECT,L	;FOR SPAWNING

	SLEEPK	30			;40
	MOVK	8,A0
	MOVE	A0,@CTOTAL
	MOVK	10,A0
	CALLA	DOLORD			;STORE WAVE #, START WAVE CODE
	DIE

STP0	CMPI	1,A0
	JRZ	STP1
	CMPI	3,A0
	JRNZ	STPOUT
;END OF SECRET PATH
	MOVK	8,A0
	CALLA	DOLORD
	MOVI	ERECT8,A0
	MOVE	A0,@ENEMY_RECT,L	;FOR SPAWNING
	CLR	A0
	MOVE	A0,@WORLDTLY,L
	CREATE	FUTUREPID,POL			;BRING ON BOTTOM POOL
	DIE
STP1
;REACTOR ON SCREEN
	CLR	A0
	MOVE	A0,*A13(PROCID),W
	MOVI	10000H,A0
	MOVE	A0,@WORLDTLY,L
	MOVI	RECT3,A0
	MOVE	A0,@CURRENT,L
;DELAY START OF NEW HULK WAVE
	MOVI	ERECT3,A0
	MOVE	A0,@ENEMY_RECT,L
	MOVK	3,A0
	CALLA	DOLORD
	MOVI	ICN2,A0
	MOVE	A0,@ICLIST,L
	CREATE	ICONPID,SEND_ICON
;PUT IN RECTANGLES FOR ENEMY COLLISIONS HERE!
	MOVI	ENRECT3,A0
	MOVE	A0,@EN_CURRENT,L
	CREATE	FUTUREPID,POL			;BRING ON BOTTOM POOL
	MOVI	CYCPID,A0
	MOVE	A0,*A13(PROCID)
;TEMPORARY SHIT
	SLEEP	7*60
	CREATE	CYCPID,PUMP_RED
	MOVI	10000H,A0
	MOVE	A0,@WORLDTLY,L
	DIE
ENDWV
;WAIT HERE UNTIL END OF WAVE REACHED!
;BATS TO FLY OUT OF SLIME?

;AT TOP OF FIRST WORLD
;START ARROW TO RIGHT!
;WAVE DONE
	MOVI	SECDR,A0
	CLR	A1
	NOT	A1
	CALLA	EXISTP
	JRZ	NOCH0
;FOUND SECRET DOOR PROCESS
	CALLA	KILL
NOCH0

	CLR	A0			;FOR BARREL EXPLOSION TIMING
	MOVE	A0,@WAVE

	MOVE	@KEEPIT,A8,L		;GET RID OF RIGHT SIDE POOL
	MOVI	8000H,A1
	MOVE	A1,*A8(OXVEL),L
	
;START HORZ SCROLL TO ELEVATOR
	MOVK	1,A9			;A9=0 FOR UP, 1 FOR RGT
	CREATE	ARWPID,ONARRW		;TURN ON UP ARROW
	MOVK	2,A0
	MOVE	A0,@TARGET_NUM		;NEXT TARGET NUMBER FOR SCROLL
	MOVE	@WORLDTLX,A8,L
	SRL	16,A8
	ADDI	80,A8	   ;200 	;A8=X TARGET LINE TO TRIGGER SCROLL
	CLR	A9			;A9=0 MEANS NOT CHECKING FOR Y TARGET
	CLR	A10
	CREATE	TARGPID,TARGET
	SLEEP	53
	MOVK	15,A0
	MOVE	A0,@ARWOFF		;BLINK ARROW X MORE TIMES THEN KILL!
	MOVE	@KEEPIT,A0,L		;GET RID OF RIGHT SIDE POOL
	CALLA	DELOBJ

STPOUT	DIE
SETRUNIN
;A10=TARGET FOR CHANGING @RUNIN TO 1
	SLEEP	60
	MOVE	@WORLDTLX,A0,L
	CMP	A10,A0
	JRLT	SETRUNIN
	MOVK	1,A0
	MOVE	A0,@RUNIN
	DIE


DELOFF	SLEEP	3*60
;FOR SCROLLING DOWN
	CALLA	DELOFFBOT
	JRUC	DELOFF
DELOFFH SLEEP	8*60
;FOR SCROLLING RGT TO LEFT
	CALLA	DELOFFBOTL
	JRUC	DELOFFH

DELOFFBOTL:
;DELETE FOREGROUND OBJECTS THAT ARE OFF LEFT SIDE OF SCREEN
	MOVE	@WORLDTLX,A1,L
	SRL	16,A1
	MOVI	RAMLST,A3
	CLR	A0
	MOVE	A0,*A3,L
	MOVI	OBJLST,A0
SOBJS1X
	MOVE	*A0,A0,L
	JREQ	SOBJSX			;SEARCHED THEM ALL
	MOVE	*A0(OID),A4,W
	CMPI	CLSNEUT|TYPTRUNK,A4
	JRZ	CONTAX
	CMPI	CLSNEUT|TYPICON|SUBCSH,A4
	JRZ	CONTAX
;ENTER OTHER OIDS TO KILL HERE
	JRUC	SOBJS1X
CONTAX	MOVE	*A0(OXPOS),A2
	MOVE	*A0(OSIZEX),A4
	ADD	A4,A2
	CMP	A2,A1
	JRC	SOBJS1X
CONTAXB	MOVE	A0,*A3+,L		;IMG TO BE DELETED
	CLR	A4
	MOVE	A4,*A3,L		;ZERO NEXT ENTRY
	JRUC	SOBJS1X

DELOFFBOT:
;DELETE FOREGROUND OBJECTS THAT ARE OFF BOTTOM OF SCREEN
	MOVE	@WORLDTLY,A1,L
	ADDI	[260,0],A1
	SRL	16,A1
	MOVI	RAMLST,A3
	CLR	A0
	MOVE	A0,*A3,L
	MOVI	OBJLST,A0
SOBJS1
	MOVE	*A0,A0,L
	JREQ	SOBJSX
	MOVE	*A0(OID),A4,W
	CMPI	CLSNEUT|TYPTRUNK,A4
	JRZ	CONTA
	CMPI	CLSNEUT|TYPICON|SUBCSH,A4
	JRZ	CONTA
;	CMPI	CLSNEUT|TYPMINE,A4		;9/16/91
;	JRZ	CONTA0
;ENTER OTHER OIDS TO KILL HERE
	JRUC	SOBJS1
;CONTA0
;	MOVE	*A0(OYPOS),A2
;	CMP	A2,A1
;	JRNC	SOBJS1
;	MOVE	*A0(OPLINK),A1,L
;	JRZ	CONTAB
;	SWAP	A0,A1
;	CALLA	KILL
;	MOVE	A1,A0
;	JRUC	CONTAB
CONTA	MOVE	*A0(OYPOS),A2
	CMP	A2,A1
	JRNC	SOBJS1
CONTAB
	MOVE	A0,*A3+,L		;IMG TO BE DELETED
	CLR	A4
	MOVE	A4,*A3,L		;ZERO NEXT ENTRY
	JRUC	SOBJS1
SOBJSX
	MOVI	RAMLST,A1
DELT	MOVE	*A1+,A0,L
	JRZ	DELX
	CALLA	DELOBJ
	JRUC	DELT
DELX	RETS

POL
;TURN ON BOTTOM GOOB POOL
	MOVI	GOOB,A14
	CALLA	DO_ALL_STUFF
	MOVE	A0,A8
	SLEEP	04CH
	CLR	A0
	MOVE	A0,*A8(OYVEL),L
	MOVI	0F4H,A0
	MOVE	A0,*A8(OYPOS)
	DIE
;POL1
;;TURN ON BOTTOM GOOB POOL
;	MOVI	GOOB,A14
;	CALLA	DO_ALL_STUFF
;	CALLA	ADJSTWTL
;	MOVE	A0,A8
;	SLEEP	04CH
;	CLR	A0
;	MOVE	A0,*A8(OYVEL),L
;	DIE
POL2
;TURN ON SIDE GOOB POOL BY ELEVATOR
	MOVI	GOOBA,A14
	CALLA	DO_ALL_STUFF
	CALLA	ADJSTWTL
	MOVE	A0,A8
	SLEEP	04CH
	CLR	A0
	MOVE	A0,*A8(OXVEL),L
	DIE
GOOB:
	.LONG	[0DAH,0],[0108H,0],GOOBB
	.WORD	20,DMAWNZ|M_NOCOLL,CLSNEUT|TYPNEUT
	.LONG	0,-4000H
GOOBA:
	.LONG	[1DCH-1DFH,0],[084H,0],GOOBR
	.WORD	20,DMAWNZ|M_NOCOLL|M_FLIPH,CLSNEUT|TYPNEUT
	.LONG	04000H,0

BNC_PLYR2
;MOVE PLAYER AWAY FROM SOME OBJECT
;A8=PLYR LEGS
;A0=OBJECT TO SLIDE AWAY FROM
;BNC FARTHER AWAY WITH THIS ENTRY POINT
	MMTM	SP,A1,A2,A3,A4,A5,A6,A7,A9
	MOVI	[2,0],A7
	JRUC	BNCIN
BNC_PLYR
;MOVE PLAYER AWAY FROM SOME OBJECT
;A8=PLYR LEGS
;A0=OBJECT TO SLIDE AWAY FROM
	MMTM	SP,A1,A2,A3,A4,A5,A6,A7,A9
	MOVI	[1,8000H],A7
BNCIN:
	MOVE	*A8(OIMG),A1,L
	CMPI	BLADE,A1
	JRZ	AOUT3
	MOVE	A0,A9
	MOVE	A8,-*SP,L		;PUSH A8
	MOVE	A0,A8
	CALLA	GETCPNT
;A1=Y/X CENTER POS
	MOVE	*SP+,A8,L		;PULL A8
	CLR	A2
	MOVX	A1,A2
	SLL	16,A2
	MOVE	A1,A3
	MOVE	*A8(OPLINK),A5,L
	MOVE	*A5(TSO_PTR),A5,L
	MOVE	A8,A1
	MOVE	*A1(OXVAL),A4,L
	MOVE	*A5(OXVAL),A6,L
	CMP	A4,A2
	JRGT	GONEG
;ADD TO PLYR X
	ADD	A7,A4
	ADD	A7,A6
	JRUC	GOGO
GONEG
	SUB	A7,A4
	SUB	A7,A6
GOGO
	MMTM	SP,A4,A6
	MOVE	*A1(OYVAL),A4,L
	MOVE	*A5(OYVAL),A6,L
	CMP	A4,A3	
	JRGT	GONEG2
;ADD TO PLYR Y
	ADD	A7,A4
	ADD	A7,A6
	JRUC	GOGO1
GONEG2	SUB	A7,A4
	SUB	A7,A6
GOGO1
	MMFM	SP,A0,A2
;FIRST CHECK TO SEE IF THIS WILL PUSH PLAYER INTO BAD RECTANGLE AREA
;A0 TO *A1(OXPOS)
;A4 TO *A1(OYPOS)
	MMTM	SP,A0,A1,A2,A4,A6
	MOVE	A4,A6
	MOVE	A0,A4
;CHECK FOR RECTANGLE COLLISIONS
	ADDK	4,A4
	ADDK	4,A6
	MOVE	@CURRENT,A0,L		;CURRENT RECT LIST
	JRZ	AOUT
ANEXT0	MOVE	*A0+,A1,W
	JRZ	AOUT
	SLL	16,A1
	CMP	A1,A4
	JRLT	ANEXT			 ;IF BRNCH RECT LFT EDGE > PLYR X
	MOVE	*A0+,A1,W
	SLL	16,A1
	CMP	A1,A6
	JRLT	ANEXTA			 ;IF BRNCH RECT TOP EDGE > PLYR Y
	MOVE	*A0+,A1,W
	SLL	16,A1
	CMP	A1,A4
	JRGT	ANEXTB			 ;IF BRNCH RECT RGT EDGE < PLYR X
	MOVE	*A0+,A1,W
	SLL	16,A1
	CMP	A1,A6
	JRGT	ANEXT0			 ;IF BRNCH RECT BOT EDGE < PLYR Y
;HIT
	MMFM	SP,A0,A1,A2,A4,A6
;BLOW UP BARREL IN A9!
	MOVE	*A9(OIMG),A0,L
	CMPI	BRRL2,A0
	JRZ	YKL
	CMPI	CRT1,A0
	JRNZ	AOUT3
YKL	CALLA	KILL_CRT3
	JRUC	AOUT3

ANEXT	ADDI	48,A0
	JRUC	ANEXT0
ANEXTA	ADDK	32,A0
	JRUC	ANEXT0
ANEXTB	ADDK	16,A0
	JRUC	ANEXT0

AOUT
	MMFM	SP,A0,A1,A2,A4,A6
AOUT2
	MOVE	A4,*A1(OYVAL),L		;LEGS
	MOVE	A6,*A5(OYVAL),L
	MOVE	A0,*A1(OXVAL),L		;LEGS
	MOVE	A2,*A5(OXVAL),L
AOUT3
	MMFM	SP,A1,A2,A3,A4,A5,A6,A7,A9
	RETS

SHOTKILL
;IN HERE WHEN A GOO SHOT KILLS PLAYER
;A8=PLAYER PNTR TO DIE
	MMTM	SP,A1,A2,A6,A7,A10,A11
	MOVE	*A13(MYLIST),A7,L	;SLM,A9
	CMPI	BURST,A7
	JRNZ	SKL2
	MOVI	CLSENMY|TYPLAYR|SUBFLM,A7
	MOVE	A7,*A0(OID)		;THIS BULLET WILL FLAME PLAYER
	JRUC	SKL2

WARP_KIL
	MMTM	SP,A1,A2,A6,A7,A10,A11
;A0=PLYR PROCESS
;A7=^
	MOVI	CLSENMY|TYPLAYR,A11
	JRUC	WRPK

bombn_killp	;A0=*Player process

	MMTM	SP,A1,A2,A6,A7,A10,A11
	move	a0,a7
	movi	CLSNEUT|TYPMINE,A11
	JRUC	WRPK

GATE_PLYR:
;PLYR IN A8, KILLER IN A0
	MMTM	SP,A1,A2,A6,A7,A10,A11
	MOVE	@HALT,A1
	JRNZ	GAMOK
	MOVE	*A8(OPLINK),A7,L
;	MOVE	*A7(DELYDET),A1
;	JRZ	EKRU
;	sll	32-9,a1			;And >1ff
;	srl	32-9,a1
;	JRNZ	GAMOK
;EKRU
	MOVE	*A7(DEAD),A1
	JRNZ	GAMOK
;YES, KILL THIS PLYR
;A0=KILLER IMG PNTR
	MOVE	A0,A10			;PASS ALONG FOR MINE DEATH
	MOVE	A10,*A7(KILLERO),L	;KEEP KILL PNTR
;AN ELECTRIFIED LAND MINE
	MOVI	CLSNEUT|TYPMINE|01,A11
	JRUC	NOT_MINE

KILL_PLYR:
;MAKE MORE EFFICIENT!!!
;SAVE REGISTERS!?!
;PLYR IN A8, KILLER IN A0
	MMTM	SP,A1,A2,A6,A7,A10,A11
;	MOVE	*A0(OID),A1
;	ANDI	0FFFFH,A1
;	CMPI	CLSENMY|TYPORBL,A1
;	JRNE	NSHKME			;SHOCK PLAYER
;LAZER INTO PLAYER!
;DIFFERET SIZE FOR DETECTION
;	CALLA	SHORT2
;	JRNC	GAMOK
;	JRUC	KP99
;NSHKME

	CALLA	SHORT_PLYR		;REALLY A HIT?
	JRNC	GAMOK			;BR=NO COLLIDE!
;KP99
	MOVE	@HALT,A1
	JRNZ	GAMOK
SKL2
	MOVE	*A8(OPLINK),A7,L
	MOVE	*A7(DELYDET),A1
	JRZ	KRU
	sll	32-9,a1			;And >1ff
	srl	32-9,a1
	JRNZ	GAMOK
KRU	MOVE	*A7(DEAD),A1
	JRNZ	GAMOK
;YES, KILL THIS PLYR
;A0=KILLER IMG PNTR
	MOVE	A0,A10			;PASS ALONG FOR MINE DEATH
	MOVE	A10,*A7(KILLERO),L	;KEEP KILL PNTR
	MOVE	*A0(OID),A11
	zext	a11
	CMPI	CLSENMY|TYPLAYR,A11
	JRNZ	NOTLAY
;KILLED BY MINE LAYER, TELL MINE LAYER TO FLAME UP
	MMTM	SP,A7,A8
	MOVE	A0,A8
	MOVE	*A0(OFLAGS),A1
	ORI	M_NOCOLL,A1
	MOVE	A1,*A0(OFLAGS)
	MOVE	*A0(OPLINK),A0,L
	MOVI	LAY_EXP,A7		;END OF MINE LAYER DEATH - NO FLAMES
	CALLA	XFERPROC
	MMFM	SP,A7,A8
      	
NOTLAY	CMPI	CLSNEUT|TYPMINE,A11
	JRNE	NOT_MINE
	MOVE	*A7(LEG_PRC),A0,L
	MOVE	*A0(SHOECNT),A0
	JRZ	KM
	BTST	15,A0			;CHECK FOR TENNIS SHOES BIT
	JRZ	GAMOK
;YES, WEARING TENNIS SHOES!

;KILL MINE
KM	PUSH	A7
	MOVE	*A10(OIMG),A0,L
	CMPI	M1,A0
	JRZ	KM2
;AN ELECTRIFIED LAND MINE
	MOVE	*A10(OPLINK),A0,L
	CALLA	KILL
	MOVI	CLSNEUT|TYPMINE|01,A0
	MOVI	CLSNEUT|TYPMINE|01,A11
	JRUC	KM2A
KM2	MOVI	CLSNEUT|TYPNEUT,A0
KM2A	MOVE	A0,*A10(OID),W
	CREATE	0,EXPMINE2		;KILL LAND MINE (A10=PTR)
	MOVI	MTING,A0			;LAND MINE EXPLOSION SND
	CALLA	ONESND
	PULL	A7

	MOVE	*A7(PNUM),A0
	MOVI	P1DATA,A2
	DEC	A0
	JRZ	KM1
	MOVI	P2DATA,A2
KM1	MOVE	*A2(TMINEDTH),A0	;LAND MINE DEATH STAT
	INC	A0
	MOVE	A0,*A2(TMINEDTH)

NOT_MINE
;A11=OID OF WHAT KILLED THIS PLAYER
;A10=KILLER IMAGE PTR
	CLR	A0
	MOVE	A0,*A8(OXVEL),L
	MOVE	A0,*A8(OYVEL),L
	MOVE	*A7(TSO_PTR),A1,L
	MOVE	A0,*A1(OXVEL),L
	MOVE	A0,*A1(OYVEL),L
	MOVE	A7,A0			;A7=PLYR IMG OPLINK
WRPK
	MOVE	A11,*A0(DEAD),W
;IF HELPER ON, SEND IT FLYING
	MOVE	*A0(LSRPTR),A1,L
	JRZ	NLZ
;YES LAZER ON
	PUSH	A8
	MOVE	A1,A8
	CALLA	LSHIT
	PULL	A8
NLZ
;GIVE THE PLAYER A POINT FOR DIEING!
	MOVI	P1DATA,A11
	CLR	A2
	movi	timerp1sd,a1
	MOVE	*A0(PNUM),A0
	DEC	A0
	JRZ	CG
	MOVI	P2DATA,A11
	MOVI	timerp2sd,a1
CG	move	a2,*a1,W
	MOVE	A11,A2
	CLR	A1
	MOVE	A1,*A11(PTSRAM),W
;A2=P1DATA OR P2DATA
	MOVK	>1,A1			;AMOUNT OF SCORE
	CALLA	SCRADD2			;DO IT!


* XFERPROC - TRANSFER CONTROL OF AN EXISTING PROCESS
* A0 = PTR OF PROCESS TO BE XFER'D
* A1 = NEW I.D.
* A7 = WAKE UP
* A8 - A11 = PASSED TO THE XFER'D PROC
	MOVI	PLY1PID,A1
	MOVE	*A7(PNUM),A0
	CMPI	1,A0
	JRZ	U8A
	MOVI	PLY2PID,A1
U8A  	MOVE	*A7(LEG_PRC),A0,L
	MOVE	A7,A10			;A10=TSO_PRC
	CALLA	GETA8
	MOVI	I_DIE,A7
	CALLA	XFERPROC



	MOVE	*A11(PLIVES),A0,W	;TEMP
	CMPI	9,A0
	JRC	TAG1
	MOVK	8,A0
	MOVE	A0,*A11(PLIVES),W
TAG1	CMPI	0,A0
	JRNZ	GAMOK
;OUT OF LIVES
;CHANGE MESSAGE ON HIS SCOREBOARD/PLUS STILL SHOW PLAYER SCORE!
;COLOR CYCLE IT
;DISPLAY A COUNTDOWN


	CLR	A0
	MOVE	A0,@THIS_PLYR,W

	MOVK	1,A1
	MOVE	A1,*A11(CNTD)		;FLAG FOR MESSAGES AND CNTR
	CMPI	P1DATA,A11
	JRNE	F3
	CREATE	P1PID,MSG_PROC2
	CREATE	0,ANNC2
	JRUC	F4
ANNC2	SLEEP	150
	MOVI	NOWAY,A0		;MAJOR MAYHEM IS DEAD - 10 SECONDS
	CALLA	ONESND
	DIE
F3	CREATE	P2PID,MSG_PROC2
	CREATE	0,ANNC2
F4	MOVE	@STATUS,A0
	CMPI	3,A0
	JRZ	GAMOK
;IS PLAYER CNTING DOWN?
	MOVE	@CNTDIG1,A2
	MOVE	@CNTDIG2,A1
	OR	A2,A1
	JRNZ	GAMOK
	CREATE	BUYINPID,PSTAT
GAMOK:
	MMFM	SP,A1,A2,A6,A7,A10,A11
	RETS
	
CTRLS	.LONG	P1CTRL,P2CTRL

**************************************************************************
*									 *
*	DRAW_PLYR_TORSO							 *
*									 *
**************************************************************************
DRAW_PLYR_TORSO:
;A8=1 OR 2 FOR PLAYER NUM
;
	MOVE	A8,*A13(PNUM)		;A8=1 OR 2 FOR WHAT PLAYER THIS IS
	DEC	A8
	SLL	5,A8
	MOVI	CTRLS,A1
	ADD	A8,A1
	MOVE	*A1,A0,L
	MOVE	A0,*A13(STICK),L	;PLACE CORRECT STICK READ ADDR

	ADDI	PLYRPRCS,A8
	MOVE	A13,*A8,L		;PUT PLYR PROC INTO TABLE PLYRPRCS
	CALLA	STRT_PLYR_LEGS
	MOVE	A0,*A13(LEG_PTR),L	;KEEP LEG PTR IN TORSO STURCTURE
	MOVK	02H,A0			;1
;		1
;	8		5
;7				4
;	9		6
;		2
	MOVE	A0,*A13(P_DIR),W
	MOVE	A0,*A13(TMP_P_DIR),W

	CALLA	STRT_PLYR_TORSO

	MOVE	A8,*A13(TSO_PTR),L	;KEEP TORSO PTR IN TORSO STRUCTURE!?
	MOVE	*A13(PNUM),A0
	DEC	A0
	SLL	5,A0
	ADDI	PLYROBJS,A0
	MOVE	A8,*A0,L		;INSERT TORSO PTRS INTO TABLE
	
	MOVE	*A13(LEG_PTR),A9,L	;READY TO PASS LEG ALONG TO LEG PROC
	MOVE	A13,A10			;PASS TORSO PROC TO LEG

	MOVE	*A13(PNUM),A0
	CMPI	1,A0
	JRNE	AXC
	CREATE	PLY1PID,DRAW_PLYR_LEGS
	MOVI	P1DATA,A11
	CALLA	STUFF_LVADDR
	JRUC	AXCD
AXC
	CREATE	PLY2PID,DRAW_PLYR_LEGS
	MOVI	P2DATA,A11
	CALLA	STUFF_LVADDR
AXCD
	MOVK	2,A0			;1
	MOVE	A0,*A13(OLD_P_DIR),W
	CLR	A0
	MOVE	A0,*A13(DEAD),W
	MOVE	A0,*A13(LSRPTR),L
	MOVE	A0,*A13(SHOOT_FLAG),W
	MOVE	A0,*A13(WPN_TYP),W	
;	MOVE	A0,*A13(TSHOTS)		;TOTAL SHOTS FIRED

	MOVE	*A13(PNUM),A7
	DEC	A7
	SLL	5,A7
	ADDI	PLYRPRCS,A7
	MOVE	*A7,A7,L
	MOVI	70,A0
	MOVE	A0,*A13(DELYDET)
TORSO_1
	CLR	A0
	MOVE	A0,*A13(REV_FLAG)

	MOVE	*A13(DEAD),A1
	JRNZ	DIE_CODE

NDD	move	*a13(STICK),a0,L
	move	*a0,a0			;GET P1/P2CTRL INFO
	srl	4,a0
	jrnz	TORSO_2			;Pass A0

;NOT_TOUCHED:
;		1
;	8		5
;7				4
;	9		6
;		2
	CLR	A0
	MOVE	A0,*A13(OSHTDIR)
	MOVE	*A13(P_DIR),A14		;DIR + HIBIT SET IF STATIONARY
	JRNN	RUNNING			;Test bit15
; P1 IS STANDING STILL.  PLACE CORRECT TORSO ON TOP OF FEET
; CHECK FOR ALREADY THERE!
	movk	>1f,a1
	and	a1,a14
	move	a0,*a13(OLD_P_DIR)

	MOVE	A8,A0
	MOVE	*A13(LEG_PTR),A8,L	;GET LEG PTR OUT OF TORSO STRUCT
	CALLA	GETANIXY
	MOVE	*A8(OFLAGS),A4,W
	ORI	M_NOCOLL,A4		;TORSO ALWAYS M_NOCOLL
	CALLA	GANISAG
	MOVE	A0,A8

	MOVE	A14,A0
	MOVE	*A13(WPN_TYP),A2,W
	SLL	5,A2
	ADDI	WPNWALK,A2
	MOVE	*A2,A2,L
	SLL	5,A0
	ADD	A0,A2
	MOVE	*A2,A1,L

	ADDI	T_WALK_FLG,A0
	MOVE	*A0,A4,W

	CALLA	ANI

LTP	SLEEPK	1
	JRUC	TORSO_1

RUNNING
	MOVE	A8,A0
	MOVE	*A13(LEG_PTR),A8,L
	CALLA	GETANIXY
	MOVE	*A8(OFLAGS),A4,W
	ORI	M_NOCOLL,A4		;TORSO ALWAYS M_NOCOLL
	CALLA	GANISAG
	MOVE	A0,A8

	MOVE	*A13(P_DIR),A4		;CURRENT DIR P1 IS FACING
	SLL	5,A4
	MOVE	*A13(WPN_TYP),A1
	SLL	5,A1
	ADDI	WPNWALK,A1
	MOVE	*A1,A1,L		;MOVE BASE TABLE ADDRESS INTO A1
	ADD	A4,A1			;CALCULATE OFFSET IN TABLE
	MOVE	*A1,A1,L		;MOVE TABLE VALUE INTO A9
	CMP	A1,A9
	JREQ	TEE
	MOVE	A1,A9
	ADDI	T_WALK_FLG,A4
	MOVE	*A4,A4			;FLAG

	CALLA	ANI

TEE	SLEEPK	1
	JRUC	TORSO_1

;		.byte	0,1,5,0,7,8,6,0,3,2,4,0,0,0,0,0	;Good
firedir_t	.byte	1,1,5,1,7,8,6,1,3,2,4,1,1,1,1,1	;Good with illegals
		.byte	1,1,2,1,7,8,9,1,4,5,6,1,1,1,1,1	;Old crap version

; PLAYER IS SHOOTING
; STICK IS BEING PRESSED
TORSO_2
	clr	a1
	move	a1,*a13(OLD_P_DIR)

	sll	3,a0			;*8
	addi	firedir_t,a0
	movb	*a0,a9			;Pass A9 to weapon (New version)
	addi	16*8,a0
	movb	*a0,a4


;PLAYER WILL BEGIN FRANIM OF SHOOTING IN PROPER DIRECTION
	move	*a13(P_DIR),a0
	movk	>f,a1
	and	a1,a0
	MOVE	*A13(OSHTDIR),A5
	CMP	A4,A5
	JREQ	JJ
	CLR	A5			;SHOOTING IN NEW DIR. ZERO REV_DIR.
	MOVE	A5,*A13(REV_P_DIR),W
JJ	MOVE	A4,*A13(OSHTDIR)
	MOVE	A4,*A13(SHOOT_FLAG),W

	MOVI	REVERSE,A1
	SLL	4,A4
	ADD	A4,A1
	MOVE	*A1,A1			;GET TABLE VALUES FOR THIS BDIR
;NOW BIT TEST CORRECT PDIR BIT TO SEE IF WE WILL NEED TO FLIP LEGS
	BTST	A0,A1
	JRZ	NOR
;YES WE MUST REVERSE PLAYERS LEGS BECAUSE HE IS TWISTING TO FAR!
	MOVK	1,A1
	MOVE	A1,*A13(REV_FLAG),W
NOR
	SLL	1,A4
	MOVE	*A13(WPN_TYP),A5
	SLL	5,A5
	ADDI	LISTWHAT,A5
	MOVE	*A5,A5,L
	SLL	5,A0
	ADD	A0,A5
	MOVE	*A5,A3,L
	
	ADD	A4,A3			;CALCULATE OFFSET IN TABLE
	move	a3,-*sp,L
	CALLA	STRT_WPN		;TORSO CONTROLS
	move	*sp+,a3,L

	MOVE	*A3,A9,L		;MOVE TABLE VALUE INTO A9
					;THIS IS NEW FRANIM SCRIPT PNTR
	MOVK	1,A1
	JSRP	FRANIM

	CLR	A0
	MOVE	A0,*A13(SHOOT_FLAG)

	JRUC	TORSO_1

**************************************************************************
*									 *
*	DRAW_PLYR_LEGS							 *
*									 *
**************************************************************************
DRAW_PLYR_LEGS:
;A8=TORSO ABOVE THESE LEGS
;A10=PROCESS OF TORSO ABOVE THESE LEGS
;A9=LEG PNTR FOR THESE LEGS (IMAGE ALREADY STARTED)
	MOVE	A8,*A13(TSO_PTR),L	;A8=TORSO FOR THESE LEGS
	MOVE	A10,*A13(TSO_PRC),L	;A10=TORSO PROCESS PNTR
	MOVE	A9,*A13(LEG_PTR),L	;A9=LEG PTR
	MOVE	A13,*A10(LEG_PRC),L
	CLR	A0
	MOVE	A0,*A13(SHOECNT)

	MOVE	A9,A8			;A8=LEG PNTR
	MOVI	PWK_UP,A10		;INIT FRANIM SCRIPT RESET
	MOVE	A10,A9			;FRANIM NEEDS IT IN A9

MOVE_TOP:
	MOVE	*A8(OFLAGS),A0
	BTST	11,A0			;TAKE OUT!!!!
	JRZ	MVT
	LOCKUP
	EINT
MVT
	MOVE	*A13(TSO_PRC),A7,L
	CALLA	UPDATE_PLYRXY
	JRC	DO_FRANI			
; PLAYER IS NOT TOUCHING MOVEMENT STICK!
; SET STAND FLAG, AND PNT TO CORRECT IMAGE
	MOVE	*A13(SHOECNT),A1
	JRZ	REG7
	BTST	15,A1
	JRNZ	REG7
;FLYING BOOTS ON, NOT TENNIS SHOES
;SLOW DOWN THIS GUYS VELOCITY
	MOVE	*A8(OXVEL),A0,L
	MOVE	*A8(OYVEL),A1,L
	OR	A0,A1
	JRZ	REG71
;
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A5,L
	CLR	A3			;DIR CNT
;CHECK FOR RIGHT SIDE OF SCREEN
	MOVE	@WORLDTLX,A0,L	;*A7(RGTBND),A0,L
	ADDI	[375,0],A0
	CMP	A0,A4
	JRGT	REG7
;SCRN EDGE OK
	MOVE	@WORLDTLX,A0,L	;MOVE	*A7(LFTBND),A0,L
	ADDI	[10,0],A0
	CMP	A0,A4
	JRLE	REG7
	MOVE	@WORLDTLY,A0,L	;MOVE	*A7(DNBND),A0,L
	ADDI	[240,0],A0
	CMP	A0,A5
	JRGE	REG7
	MOVE	@WORLDTLY,A0,L	;MOVE	*A7(UPBND),A0,L
	ADDI	[15,0],A0
	CMP	A0,A5
	JRLE	REG7
	MOVE	A5,A6		;T1 NEEDS A6=YVAL
	CALLR	THIS_DIR
	CMPI	1,A1
	JRZ	REG7
;NOT COASTING INTO A WALL OR SCRN BORDER
	MOVE	@PCNT,A1
	ANDI	07,A1
	JRNZ	REG71
;SLOW ME DOWN
	MOVE	*A13(TSO_PTR),A2,L	;GET TORSO PNTR FOR THESE LEGS
	MOVE	*A8(OXVEL),A1,L
	JRN	U7
	SRL	1,A1
	MOVE	A1,*A8(OXVEL),L
	MOVE	A1,*A2(OXVEL),L
	JRUC	U7A
U7	NEG	A1
	SRL	1,A1
	NEG	A1
	MOVE	A1,*A8(OXVEL),L
	MOVE	A1,*A2(OXVEL),L
U7A
	MOVE	*A8(OYVEL),A1,L
	JRN	U8
	SRL	1,A1
	MOVE	A1,*A8(OYVEL),L
	MOVE	A1,*A2(OYVEL),L
	JRUC	REG71
U8	NEG	A1
	SRL	1,A1
	NEG	A1
	MOVE	A1,*A8(OYVEL),L
	MOVE	A1,*A2(OYVEL),L
	JRUC	REG71
REG7
	CLR	A0
	MOVE	A0,*A8(OXVEL),L
	MOVE	A0,*A8(OYVEL),L
	MOVE	*A13(TSO_PTR),A1,L	;GET TORSO PNTR FOR THESE LEGS
	MOVE	A0,*A1(OXVEL),L		;UPDATE TORSO INFO
	MOVE	A0,*A1(OYVEL),L		;UPDATE TORSO
REG71
;A7=TORSO PROC
	MOVK	1,A0
	MOVE	A0,*A7(HAVE_REV),W	;UPDATE TORSO
	MOVE	*A7(SHOOT_FLAG),A0	;GET TORSO INFO
	JRZ	CONT_1
; PLAYERS TORSO IS SHOOTING, MAKE FEET TURN IN SAME DIRECTION AS BODY
	ORI	08000H,A0
	MOVE	A0,*A7(P_DIR),W
	ANDI	01FH,A0
	SLL	5,A0
; PLAYER WILL BEGIN FRANIM OF SHOOTING IN PROPER DIRECTION
	MOVE	*A13(SHOECNT),A1
	JRZ	REGS
	BTST	15,A1
	JRNZ	REGS
;TENNIS
;BOOTS ON
	ADDI	SHOOT_LEG_LIST2,A0
	JRUC	NORG
REGS	ADDI	SHOOT_LEG_LIST,A0
NORG	MOVE	*A0,A9,L		;MOVE TABLE VALUE INTO A9
					;THIS IS NEW FRANIM SCRIPT PNTR
	MOVK	1,A1
	JSRP	FRANIM
	JRUC	MOVE_TOP

CONT_1:
	MOVE	*A7(P_DIR),A0		;GET TORSO INFO
	ORI	08000H,A0
	MOVE	A0,*A7(P_DIR)		;GET TORSO INFO
	ANDI	01FH,A0
	SLL	5,A0
	MOVE	*A13(SHOECNT),A1
	JRZ	REGK
	BTST	15,A1
;TENNIS?
	JRNZ	REGK
;BOOTS ON
	MOVE	@PCNT,A1
	ANDI	03,A1
	JRNZ	REGK0
	MOVE	*A13(SHOEV),A1
	XORI	1,A1
	MOVE	A1,*A13(SHOEV)
REGK0	MOVE	*A13(SHOEV),A1
	JRZ	REGK1
	MOVI	STAND_TBL_L3,A2
	JRUC	REGK2
REGK1	MOVI	STAND_TBL_L2,A2
	JRUC	REGK2
REGK	MOVI	STAND_TBL_L,A2
REGK2	ADD	A0,A2
	MOVE	*A2,A1,L

	ADDI	L_WALK_FLG,A0
	MOVE	*A0,A4,W

	CALLA	ANI
;MAKE SURE A9,A10 ARE SET FOR THIS POSITION FOR WHEN HE DOES BEGIN RUNNING

SL_1	SLEEPK	1
	JRUC	MOVE_TOP

DO_FRANI:
; STICK IS BEING PRESSED
; PLAYERS LEGS
;A5=DIR READ FROM STICK AT THIS POINT
;A7=TORSO PROCESS
	MOVE	*A7(REV_FLAG),A0,W
	JRZ	NORV
; WE MUST REVERSE PLAYERS LEGS BECAUSE OF SHOOTING POSITION
; VEL MUST STAY SAME
	MOVK	1,A0
	MOVE	A0,*A7(HAVE_REV),W	;UPDATE TORSO INFO!
	MOVE	*A7(REV_P_DIR),A4
	MOVE	A5,*A7(P_DIR)
	MOVE	A5,A6
	SLL	5,A6
	CMP	A5,A4
	JRZ	SAME_DIR
; NEW DIRECTION, SET A9
	MOVE	A5,*A7(REV_P_DIR),W	;SAME, BUT SHOULD BE REVERSE
	MOVE	*A13(SHOECNT),A1
	JRZ	REGH
	BTST	15,A1
	JRZ	BOOT
;TENNIS SHOES ON
	MOVI	REV_WALK_LIST3,A2	;FAST SHOES ANIMATION!
	JRUC	REGHA
BOOT	MOVI	REV_WALK_LIST2,A2	;MOVE BASE TABLE ADDRESS INTO A2
	JRUC	REGHA
REGH	MOVI	REV_WALK_LIST,A2	;MOVE BASE TABLE ADDRESS INTO A2
REGHA	ADD	A6,A2			;CALCULATE OFFSET IN TABLE
	MOVE	*A2,A9,L		;MOVE TABLE VALUE INTO A9
	MOVE	A9,A10
	JRUC	SAME_DIR


NORV:	MOVE	*A7(P_DIR),A4		;CURRENT DIR P1 IS FACING
	ANDI	01FH,A4			;JUST IN CASE HE WAS STANDING STILL
	MOVE	A5,*A7(P_DIR)		;HI BIT IS NOT SET BECAUSE HE RUNS!
	MOVE	A5,A6
	SLL	5,A6
	MOVE	*A7(HAVE_REV),A0
	JRNZ	GET_PROPER
	CMP	A5,A4			;CMP WITH NEW DIR READ FROM STICK
	JRZ	SAME_DIR
GET_PROPER:
; NEW DIRECTION, SET A9
	CLR	A0
	MOVE	A0,*A7(HAVE_REV),W
	MOVE	*A13(SHOECNT),A1
	JRZ	REGJ
	BTST	15,A1
	JRZ	BOOT1
	MOVI	WALK_LIST3,A2		;TENNIS SHOE LIST
	JRUC	REGJ2
BOOT1	MOVI	WALK_LIST2,A2		;BOOT LIST
	JRUC	REGJ2
REGJ	MOVI	WALK_LIST,A2		;MOVE BASE TABLE ADDRESS INTO A2
REGJ2	ADD	A6,A2			;CALCULATE OFFSET IN TABLE
	MOVE	*A2,A9,L		;MOVE TABLE VALUE INTO A9
	MOVE	A9,A10
SAME_DIR:
; CHECK BOUNDARIES FIRST
; COMPARE FOR TOP/BOT BOUNDARIES

	CALLA	STUFF_VEL

	CLR	A1			;COMMAND PASSED TO FRANIM
	JSRP	FRANIM
	JRNC	MOVE_TOP
	MOVE	A10,A9			;RESET TO TOP OF RUNNING LIST
	JRUC	MOVE_TOP

I_DIE
;PLAYER DEAD, THIS IS WHAT LEGS DO DURING THIS TIME
;NEED A9=TSO_PRC
;A8=LEGS IMG
	SLEEPK	05
;IF BLOWN UP INTO AIR, DO NOT DO THIS
	MOVE	*A10(DEAD),A1,W
	ANDI	0FFFFH,A1
	CMPI	CLSENMY|TYPLAYR|SUBFLM,A1
	JREQ	SKIPSP
	CMPI	CLSENMY|TYPLAYR,A1
	JREQ	SKIPSP
	CMPI	CLSNEUT|TYPMINE,A1
	JREQ	SKIPSP
	CMPI	CLSENMY|TYPT72|SUBTK,A1
	JREQ	SKIPSP
	CMPI	CLSENMY|TYPT72,A1
	JREQ	SKIPSP

;REALIGN PLAYER HALVES WHEN WE RESET IF A SPIN DEATH
	MOVI	DIESCRM,A0
	CALLA	ONESND
	MOVE	A8,A0
	MOVE	*A13(TSO_PTR),A8,L	;GET LEG PTR OUT OF TORSO STRUCT
	CALLA	GETANIXY
	MOVE	*A8(OFLAGS),A4,W
	ANDI	0F7FFH,A4		;GET RID OF M_NOCOLL FOR LEGS
	CALLA	GANISAG
	MOVE	A0,A8

	MOVK	1,A1
	MOVI	LSPN,A9
	JSRP	FRANIM
SKIPSP					;SKIP SPINNING OF LEGS IF NOT NEEDED
;	MOVI	0A000000H,A0
;	MOVE	A0,*A8(OXVAL),L
	MOVE	A8,A0
	CALLA	OBJOFF

HG	SLEEPK	1
	MOVE	*A10(DEAD),A0
	JRNZ	HG
	MOVE	A8,A0
	CALLA	OBJON
	MOVI	PWK_UP,A10		;INIT FRANIM SCRIPT RESET
	MOVE	A10,A9			;FRANIM NEEDS IT IN A9
	JRUC	MOVE_TOP		;OKAY_NOW
;
; UPDATE PLAYER 1 X Y POSITION BASED ON JOYSTICK INPUT
;
UPDATE_PLYRXY:
;
;READ MOVEMENT JOYSTICK FOR PLAYER
;A7=TSO_PRC PROCESS PNTR
;
	CLR	A0
	MOVE	A0,*A13(TCH_WALL)
	MOVE	*A7(STICK),A2,L		;GET STICK FROM TORSO STRUCT
	MOVE	*A2,A2,W		;GET ACTUAL CTRL INFO
	ANDI	0FH,A2
	JRNZ	YES_A_MV
	CLRC				;CLEAR CARRY SO WE DON'T FRANI
; STICK IS NOT BEING TOUCHED
	RETS

YES_A_MV:
;
; PLAYER WILL MOVE IN DIRECTION SPECIFIED IN A2
;
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A5,L
	CLR	A3			;DIR CNT
	BTST	BMPRYTE,A2
	JRZ	PLYR_LFT
;CHECK FOR RIGHT SIDE OF SCREEN
	MOVE	@WORLDTLX,A0,L
	ADDI	[375,0],A0
	CMP	A0,A4
	JRGT	TSTDN
;SCRN EDGE OK
	ADDK	04,A3			;YES VALID
	JRUC	TSTDN		
PLYR_LFT:
	BTST	BMPLEFT,A2
	JRZ	TSTDN
	MOVE	@WORLDTLX,A0,L
	ADDI	[10,0],A0
	CMP	A0,A4
	JRLE	TSTDN
	ADDK	7,A3
TSTDN:
	BTST	BMPDOWN,A2
	JRZ	PLYR_UP
	MOVE	@WORLDTLY,A0,L
	ADDI	[240,0],A0
	CMP	A0,A5
	JRGE	TEST_OUT
	ADDK	2,A3
	JRUC	TEST_OUT
PLYR_UP:
	BTST	BMPUP,A2
	JRZ	TEST_OUT
	MOVE	@WORLDTLY,A0,L
	ADDI	[15,0],A0
	CMP	A0,A5
	JRLE	TEST_OUT
	INC	A3

TEST_OUT:
	.IF	DEBUG
	CMPI	9,A3
	JRLS	OKAYSTK
	LOCKUP
	MOVK	9,A3
OKAYSTK
	.ENDIF

	MOVE	A5,A6
	MOVE	A3,A5			;KEEP IN A5 FOR LATER CMP WITH P_DIR
	JRNZ	T1
	CLRC
	RETS
T1:
	CALLR	THIS_DIR
	SETC
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	TAGN		
	RETS
TAGN
	MOVE	A5,A0
	SLL	5,A0
	ADDI	ZCK2,A0
	MOVE	*A0,A0,L
	JUMP	A0


THIS_DIR
;CHECK FOR RECTANGLE COLLISIONS
	ADDI	[4,0],A4
	ADDI	[4,0],A6
	SLL	5,A3
	MOVE	*A13(SHOECNT),A0
	JRZ	DREGS			;TENNIS?
	ADDI	CKOFF2,A3
	JRUC	DRTOP
DREGS	ADDI	CKOFF,A3
DRTOP	MOVE	*A3,A0,L
;A0=[Y,X] OFFSET FOR PLAYER TO CHECK AGAINST!
	MOVY	A0,A1
	SLL	16,A0
	ADD	A0,A4			;A4=X TO CHECK
	ADD	A1,A6			;A6=Y TO CHECK

	SRL	16,A4			;X
	SRL	16,A6			;Y
	MOVE	@CURRENT,A0,L		;CURRENT RECT LIST
	JRZ	OUT
NEXT0	MOVE	*A0+,A1,W
	JRZ	OUT
	CMP	A1,A4
	JRLT	NEXT			;IF BRNCH RECT LFT EDGE > PLYR X
	MOVE	*A0+,A1,W
	CMP	A1,A6
	JRLT	NEXTA			;IF BRNCH RECT TOP EDGE > PLYR Y
	MOVE	*A0+,A1,W
	CMP	A1,A4
	JRGT	NEXTB			;IF BRNCH RECT RGT EDGE < PLYR X
	MOVE	*A0+,A1,W
	CMP	A1,A6
	JRGT	NEXT0			;IF BRNCH RECT BOT EDGE < PLYR Y
;HIT
	MOVK	1,A1
	RETS

OUT
;	SETC				;WE WILL FRANI
; STICK HAS BEEN TOUCHED, NO BUMP WITH WALL
	CLR	A1
	RETS

NEXT	ADDI	48,A0	
	JRUC	NEXT0
NEXTA	ADDK	32,A0
	JRUC	NEXT0
NEXTB	ADDK	16,A0
	JRUC	NEXT0

ZCK2	.LONG	OUT,OUT,OUT,OUT,OUT,CKME5,CKME6,OUT,CKME8,CKME9
CKME5
;CHECK RECTANGLES AS IF MY DIR WAS 4
;IF IT IS OKAY TO GO 4, SET MY DIR TO 4 AND GET OUT
;IF NOT OKAY TO GO 4, CHECK RECTANGLES AS IF MY DIR WAS 1
;IF IT IS OKAY TO GO 1, SET MY DIR TO 1 AND GET OUT
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A6,L
	MOVK	4,A3
	CALLR	THIS_DIR
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	CKJ
	MOVK	4,A5	     		;YES, GO DIR 4
	SETC
	RETS
CKJ	MOVK	1,A3
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A6,L
	CALLR	THIS_DIR
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	CKOUT
	MOVK	1,A5
CKOUT	SETC
	RETS

CKME6
;CHECK RECTANGLES AS IF MY DIR WAS 4
;IF IT IS OKAY TO GO 4, SET MY DIR TO 4 AND GET OUT
;IF NOT OKAY TO GO 4, CHECK RECTANGLES AS IF MY DIR WAS 2
;IF IT IS OKAY TO GO 2, SET MY DIR TO 2 AND GET OUT
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A6,L
	MOVK	4,A3
	CALLR	THIS_DIR
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	CKJ6
	MOVK	4,A5	     		;YES, GO DIR 4
	SETC
	RETS
CKJ6	MOVK	2,A3
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A6,L
	CALLR	THIS_DIR
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	CKOUT
	MOVK	2,A5
	SETC
	RETS
CKME8
;CHECK RECTANGLES AS IF MY DIR WAS 7
;IF IT IS OKAY TO GO 7, SET MY DIR TO 7 AND GET OUT
;IF NOT OKAY TO GO 7, CHECK RECTANGLES AS IF MY DIR WAS 1
;IF IT IS OKAY TO GO 1, SET MY DIR TO 1 AND GET OUT
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A6,L
	MOVK	7,A3
	CALLR	THIS_DIR
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	CKJ7
	MOVK	7,A5	     		;YES, GO DIR 7
	SETC
	RETS
CKJ7	MOVK	1,A3
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A6,L
	CALLR	THIS_DIR
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	CKOUT
	MOVK	1,A5
	SETC
	RETS
CKME9
;CHECK RECTANGLES AS IF MY DIR WAS 7
;IF IT IS OKAY TO GO 7, SET MY DIR TO 7 AND GET OUT
;IF NOT OKAY TO GO 7, CHECK RECTANGLES AS IF MY DIR WAS 2
;IF IT IS OKAY TO GO 2, SET MY DIR TO 2 AND GET OUT
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A6,L
	MOVK	7,A3
	CALLR	THIS_DIR
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	CKJ8
	MOVK	7,A5	     		;YES, GO DIR 4
	SETC
	RETS
CKJ8	MOVK	2,A3
	MOVE	*A8(OXVAL),A4,L
	MOVE	*A8(OYVAL),A6,L
	CALLR	THIS_DIR
	MOVE	A1,*A13(TCH_WALL)
	MOVE	A1,A1
	JRNZ	CKOUT
	MOVK	2,A5
	SETC
	RETS

;FIRST RECTANGLE LIST FOR PLAYERS
XX	.EQU	241
YY	.EQU	202
RECT1	.WORD	242-XX,927-YY,338-XX,990-YY	   ;ONE ENTRY = UPLFT,LOWRGT
	.WORD	324-4-XX,922-YY,380-XX,980-YY
	.WORD	500-XX,921-YY,551-XX,980-YY
	.WORD	540-4-XX,927-YY,630-XX,990-YY

RECT2	.WORD	1,0,27H,23CH	;242-XX,202-YY,280-XX,774-YY  ;AFTER FLAG IS DEAD
	.WORD	026H,19DH,3DH,1FAH	;279-XX,618-YY,302-XX,708-YY
	.WORD	26H,0FBH,3DH,15DH	;279-XX,453-YY,302-XX,551-YY
	.WORD	14FH-4,1CAH,18FH,21EH	  ;579-XX,677-YY,640-XX,744-YY
	.WORD	14FH-4,14AH,18FH,19DH	  ;579-XX,542-YY,640-XX,615-YY
	.WORD	245-XX,202-YY,827-XX,263-YY
	.WORD	268-XX,308-YY,368-XX,397-YY	
	.WORD	245-XX,202-YY,07AH,285-YY
	.WORD	0
RECT3	.WORD	268-XX,312-YY,370-XX,397-YY	   ;VERT SCROLL STOPS
	.WORD	245-XX,202-YY,827-XX,263-YY
	.WORD	242-XX,202-YY,277-XX,574-YY
	.WORD	245-XX,202-YY,07AH,277-YY	;285
	.WORD	0

RECT4	.WORD	268-XX,312-YY,370-XX,397-YY	   ;HORZ SCROLL STARTS
	.WORD	245-XX,202-YY,827-XX,263-YY
	.WORD	242-XX,202-YY,277-XX,574-YY
	.WORD	822-XX,206-YY,906-XX,307-YY
	.WORD	955-XX,203-YY,1120-XX,307-YY
	.WORD	1071-XX,278-YY,1125-XX,463-YY
	.WORD	0
RECT5	.WORD	822-4-XX,206-YY,906-XX,306-YY	     ;HORZ SCROLL STOPS
	.WORD	955-4-XX,203-YY,1120-XX,306-YY
	.WORD	1079-4-XX,278-YY,1125-XX,463-YY		;1079=1071
	.WORD	245-XX,203-YY,827-XX,263-YY
	.WORD	0
SRECT1A						;FOR AREA ABOVE EXPRESSWAY
	.WORD	252-XX,203-YY,420-XX,305-YY	;INTO ELEVATOR 45 WIDE
	.WORD	465-XX,203-YY,637-XX,305-YY
	.WORD	0
BSRECT1A					;ABOVE XPRESS
	.WORD	252-XX,202-YY,420-XX,290-YY
	.WORD	465-XX,202-YY,637-XX,290-YY
	.WORD	0

BRECT1	.WORD	243-XX,900-YY,378-XX,970-YY
	.WORD	503-XX,908-YY,635-XX,970-YY

BRECT2	.WORD	242-XX,203-YY,281-XX,772-YY
	.WORD	582-XX,656-YY,641-XX,740-YY
	.WORD	582-XX,527-YY,641-XX,610-YY
	.WORD	243-XX,204-YY,843-XX,250-YY
	.WORD	265-XX,305-YY,361-XX,385-YY
	.WORD	0
BRECT3	.WORD	243-XX,204-YY,843-XX,250-YY	;FROM REACTOR TO ELEVATOR
	.WORD	024DH,05H,02A0H,057H	;830-XX,207-YY,894-XX,294-YY
	.WORD	02C0H,05H,036BH,057H	;965-XX,207-YY,1116-XX,294-YY
	.WORD	1073-XX,244-YY,1118-XX,448-YY
	.WORD	0

CKOFF	.LONG	0,[-4,0],[8,0],0,[0,11],[-4,8],[8,8],[0,-5],[-4,-6],[8,-6]
;CKOFF2	.LONG	0,[-8,0],[16,0],0,[0,22],[-8,16],[16,16],[0,-10],[-8,-12],[16,-12]
CKOFF2	.LONG	0,[-6,0],[11,0],0,[0,14],[-6,10],[10,10],[0,-8],[-6,-9],[11,-9]
;
;		1
;	8		5
;7				4
;	9		6
;		2
;

VELX_LIST:
	.LONG	0,0,0,0,HNORMVEL,HSLOVEL,HSLOVEL,-HNORMVEL,-HSLOVEL
	.LONG	-HSLOVEL
VELY_LIST:
	.LONG	0,-VNORMVEL,VNORMVEL,0,0,-VSLOVEL,VSLOVEL,0
	.LONG	-VSLOVEL,VSLOVEL
VELX_LIST2:
	.LONG	0,0,0,0,HNORMVEL2,HSLOVEL2,HSLOVEL2,-HNORMVEL2,-HSLOVEL2
	.LONG	-HSLOVEL2
VELY_LIST2:
	.LONG	0,-VNORMVEL2,VNORMVEL2,0,0,-VSLOVEL2,VSLOVEL2,0
	.LONG	-VSLOVEL2,VSLOVEL2
VELX_LIST3:
	.LONG	0,0,0,0,HNORMVEL3,HSLOVEL3,HSLOVEL3,-HNORMVEL3,-HSLOVEL3
	.LONG	-HSLOVEL3
VELY_LIST3:
	.LONG	0,-VNORMVEL3,VNORMVEL3,0,0,-VSLOVEL3,VSLOVEL3,0
	.LONG	-VSLOVEL3,VSLOVEL3
;
STUFF_VEL:
	MOVE	*A13(TCH_WALL),A0
	JRZ	SVX
	CLR	A1
	CLR	A0
	JRUC	SV2
SVX
	MOVE	*A13(SHOECNT),A0
	JRZ	SV
	DEC	A0
	MOVE	A0,*A13(SHOECNT)
	MOVE	A0,A2
	ANDI	03FFH,A0
	JRNZ	SVNO
;SHOES DONE!
	MOVE	A0,*A13(SHOECNT)
SVNO
	BTST	15,A2
	JRZ	VBOOT
;TENNIS SHOE SPEED
	MOVI	VELX_LIST3,A2
	ADD	A6,A2
	MOVE	*A2,A0,L

	MOVI	VELY_LIST3,A2
	ADD	A6,A2
	MOVE	*A2,A1,L
	JRUC	SV2

VBOOT	MOVI	VELX_LIST2,A2
	ADD	A6,A2
	MOVE	*A2,A0,L

	MOVI	VELY_LIST2,A2
	ADD	A6,A2
	MOVE	*A2,A1,L
	JRUC	SV2

SV	MOVI	VELX_LIST,A2
	ADD	A6,A2
	MOVE	*A2,A0,L

	MOVI	VELY_LIST,A2
	ADD	A6,A2
	MOVE	*A2,A1,L

SV2	MOVE	A1,*A8(OYVEL),L
	MOVE	A0,*A8(OXVEL),L

; NOW ADD SAME VALUES INTO TORSO RECORD	
	MOVE	*A13(TSO_PTR),A3,L
	MOVE	A1,*A3(OYVEL),L
	MOVE	A0,*A3(OXVEL),L	
	RETS

;
; INITIALIZE PLAYER OBJECT
; GET OBJECT INFO AND DO INSERT INTO OBJECT LIST
;
STRT_PLYR_LEGS:
;CHECK TO SEE IF THIS IS PLAYER 1 OR 2
	CLR	A0
	MOVE	A0,@TMP
	CALLR	GETP
	MOVI	158,A3		
	MOVI	DMAWNZ,A4
	CLR	A6
	CLR	A7
	CALLA	BEGINOBJ2
	RETS
STRT_PLYR_TORSO:
;CHECK TO SEE IF THIS IS PLAYER 1 OR 2
	MOVK	1,A0
	MOVE	A0,@TMP
	CALLR	GETP
	MOVI	159,A3				;HIGHER THAN LEGS
	MOVI	DMAWNZ+M_NOCOLL,A4		;NO COLLISIONS WITH CHEST!
	CLR	A6
	CLR	A7
	CALLA	BEGINOBJ2
	RETS
GETP
;START CORRECT IMAGE/ STUFF PROPER ID
	MOVE	*A13(PNUM),A2
	CMPI	1,A2
	JREQ	PYX

	MOVE	@TMP,A0
	JRZ	PYXXX
	MMTM	SP,A0,A1
	MOVK	32,A9
	MOVI	MEP2,A8
	CREATE	0,ME1
	MMFM	SP,A0,A1
PYXXX
	MOVI	BLACK,A2			;TURN ON PLAYER 2 (BLACK)
	MOVI	CLSPLYR|TYPPLYR|SUBPL_2,A5
SETPXY2
	MOVE	@WORLDTLX,A0,L
	MOVE	@RUNIN,A1
	JRZ	FB0
;FROM SIDE
	SUBI	080000H,A0
	MOVE	@WORLDTLY,A1,L
	ADDI	[130,0],A1
	RETS
FB0
	MOVE	@WORLDTLY,A3,L
	CMPI	[127EH,0],A3
	JRNZ	FB01
;PLACE NEAR P2 PARACHUTE
	ADDI	010B0000H,A0
	MOVE	@WORLDTLY,A1,L
	ADDI	05B0000H,A1

	MMTM	SP,A9,A10,A0,A1
	MOVE	@TMP,A0
	JRZ	FB00
	MOVI	35,A10			;TIME RINGS ARE ON
	MOVK	2,A9
	CREATE	RNG2PID,RINGS
FB00	MMFM	SP,A9,A10,A0,A1
	RETS

FB01	ADDI	0C80000H,A0
	MOVE	@WORLDTLY,A1,L
	ADDI	0FF0000H,A1
	RETS

PYX
	MOVE	@TMP,A0
	JRZ	PYXX
	MMTM	SP,A0,A1
	CLR	A9
	MOVI	MEP1,A8
	CREATE	0,ME1
	MMFM	SP,A0,A1
PYXX
	MOVI	P1WG6T1,A2
	MOVI	CLSPLYR|TYPPLYR|SUBPL_1,A5
SETPXY1
	MOVE	@WORLDTLX,A0,L
	MOVE	@RUNIN,A1
	JRZ	FB1
;FROM SIDE
	SUBI	080000H,A0
	MOVE	@WORLDTLY,A1,L
	ADDI	[115,0],A1
	RETS

FB1	MOVE	@WORLDTLY,A3,L
	CMPI	[127EH,0],A3
	JRNZ	FB11
;PLACE NEAR P1 PARACHUTE
	ADDI	0730000H,A0
	MOVE	@WORLDTLY,A1,L
	ADDI	07F0000H,A1

	MMTM	SP,A9,A10,A0,A1
	MOVE	@TMP,A0
	JRZ	FB000
	MOVI	35,A10			;TIME RINGS ARE ON
	MOVK	1,A9
	CREATE	RNG1PID,RINGS
FB000	MMFM	SP,A9,A10,A0,A1
	RETS
FB11	ADDI	0B30000H,A0
	MOVE	@WORLDTLY,A1,L
	ADDI	0FF0000H,A1
	RETS
ME1
;PLAYER NAME MESSAGE
;A9=PLYR # 1 OR 2
	SLEEPK	5
	MOVI	PLYROBJS,A0,L
	ADD	A9,A0
	MOVE	*A0,A10,L
	MOVE	A8,A2
	MOVI	359,A3				;HIGHER THAN LEGS
	MOVI	DMAWNZ+M_NOCOLL,A4		;NO COLLISIONS WITH CHEST!
	MOVI	CLSPLYR|TYPHLPR,A5
	CLR	A6
	CLR	A7
	CALLA	BEGINOBJ2
	MOVK	15,A9
	CREATE	0,MANY
	MOVI	6*60+10,A11	;8*60
METOP
	MOVE	A8,A0
	MOVE	A10,A8				;*A13(LEG_PTR),A8,L
	CALLA	GETANIXY
	ADDI	00D0000H,A2		;Y
	ADDI	0E0000H,A3		;X
	MOVE	*A0(OFLAGS),A4,W
	CALLA	GANISAG
	MOVE	A0,A8
	SLEEPK	1
	DSJ	A11,METOP
	MOVE	A8,A0
	CALLA	DELOBJ
	DIE
MANY
	SLEEPK	12
	MOVE	A8,A0
	CALLA	OBJON
	SLEEPK	12
	MOVE	A8,A0
	CALLA	OBJOFF
	DSJ	A9,MANY
	DIE

DIE_CODE
;FROM TORSO CODE
;	PUSH	A1
;	CREATE	0,CHEER
;	PULL	A1
	MOVE	*A13(LEG_PTR),A2,L	;GET LEG INFO
;STOP PLAYER FROM FLOATING
	CLR	A0
	MOVE	A0,*A2(OXVEL),L
	MOVE	A0,*A2(OYVEL),L
	MOVE	A0,*A8(OXVEL),L
	MOVE	A0,*A8(OYVEL),L

	ANDI	0FFFFH,A1
	CMPI	CLSENMY|TYPLAYR|SUBFLM,A1
	JREQ	DIEFIRE2
	CMPI	CLSENMY|TYPLAYR,A1
	JREQ	DIEFIRE
	CMPI	CLSNEUT|TYPMINE,A1
	JREQ	DIECHU
	CMPI	CLSENMY|TYPT72|SUBTK,A1
	JREQ	DIECHU2
	CMPI	CLSENMY|TYPT72,A1
	JREQ	DIECHU2
	CMPI	CLSNEUT|TYPMINE|01,A1			;SHOCK OIDS HERE
	JRNZ	SPDTH
;SHOCK HERE
	CREATE	0,SHKSND
	MOVE	*A8(OPLINK),A0,L
	MOVE	*A0(LEG_PTR),A0,L
	MOVI	01A000000H,A1
	MOVE	A1,*A0(OXVAL),L		;MOVE LEGS OUT OF THE WAY!

	CLR	A0
	MOVE	A0,*A8(OXVEL),L
	MOVE	A0,*A8(OYVEL),L


	MOVE	*A8(OYPOS),A0
	SUBK	16H,A0
	MOVE	A0,*A8(OYPOS)
;	MOVE	*A8(OXPOS),A0
;	ADDI	2H,A0
;	MOVE	A0,*A8(OXPOS)
	MOVI	342,A0			;132
	MOVE	A0,*A8(OZPOS)

	MOVI	120,A11
	CREATE	0,SHKPLYR
	MOVK	1,A1
	MOVI	TSHK,A9
	JSRP	FRANIM
	JRUC	ALLDIE

SHKPLYR	SLEEPK	1
	movk	2,a0
	CALLA	RNDRNG0
	subk	1,a0			;-1 to 1
	move	*a8(OXPOS),a1
	add	a0,a1
	move	a1,*a8(OXPOS)
	movk	2,a0
	CALLA	RNDRNG0
	subk	1,a0			;-1 to 1
	move	*a8(OYPOS),a1
	add	a0,a1
	move	a1,*a8(OYPOS)
	DSJ	A11,SHKPLYR
	DIE
SHKSND
	SLEEPK	01
	MOVI	ELECTRO,A0			;SCREAM UP INTO AIR
	CALLA	ONESND
	SLEEPK	1
	MOVI	AIRSCRM,A0			;SCREAM UP INTO AIR
	CALLA	ONESND
	SLEEP	35H
	MOVI	ELECTRO,A0			;SCREAM UP INTO AIR
	CALLA	ONESND
	DIE
DIEFIRE2
;IF FLAMING SPIN DEATH, FALL IN HERE
	MOVI	FIREDI,A0			;FLAME PLAYER SCREAM
	CALLA	ONESND
	MOVI	FIRELST2,A9
	MOVI	157,A0
	JRUC	DFZ2
FIXNUM	SLEEPK	3
	CLR	A0
	MOVE	A0,@LOCK_NUM
	DIE
DIEFIRE
;QUICK FLAME DEATH
	MOVE	@START,A0
	CMPI	11,A0
	JRZ	DJJ
	MOVE	@LOCK_NUM,A0
	CMPI	6,A0
	JRNZ	DF2X
DJJ	CREATE0	FIXNUM
	SLEEP	40
	JRUC	ALLDIE
DF2X
	SLEEPK	05
	MOVI	FIREDI,A0
	CALLA	ONESND
	MOVI	FIRELST,A9
DFZ	MOVI	159,A0
DFZ2	MOVE	A0,*A8(OZPOS)
	MOVK	1,A1
	JSRP	FRANIM
	SLEEPK	1
	JRUC	ALLDIE
SPDTH
;IF SPIN DEATH, FALL IN HERE
	SLEEPK	05
	MOVI	UGH2,A0
	CALLA	ONESND
;BLOOD CHUNKS
;	MOVI	159,A0			;157
;	MOVE	A0,*A8(OZPOS)
	MOVE	*A13(PNUM),A9
	CREATE	FUTUREPID,DTB
	MOVK	1,A9
	CREATE	FUTUREPID,TWOCHNKS
	MOVK	30,A9
	CREATE	FUTUREPID,TWOCHNKS
	MOVK	1,A1
	MOVI	TSPN,A9
	JSRP	FRANIM
	MOVK	1,A1
	MOVI	DIELST,A9
	JSRP	FRANIM
	SLEEPK	1
	JRUC	ALLDIE

DTB 	SLEEPK  15
	MOVI	MEUGH,A0
	CALLA	ONESND
	SLEEP	30+9
	MOVI	ELECTRO,A0		;SHOCK SND AT DEATH
	CALLA	ONESND
	SLEEP	02CH+20-30
	MOVI	158,A0			;BRING TORSO DOWN TO LEG ZPOS
	MOVE	A0,*A8(OZPOS)
	SLEEPK	7
;A9=1/2 FOR PLAYER #
	CREATE	BMBPID,TBOMBD
	DIE

CHNKS
;IF NO BOG, BLOOD FROM CHEST HOLE!
	MOVE	@HULK_CNT,A0
	CMPI	20,A0
	JRHI	CDI
	MOVE	@PCTOT,A2
	CMPI	013H,A2			;19
	JRLO	ADDPCS
CDI	DIE
ADDPCS	MOVK	15,A10
	SLEEPK	10
CH1	CREATE	FUTUREPID,CHESTBLD
	SLEEPK	1
	DSJS	A10,CH1
	SLEEP	3FH
	MOVK	4,A10
CH2	CREATE	FUTUREPID,CHESTBLD2
	SLEEPK	2
	DSJS	A10,CH2
	DIE

CHESTBLD2
;FLOW BLOOD OUT OF CHEST HOLE
	MOVI	-03000H,B0
	MOVI	03000H,B1
	CALLA	RANGRAND
	MOVE	A0,A6
	MOVI	-03000H,B0
	MOVI	03000H,B1
	CALLA	RANGRAND
	MOVE	A0,A7
	CALLA	GETANIXY
	MOVE	A2,A1

	SUBI	020000H,A3
	MOVE	*A8(OFLAGS),A0
	BTST	B_FLIPH,A0
	JRZ	NOHX
	ADDI	040000H,A3
NOHX
	SUBI	01C0000H,A1			;1A
;A0=PROPER X,A1=Y
	MOVI	BLDB,A9
	JRUC	CHB
CHESTBLD
;FLOW BLOOD OUT OF CHEST HOLE
	MOVI	-0A000H,B0
	MOVI	0A000H,B1
	CALLA	RANGRAND
	MOVE	A0,A6
	MOVI	-0A000H,B0
	MOVI	0A000H,B1
	CALLA	RANGRAND
	MOVE	A0,A7
	CALLA	GETANIXY
	MOVE	A2,A1
	SUBI	0B0000H,A3

	MOVE	*A8(OFLAGS),A0
	BTST	B_FLIPH,A0
	JRZ	NOHXX
	ADDI	0110000H,A3
NOHXX
	SUBI	01D0000H,A1
	MOVI	BLDBB,A9
CHB
	MOVE	A3,A0
;A0=PROPER X,A1=Y
	MOVI	BBS1,A2			;(OIMG)
	MOVI	343,A3			;(OZPOS)
	MOVI	DMAWNZ+M_NOCOLL,A4 	;(OFLAGS) NON-ZERO VALUE
	MOVI	CLSDEAD,A5		;(OID)
	CALLA	BEGIN_CHNK
	JAUC	FRANIM_DIE

BLDBB:
	.LONG	bldclt4
	.WORD	6
	.LONG	bldclt5
	.WORD	6
	.LONG	bldclt6
	.WORD	6
	.LONG	bldclt7
	.WORD	6
	.LONG	bldclt8
	.WORD	6
	.LONG	0
BLDB	.LONG	rblot1
	.WORD	4
	.LONG	rblot2
	.WORD	4
	.LONG	rblot3
	.WORD	4
	.LONG	rblot4
	.WORD	4
	.LONG	rblot5
	.WORD	4
	.LONG	rblot6
	.WORD	4
	.LONG	rblot7
	.WORD	4
	.LONG	rblot8
	.WORD	4
	.LONG	0

TWOCHNKS
	MOVE	A9,A0
	CALLA	PRCSLP
;USED FOR PLAYER SPIN DEATH!
;A8=PLAYER PNTR
	MOVI	-02000H,B0
	MOVI	02000H,B1
	CALLA	RANGRAND
	MOVE	A0,A6
	MOVI	-02000H,B0
	MOVI	02000H,B1
	CALLA	RANGRAND
	MOVE	A0,A7
	CALLA	GETANIXY
	MOVE	A2,A1
	ADDI	0180000H,A1		;2A
	SUBI	040000H,A3
	MOVE	A3,A0
;A0=PROPER X,A1=Y
	MOVI	BLDOTS,A9
	MOVI	BBS1,A2			;(OIMG)
	MOVI	161,A3			;(OZPOS);150
	MOVI	DMAWNZ+M_NOCOLL,A4	;(OFLAGS) NON-ZERO VALUE
	MOVI	CLSDEAD,A5		;(OID)
	CALLA	BEGIN_CHNK
	JAUC	FRANIM_DIE

UNDERME
;A8=PLAYER PNTR
	MOVI	-04000H,B0
	MOVI	04000H,B1
	CALLA	RANGRAND
	MOVE	A0,A6
	MOVI	-04000H,B0
	MOVI	04000H,B1
	CALLA	RANGRAND
	MOVE	A0,A7
	CALLA	GETANIXY
	MOVE	A2,A1
	MOVE	A3,A0
;A0=PROPER X,A1=Y
	MOVI	T72BLAST1,A2
	MOVI	TBLST,A9		;(OIMG)
	MOVI	155,A3			;(OZPOS)
	MOVI	DMAWNZ+M_NOCOLL,A4	;(OFLAGS) NON-ZERO VALUE
	MOVI	CLSNEUT|TYPNEUT,A5	;(OID)
	CALLA	BEGIN_CHNK
	JAUC	FRANIM_DIE
DIECHU2:
;BLOOD CHUNKS
	CREATE	FUTUREPID,UNDERME
	CREATE	FUTUREPID,UNDERME
	CREATE	FUTUREPID,UNDERME
	CREATE	FUTUREPID,UNDERME
	CREATE	FUTUREPID,UNDERME
	PUSH	A8
	MOVE	*A13(KILLERO),A8,L	;MOVE	@MUTPTR,A8,L
;	MOVE	*A8(PDATA),A8,L
	CALLA	GETCPNT
;A1=Y/X CENTER POS
	PULL	A8
	CLR	A2
	MOVX	A1,A2
	SRL	16,A1
	MOVE	A1,A3
	MOVE	*A8(OXPOS),A4
	MOVI	9000H,A0
	CMP	A4,A2
	JRLT	GOGOX
;ADD TO PLYR X
	MOVI	-9000H,A0
GOGOX	MOVE	A0,*A8(OXVEL),L
	MOVE	*A8(OYPOS),A4
	MOVI	-7000H,A0
	CMP	A4,A3
	JRGT	GONEGD
;ADD TO PLYR Y
	MOVI	07000H,A0
GONEGD	MOVE	A0,*A8(OYVEL),L

DIECHU:
	MOVI	AIRSCRM,A0			;SCREAM UP INTO AIR
	CALLA	ONESND
	MOVE	*A8(OPLINK),A0,L
	MOVE	*A0(LEG_PTR),A0,L
	MOVI	01A000000H,A1
	MOVE	A1,*A0(OXVAL),L		;MOVE LEGS OUT OF THE WAY!

;BIG IMAGE INTO AIR
	MOVE	*A8(OFLAGS),A0
	BTST	B_FLIPH,A0
	JRZ	NOH
	ANDI	0FFEFH,A0
	JRUC	NOH1
NOH	ORI	M_FLIPH,A0
NOH1	MOVE	A0,*A8(OFLAGS)
	MOVE	*A8(OYPOS),A0
	ADDI	21H,A0
	MOVE	A0,*A8(OYPOS)
	MOVI	342,A0			;132
	MOVE	A0,*A8(OZPOS)
	CREATE	FUTUREPID,CHNKS
	MOVK	1,A1
	MOVI	FLYUP,A9
	JSRP	FRANIM
	CLR	A0
	MOVE	A0,*A8(OXVEL),L
	MOVE	A0,*A8(OYVEL),L
	MOVI	129,A0			;142
	MOVE	A0,*A8(OZPOS)
	MOVK	9H,A10
	CALLA	SHAKER
	MOVI	EXP1,A0
	CALLA	ONESND			;SOUND AT LANDING
	SLEEPK	23
	MOVK	4,A10
;ABOUT 1 SECOND OF BLINK
BK
	MOVE	A8,A0
	CALLA	OBJOFF
	SLEEPK	4
	MOVE	A8,A0
	CALLA	OBJON
	SLEEPK	4
	DSJS	A10,BK
	SLEEPK	18
ALLDIE
	MOVE	*A13(PNUM),A0
	SLL	5,A0
	ADDI	TBLP,A0
	MOVE	*A0,A11,L
SLP	SLEEPK	1
	MOVE	@HALT,A0
	JRNZ	SLP
	MOVE	*A11(CNTD),A0
	JRZ	DOV

	CLR	A1
	MOVE	A1,*A8(OYPOS)
	MOVE	A1,*A8(OXVAL),L

	MOVE	*A8(OPLINK),A0,L
	MOVE	*A0(LEG_PTR),A0,L
	MOVI	01A000000H,A1
	MOVE	A1,*A0(OXVAL),L		;MOVE LEGS OUT OF THE WAY!

;	MOVE	*A13(PNUM),A10	;1 OR 2
;	DEC	A10
;	MMTM	SP,A8,A9,A10,A11
;	CALLA	SWAPSK		;TELL	HULKS TO SEEK ANOTHER PLAYER
;	MMFM	SP,A8,A9,A10,A11

SLPZ
	SLEEPK	1
	MOVE	@HALT,A0
	JRNZ	SLPZ
	MOVE	*A11(CNTD),A0
	JRZ	DOV
	CMPI	1,A0
	JRZ	SLPZ
;PLAYERS TIME HAS EXPIRED.
;KILL PROC,OBJS,START MESSAGES!
	CLR	A0
	MOVE	A0,*A11(CNTD)
	CMPI	P1DATA,A11
	JRNE	KL2
;KILL PLYR1
	CALLA	KILLP1
;IS OTHER GUY STILL AROUND?
	MOVI	PLY2PID,A0
DYE0	CLR	A1
	NOT	A1
	CALLA	EXISTP
	JRNZ	DYE
	MOVI	INGAMEOV,A0
	MOVE	A0,@GAMSTATE,W
	SOUND1	MUSICOFF		;MUSIC HARD OFF
	CLR	A0
	CLR	A1
	NOT	A1
	CALLA	KILALL			;KILL ALL GAME PROCESSES
	CREATE	GMEOVPID,GAMEOVER	;GAME IS NOW OFFICIALLY OVER
DYE	DIE
;KILL PLYR2
KL2	CALLA	KILLP2
;IS OTHER GUY STILL AROUND?
	MOVI	PLY1PID,A0
	JRUC	DYE0

TBLP	.LONG	0,P1DATA,P2DATA
;
DOV
;
;DEAD OVER
;		
	MOVI	P1DATA,A1
	MOVE	*A13(PNUM),A0
	CMPI	1,A0
	JREQ	ET1
	MOVI	P2DATA,A1
ET1
	MOVE	*A1(PLIVES),A2
	DEC	A2
	MOVE	A2,*A1(PLIVES),W
	MOVE	A1,A11
	CALLA	STUFF_LVADDR

	MOVI	159,A0			;TORSO REGULAR Z
	MOVE	A0,*A8(OZPOS)

	MMTM	SP,A8,A9
	MOVE	*A13(PNUM),A8		;FOR SCRIPTPLAY
	MOVE	@RUNIN,A10,W		;INDICATES FROM BOTTOM OR LEFT
	CREATE	SCRPID,SCRIPTPLAY

	PUSH	A8
	MOVE	A8,A0
	CLR	A9
	MOVI	MEP1,A8
	CMPI	1,A0
	JRZ	IMP1
;PLYR 2
	MOVK	32,A9
	MOVI	MEP2,A8
IMP1	CREATE	0,ME1
	MOVE	*A13(PNUM),A8		;FOR SCRIPTPLAY
	PULL	A8


	MOVE	*A13(LEG_PRC),A1,L
	CLR	A0
	MOVE	A0,*A1(SHOECNT) 	;CLEAR FAST SHOE CNT
	MOVK	6,A0				;START HIM OUT STRONG
	MOVE	A0,*A13(WPN_TYP),W		;AFTER A DEATH
	MOVI	80,A0
	MOVE	A0,*A13(SHOTCNT)

	CMPI	1,A10
	JRNZ	FB
;RUNIN FROM SIDE
	MOVE	@WORLDTLX,A3,L		;Y LINE TO REAPPEAR AT
	SUBI	[08H,0],A3
	CMPI	1,A8
	JRNE	VX1R
;THIS IS FOR BRINGING THE PLAYER ON FROM OFF LEFT OF SCREEN
	MOVE	@WORLDTLY,A2,L
	ADDI	[0115,0],A2
	MOVE	@PLYRPRCS,A0,L
	JRUC	AXZ
VX1R
	MOVE	@WORLDTLY,A2,L
	ADDI	[0130,0],A2
	MOVE	@PLYRPRCS+32,A0,L
	JRUC	AXZ

FB	MOVE	@WORLDTLY,A2,L		;Y LINE TO REAPPEAR AT
	ADDI	[0108H,0],A2		;FF
	CMPI	1,A8
	JRNE	VX1
;THIS IS FOR BRINGING THE PLAYER ON FROM OFF BOTTOM OF SCREEN
	MOVE	@WORLDTLX,A3,L
	ADDI	[0B3H,0],A3
	MOVE	@PLYRPRCS,A0,L
	JRUC	AXZ
VX1
	MOVE	@WORLDTLX,A3,L
	ADDI	[0C8H,0],A3
	MOVE	@PLYRPRCS+32,A0,L
AXZ
	MOVE	*A0(LEG_PTR),A0,L
	MOVE	A3,*A0(OXVAL),L
	MOVE	A2,*A0(OYVAL),L

	MMFM	SP,A8,A9
;REALIGN PLAYER HALVES WHEN WE RESET
	MOVE	A8,A0
	MOVE	*A13(LEG_PTR),A8,L	;GET LEG PTR OUT OF TORSO STRUCT
	CALLA	GETANIXY
	MOVE	*A8(OFLAGS),A4,W
	ORI	M_NOCOLL,A4		;NO COLLIDE FOR TORSO
	CALLA	GANISAG
	MOVE	A0,A8
;TURN BACK ON TORSO OBJECT
	CALLA	OBJON

;GIVE TORSO BACK HIS CORRECT PAL
	MOVI	nup1,A0
	MOVE	*A8(OPLINK),A1,L
	MOVE	*A1(PNUM),A1
	CMPI	1,A1
	JREQ	OKP
;CHANGE TO PLAYER 2 PAL IF NEEDED!
	MOVI	nup2,A0
OKP
	CALLA	GETFPAL			;GET A COLOR MAP ASSIGNMENT
	MOVE	A0,*A8(OPAL),W		;STORE THE NEW PALETTE

;SAFE FOR AWHILE
	MOVI	120,A0			;80
	MOVE	A0,*A13(DELYDET),W
	CLR	A0
	MOVE	A0,*A13(DEAD),W
	JRUC	NDD			;MAINLINE CODE REENTRY

KILLP1
;KILL OFF PLAYER 1 STUFF
	CLR	A1
	NOT	A1
	MOVI	PLY1PID,A0
	CALLA	KILALL
	MOVI	CLSPLYR|TYPPLYR|SUBPL_1,A0
	CALLA	KILOBJ			;KILL PLAYER 1 IMAGES
	CLR	A0
	MOVE	A0,@PLYROBJS,L
	MOVE	A0,@PLYRPRCS,L
	RETS
KILLP2
;KILL OFF PLAYER 2 STUFF
	CLR	A1
	NOT	A1
	MOVI	PLY2PID,A0
	CALLA	KILALL
	MOVI	CLSPLYR|TYPPLYR|SUBPL_2,A0
	CALLA	KILOBJ
	CLR	A0
	MOVE	A0,@PLYROBJS+32,L
	MOVE	A0,@PLYRPRCS+32,L
	RETS

;CHEER	SLEEPK	25
;	MOVI	CROWD2,A0
;	CALLA	ONESND
;	DIE

BLDOTS	.LONG	BBS1
	.WORD	NEWPALET|20
	.LONG	RDBOOM			;ONUP1
	.LONG	BBS2
	.WORD	5
	.LONG	BBS3
	.WORD	5
	.LONG	BBS4
	.WORD	5
	.LONG	BBS5
	.WORD	5
	.LONG	0

TSPN:
	.LONG	P1WG8T1
	.WORD	FLIPBITS|3,0
	.LONG	P1WG9T1
	.WORD	3
	.LONG	P1WG10T1
	.WORD	3
	.LONG	P1WG12T1
	.WORD	3
	.LONG	P1WG10T1
	.WORD	FLIPBITS|3,(M_FLIPH)
	.LONG	P1WG9T1
	.WORD	3
	.LONG	P1WG8T1
	.WORD	3
	.LONG	P1WG6T1
	.WORD	FLIPBITS|3,0
	.LONG	0
FLYUP:
	.LONG	FLY1
	.WORD	4	;3
	.LONG	FLY2
	.WORD	4	;3
	.LONG	FLY3
	.WORD	4	;3
	.LONG	FLY4
	.WORD	4	;3
	.LONG	FLY5
	.WORD	6	;5
	.LONG	FLY6
	.WORD	8	;7
	.LONG	FLY7
	.WORD	8	;7
	.LONG	FLY8
	.WORD	12	;10
	.LONG	FLY7
	.WORD	8	;7
	.LONG	FLY6
	.WORD	8	;7
	.LONG	FLY5
	.WORD	6	;5
	.LONG	FLY4
	.WORD	4	;3
	.LONG	FLY3
	.WORD	4	;3
	.LONG	FLY2
	.WORD	4	;3
	.LONG	FLY1
	.WORD	4;	3
	.LONG	LAND
	.WORD	1
	.LONG	0
FIRELST:
	.LONG	PLYD1
	.WORD	FLIPBITS|4,0
	.LONG	PLYD2
	.WORD	4
	.LONG	PLYD3
	.WORD	4
	.LONG	PLYD4
	.WORD	4
	.LONG	PLYD5
	.WORD	4
	.LONG	PLYD6
	.WORD	4
	.LONG	PLYD7
	.WORD	4
	.LONG	PLYD8
	.WORD	4			;9
	.LONG	PFLM1
	.WORD	4
	.LONG	PFLM2
	.WORD	4
	.LONG	PFLM3
	.WORD	4
	.LONG	PFLM4
	.WORD	4
FIRELST2:
;SWITCH TO XPLOSION PAL (RDBOOM)
	.LONG	PLFR1
	.WORD	NEWPALET|6
	.LONG	RDBOOM
	.LONG	PLFR2
	.WORD	6
	.LONG	PLFR3
	.WORD	6
	.LONG	PLFR4
	.WORD	6
	.LONG	PLFR5
	.WORD	6
	.LONG	PLFR6
	.WORD	6
	.LONG	PLFR7
	.WORD	6
	.LONG	PLFR8
	.WORD	6
	.LONG	PLFR9
	.WORD	6
	.LONG	PLFR10
	.WORD	6
	.LONG	PLFR11
	.WORD	6
	.LONG	PLFR12
	.WORD	6
	.LONG	PLFR13
	.WORD	6
	.LONG	PLFR14
	.WORD	6
	.LONG	PLFR15
	.WORD	6
	.LONG	PLFR16
	.WORD	6
	.LONG	PLFR17
	.WORD	6
	.LONG	PLFR18
	.WORD	6
	.LONG	PLFR19
	.WORD	6
	.LONG	PLFR20
	.WORD	6
	.LONG	PLFR21
	.WORD	6
	.LONG	PLFR22
	.WORD	6
	.LONG	PLFR23
	.WORD	6
	.LONG	PLFR24
	.WORD	6
	.LONG	PLFR25
	.WORD	6
	.LONG	0

DIELST:
	.LONG	PLYD1
	.WORD	FLIPBITS|4,0
	.LONG	PLYD2
	.WORD	4
	.LONG	PLYD3
	.WORD	4
	.LONG	PLYD4
	.WORD	4
	.LONG	PLYD5
	.WORD	4
	.LONG	PLYD6
	.WORD	4
	.LONG	PLYD7
	.WORD	4
	.LONG	PLYD8
	.WORD	9
	.LONG	STRIKE1
	.WORD	3
	.LONG	STRIKE2
	.WORD	3
	.LONG	STRIKE3
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE4
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE5
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE6
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE9
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE10
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE11
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE12
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE13
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE14
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE15
	.WORD	3
	.LONG	STRIKE17
	.WORD	3
	.LONG	STRIKE16
	.WORD	3
	.LONG	0	
LSPN:
	.LONG	P1SH8L1
	.WORD	FLIPBITS|3,0
	.LONG	P1SH9L1
	.WORD	3
	.LONG	P1S10L1
	.WORD	3
	.LONG	P1S12L1
	.WORD	3
	.LONG	P1S10L1
	.WORD	FLIPBITS|3,(M_FLIPH)
	.LONG	P1SH9L1
	.WORD	3
	.LONG	P1SH8L1
	.WORD	3
	.LONG	P1SH6L1
	.WORD	FLIPBITS|3,0
	.LONG	0
;
WALK_LIST:
	.LONG	PWK_UP,PWK_UP,PWK_DN,PWK_UP,PWK_RGT,PWK_UPRGT,PWK_DNRGT,PWK_LFT
	.LONG	PWK_UPLFT,PWK_DNLFT
WALK_LIST3:
	.LONG	FPWK_UP,FPWK_UP,FPWK_DN,FPWK_UP,FPWK_RGT,FPWK_UPRGT,FPWK_DNRGT,FPWK_LFT
	.LONG	FPWK_UPLFT,FPWK_DNLFT
REV_WALK_LIST:
	.LONG	PWK_UP,PWK_DN,PWK_UP,PWK_UP,PWK_LFT,PWK_DNLFT,PWK_UPLFT,PWK_RGT
	.LONG	PWK_DNRGT,PWK_UPRGT
REV_WALK_LIST3:
	.LONG	FPWK_UP,FPWK_DN,FPWK_UP,FPWK_UP,FPWK_LFT,FPWK_DNLFT,FPWK_UPLFT,FPWK_RGT
	.LONG	FPWK_DNRGT,FPWK_UPRGT
WALK_LIST2:
	.LONG	TWK_UP,TWK_UP,TWK_DN,TWK_UP,TWK_RGT,TWK_UPRGT,TWK_DNRGT,TWK_LFT
	.LONG	TWK_UPLFT,TWK_DNLFT
REV_WALK_LIST2:
	.LONG	TWK_UP,TWK_DN,TWK_UP,TWK_UP,TWK_LFT,TWK_DNLFT,TWK_UPLFT,TWK_RGT
	.LONG	TWK_DNRGT,TWK_UPRGT
;		1
;	8		5
;7				4
;	9		6
;		2
;SUBLZR		.EQU	0001H		;REGULAR LAZER SHOTS
;SUBSPRY	.EQU	0002H		;SPRAY SUB TYPE
;SUBFIRE1	.EQU	0003H		;FIRE BALL WPN
;SUBGRND	.EQU	0004H		;GRENADE
;SUBNOSTP	.EQU	0005H		;NON STOPPING BULLET
;SUBSPDG1	.EQU	0006H		;MACHINE GUN TYP WPN
LISTWHAT:
	.LONG	WHATLST1,WHATLST1,WHATLST2,WHATLST3,WHATLST4,WHATLST5
	.LONG	WHATLST6

WHATLST1:	;NORMAL
	.LONG	S1_LIST,S1_LIST,S1_LIST,S1_LIST,S1_LIST
	.LONG	S1_LIST,S1_LIST,S1_LIST,S1_LIST,S1_LIST
WHATLST2:	;SPRAY WEAPON
	.LONG	S2_LIST,S2_LIST,S2_LIST,S2_LIST,S2_LIST
	.LONG	S2_LIST,S2_LIST,S2_LIST,S2_LIST,S2_LIST
WHATLST3:	;FIRE BALL
	.LONG	S3_LIST,S3_LIST,S3_LIST,S3_LIST,S3_LIST
	.LONG	S3_LIST,S3_LIST,S3_LIST,S3_LIST,S3_LIST
WHATLST4:	;GRENADES
	.LONG	S4_LIST,S4_LIST,S4_LIST,S4_LIST,S4_LIST
	.LONG	S4_LIST,S4_LIST,S4_LIST,S4_LIST,S4_LIST
WHATLST5:	;NON STOPPING BULLET
	.LONG	S5_LIST,S5_LIST,S5_LIST,S5_LIST,S5_LIST
	.LONG	S5_LIST,S5_LIST,S5_LIST,S5_LIST,S5_LIST
WHATLST6:	;MACHINE GUN
	.LONG	S6_LIST,S6_LIST,S6_LIST,S6_LIST,S6_LIST
	.LONG	S6_LIST,S6_LIST,S6_LIST,S6_LIST,S6_LIST

S1_LIST:	;NORMAL
	.LONG	SHT_UP,SHT_UP,SHT_DN,SHT_UP,SHT_RGT,SHT_UPRGT,SHT_DNRGT,SHT_LFT
	.LONG	SHT_UPLFT,SHT_DNLFT
S2_LIST:	;SPRAY
	.LONG	SHT2_UP,SHT2_UP,SHT2_DN,SHT2_UP,SHT2_RGT,SHT2_UPRGT,SHT2_DNRGT,SHT2_LFT
	.LONG	SHT2_UPLFT,SHT2_DNLFT
S3_LIST:	;FLAME THROWER
	.LONG	SHT3_UP,SHT3_UP,SHT3_DN,SHT3_UP,SHT3_RGT,SHT3_UPRGT,SHT3_DNRGT,SHT3_LFT
	.LONG	SHT3_UPLFT,SHT3_DNLFT
S4_LIST:	;GRENADE
	.LONG	SHT4_UP,SHT4_UP,SHT4_DN,SHT4_UP,SHT4_RGT,SHT4_UPRGT,SHT4_DNRGT,SHT4_LFT
	.LONG	SHT4_UPLFT,SHT4_DNLFT
S5_LIST:	;NON STOPPING BULLET
	.LONG	SHT5_UP,SHT5_UP,SHT5_DN,SHT5_UP,SHT5_RGT,SHT5_UPRGT,SHT5_DNRGT,SHT5_LFT
	.LONG	SHT5_UPLFT,SHT5_DNLFT
S6_LIST:	;MACHINE GUN
	.LONG	SHT6_UP,SHT6_UP,SHT6_DN,SHT6_UP,SHT6_RGT,SHT6_UPRGT,SHT6_DNRGT,SHT6_LFT
	.LONG	SHT6_UPLFT,SHT6_DNLFT


SHOOT_LEG_LIST:
	.LONG	L_SHT_UP,L_SHT_UP,L_SHT_DN,L_SHT_UP,L_SHT_RGT,L_SHT_UPRGT,L_SHT_DNRGT,L_SHT_LFT
	.LONG	L_SHT_UPLFT,L_SHT_DNLFT
SHOOT_LEG_LIST2:
	.LONG	L2_SHT_UP,L2_SHT_UP,L2_SHT_DN,L2_SHT_UP,L2_SHT_RGT,L2_SHT_UPRGT,L2_SHT_DNRGT
	.LONG	L2_SHT_LFT,L2_SHT_UPLFT,L2_SHT_DNLFT

;		1
;	8		5
;7				4
;	9		6
;		2
;
;WALK DIR IS ACROSS
;FIRE DIR IS DOWN
;		9876543210
REVERSE	.WORD	0000000000B
	.WORD	1001000100B
	.WORD	0100100010B
	.WORD	0000000000B
	.WORD	1110000000B
	.WORD	1010000100B
	.WORD	0110000010B
	.WORD	0001110000B
	.WORD	0001010100B
	.WORD	0000110010B

STAND_TBL_L:
	.LONG	P1S12L1,P1S12L1,P1SH6L1,P1S12L1,P1SH9L1,P1S10L1,P1SH8L1
	.LONG	P1SH9L1,P1S10L1,P1SH8L1
STAND_TBL_L2:
	.LONG	P1TH12L1,P1TH12L1,P1TH6L1,P1TH12L1,P1TH9L1,P1TH10L1,P1TH8L1
	.LONG	P1TH9L1,P1TH10L1,P1TH8L1
STAND_TBL_L3:
	.LONG	P1TH12L2,P1TH12L2,P1TH6L2,P1TH12L2,P1TH9L2,P1TH10L2,P1TH8L2
	.LONG	P1TH9L2,P1TH10L2,P1TH8L2


;NORMAL BULLET WEAPON
SHT_UP:
	.LONG	P1S12T1
	.WORD	FLIPBITS|2,0
	.LONG	P1S12T2
	.WORD	2
	.LONG	P1S12T1
	.WORD	2
	.LONG	P1S12T2
	.WORD	2
	.LONG	0
SHT_UPRGT:
	.LONG	P1S10T1
	.WORD	FLIPBITS|2,(M_FLIPH)
	.LONG	P1S10T2
	.WORD	2
	.LONG	P1S10T1
	.WORD	2
	.LONG	P1S10T2
	.WORD	2
	.LONG	0
SHT_UPLFT:
	.LONG	P1S10T1
	.WORD	FLIPBITS|2,0
	.LONG	P1S10T2
	.WORD	2
	.LONG	P1S10T1
	.WORD	2
	.LONG	P1S10T2
	.WORD	2
	.LONG	0
SHT_RGT:
	.LONG	P1SH9T1
	.WORD	FLIPBITS|2,(M_FLIPH)
	.LONG	P1SH9T2
	.WORD	2
	.LONG	P1SH9T1
	.WORD	2
	.LONG	P1SH9T2
	.WORD	2
	.LONG	0
SHT_LFT:
	.LONG	P1SH9T1
	.WORD	FLIPBITS|2,0
	.LONG	P1SH9T2
	.WORD	2
	.LONG	P1SH9T1
	.WORD	2
	.LONG	P1SH9T2
	.WORD	2
	.LONG	0
SHT_DN:
	.LONG	P1SH6T1
	.WORD	FLIPBITS|2,0
	.LONG	P1SH6T2
	.WORD	2
	.LONG	P1SH6T1
	.WORD	2
	.LONG	P1SH6T2
	.WORD	2
	.LONG	0
SHT_DNLFT:
	.LONG	P1SH8T1
	.WORD	FLIPBITS|2,0
	.LONG	P1SH8T2
	.WORD	2
	.LONG	P1SH8T1
	.WORD	2
	.LONG	P1SH8T2
	.WORD	2
	.LONG	0
SHT_DNRGT:
	.LONG	P1SH8T1
	.WORD	FLIPBITS|2,(M_FLIPH)
	.LONG	P1SH8T2
	.WORD	2
	.LONG	P1SH8T1
	.WORD	2
	.LONG	P1SH8T2
	.WORD	2
	.LONG	0


;FOR SPRAY WEAPON
SHT2_UP:
	.LONG	P1SPRDR12
	.WORD	FLIPBITS|4,0
	.LONG	P1SPRD12A
	.WORD	4
	.LONG	0
SHT2_UPRGT:
	.LONG	P1SPRDR10
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1SPRDR10A
	.WORD	4
	.LONG	0
SHT2_UPLFT:
	.LONG	P1SPRDR10
	.WORD	FLIPBITS|4,0
	.LONG	P1SPRDR10A
	.WORD	4
	.LONG	0
SHT2_RGT:
	.LONG	P1SPRDR9
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1SPRDR9A
	.WORD	4
	.LONG	0
SHT2_LFT:
	.LONG	P1SPRDR9
	.WORD	FLIPBITS|4,0
	.LONG	P1SPRDR9A
	.WORD	4
	.LONG	0
SHT2_DN:
	.LONG	P1SPRDR6
	.WORD	FLIPBITS|4,0
	.LONG	P1SPRD6A
	.WORD	4
	.LONG	0
SHT2_DNLFT:
	.LONG	P1SPRDR8
	.WORD	FLIPBITS|4,0
	.LONG	P1SPRD8A
	.WORD	4
	.LONG	0
SHT2_DNRGT:
	.LONG	P1SPRDR8
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1SPRD8A
	.WORD	4
	.LONG	0


;FOR FLAME THROWER
SHT3_UP:
	.LONG	P1FLAMR12
	.WORD	FLIPBITS|4,0
	.LONG	0
SHT3_UPRGT:
	.LONG	P1FLAMR10
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	0
SHT3_UPLFT:
	.LONG	P1FLAMR10
	.WORD	FLIPBITS|4,0
	.LONG	0
SHT3_RGT:
	.LONG	P1FLAMR9
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	0
SHT3_LFT:
	.LONG	P1FLAMR9
	.WORD	FLIPBITS|4,0
	.LONG	0
SHT3_DN:
	.LONG	P1FLAMR6
	.WORD	FLIPBITS|4,0
	.LONG	0
SHT3_DNLFT:
	.LONG	P1FLAMR8
	.WORD	FLIPBITS|4,0
	.LONG	0
SHT3_DNRGT:
	.LONG	P1FLAMR8
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	0



;SHOOTING GRENADE LAUNCHER WEAPON
SHT4_UP:
	.LONG	P1GR12T1
	.WORD	FLIPBITS|3,0
	.LONG	0
SHT4_UPRGT:
	.LONG	P1GR10T1
	.WORD	FLIPBITS|3,(M_FLIPH)
	.LONG	0
SHT4_UPLFT:
	.LONG	P1GR10T1
	.WORD	FLIPBITS|3,0
	.LONG	0
SHT4_RGT:
	.LONG	P1GR9T1
	.WORD	FLIPBITS|3,(M_FLIPH)
	.LONG	0
SHT4_LFT:
	.LONG	P1GR9T1
	.WORD	FLIPBITS|3,0
	.LONG	0
SHT4_DN:
	.LONG	P1GR6T1
	.WORD	FLIPBITS|3,0
	.LONG	0
SHT4_DNLFT:
	.LONG	P1GR8T1
	.WORD	FLIPBITS|3,0
	.LONG	0
SHT4_DNRGT:
	.LONG	P1GR8T1
	.WORD	FLIPBITS|3,(M_FLIPH)
	.LONG	0

;FOR NON STOP WEAPON
SHT5_UP:
	.LONG	P1LARS12
	.WORD	FLIPBITS|4,0
	.LONG	P1LARS12A
	.WORD	4
	.LONG	0
SHT5_UPRGT:
	.LONG	P1LARS10
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1LARS10A
	.WORD	4
	.LONG	0
SHT5_UPLFT:
	.LONG	P1LARS10
	.WORD	FLIPBITS|4,0
	.LONG	P1LARS10A
	.WORD	4
	.LONG	0
SHT5_RGT:
	.LONG	P1LARS9
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1LARS9A
	.WORD	4
	.LONG	0
SHT5_LFT:
	.LONG	P1LARS9
	.WORD	FLIPBITS|4,0
	.LONG	P1LARS9A
	.WORD	4
	.LONG	0
SHT5_DN:
	.LONG	P1LARS6
	.WORD	FLIPBITS|4,0
	.LONG	P1LARS6A
	.WORD	4
	.LONG	0
SHT5_DNLFT:
	.LONG	P1LARS8
	.WORD	FLIPBITS|4,0
	.LONG	P1LARS8A
	.WORD	4
	.LONG	0
SHT5_DNRGT:
	.LONG	P1LARS8
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1LARS8A
	.WORD	4
	.LONG	0

;FOR MACHINE GUN
SHT6_UP:
	.LONG	P1MGUN12
	.WORD	FLIPBITS|2,0
	.LONG	P1MGUN12A
	.WORD	2
	.LONG	0
SHT6_UPRGT:
	.LONG	P1MGUN10
	.WORD	FLIPBITS|2,(M_FLIPH)
	.LONG	P1MGUN10A
	.WORD	2
	.LONG	0
SHT6_UPLFT:
	.LONG	P1MGUN10
	.WORD	FLIPBITS|2,0
	.LONG	P1MGUN10A
	.WORD	2
	.LONG	0
SHT6_RGT:
	.LONG	P1MGUN9
	.WORD	FLIPBITS|2,(M_FLIPH)
	.LONG	P1MGUN9A
	.WORD	2
	.LONG	0
SHT6_LFT:
	.LONG	P1MGUN9
	.WORD	FLIPBITS|2,0
	.LONG	P1MGUN9A
	.WORD	2
	.LONG	0
SHT6_DN:
	.LONG	P1MGUN6
	.WORD	FLIPBITS|2,0
	.LONG	P1MGUN6A
	.WORD	2
	.LONG	0
SHT6_DNLFT:
	.LONG	P1MGUN8
	.WORD	FLIPBITS|2,0
	.LONG	P1MGUN8A
	.WORD	2
	.LONG	0
SHT6_DNRGT:
	.LONG	P1MGUN8
	.WORD	FLIPBITS|2,(M_FLIPH)
	.LONG	P1MGUN8A
	.WORD	2
	.LONG	0


L_SHT_UP:
	.LONG	P1S12L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L_SHT_UPRGT:
	.LONG	P1S10L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	0
L_SHT_UPLFT:
	.LONG	P1S10L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L_SHT_RGT:
	.LONG	P1SH9L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	0
L_SHT_LFT:
	.LONG	P1SH9L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L_SHT_DN:
	.LONG	P1SH6L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L_SHT_DNLFT:
	.LONG	P1SH8L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L_SHT_DNRGT:
	.LONG	P1SH8L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	0



L2_SHT_UP:
	.LONG	P1TH12L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L2_SHT_UPRGT:
	.LONG	P1TH10L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	0
L2_SHT_UPLFT:
	.LONG	P1TH10L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L2_SHT_RGT:
	.LONG	P1TH9L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	0
L2_SHT_LFT:
	.LONG	P1TH9L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L2_SHT_DN:
	.LONG	P1TH6L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L2_SHT_DNLFT:
	.LONG	P1TH8L1
	.WORD	FLIPBITS|1,0
	.LONG	0
L2_SHT_DNRGT:
	.LONG	P1TH8L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	0

PWK_UP:
	.LONG	P1R12L1
	.WORD	FLIPBITS|3,0
	.LONG	P1R12L2
	.WORD	3
	.LONG	P1R12L3
	.WORD	3
	.LONG	P1R12L4
	.WORD	3
	.LONG	P1R12L5
	.WORD	3
	.LONG	P1R12L6
	.WORD	3
	.LONG	P1R12L7
	.WORD	3
	.LONG	P1R12L8
	.WORD	3
	.LONG	0
PWK_DN:			
	.LONG	P1RN6L1
	.WORD	FLIPBITS|3,0
	.LONG	P1RN6L2
	.WORD	3
	.LONG	P1RN6L3
	.WORD	3
	.LONG	P1RN6L4
	.WORD	3
	.LONG	P1RN6L5
	.WORD	3
	.LONG	P1RN6L6
	.WORD	3
	.LONG	P1RN6L7
	.WORD	3
	.LONG	P1RN6L8
	.WORD	3
	.LONG	0
PWK_RGT:	
	.LONG	P1RN9L1
	.WORD	FLIPBITS|3,(M_FLIPH)
	.LONG	P1RN9L2
	.WORD	3
	.LONG	P1RN9L3
	.WORD	3
	.LONG	P1RN9L4
	.WORD	3
	.LONG	P1RN9L5
	.WORD	3
	.LONG	P1RN9L6
	.WORD	3
	.LONG	P1RN9L7
	.WORD	3
	.LONG	P1RN9L8
	.WORD	3
	.LONG	0
PWK_UPRGT:	
	.LONG	P1R10L1
	.WORD	FLIPBITS|3,(M_FLIPH)
	.LONG	P1R10L2
	.WORD	3
	.LONG	P1R10L3
	.WORD	3
	.LONG	P1R10L4
	.WORD	3
	.LONG	P1R10L5
	.WORD	3
	.LONG	P1R10L6
	.WORD	3
	.LONG	P1R10L7
	.WORD	3
	.LONG	0
PWK_DNLFT:	
	.LONG	P1RN8L1
	.WORD	FLIPBITS|3,0
	.LONG	P1RN8L2
	.WORD	3
	.LONG	P1RN8L3
	.WORD	3
	.LONG	P1RN8L4
	.WORD	3
	.LONG	P1RN8L5
	.WORD	3
	.LONG	P1RN8L6
	.WORD	3
	.LONG	P1RN8L7
	.WORD	3
	.LONG	P1RN8L8
	.WORD	3
	.LONG	0
PWK_LFT:	
	.LONG	P1RN9L1
	.WORD	FLIPBITS|3,0
	.LONG	P1RN9L2
	.WORD	3
	.LONG	P1RN9L3
	.WORD	3
	.LONG	P1RN9L4
	.WORD	3
	.LONG	P1RN9L5
	.WORD	3
	.LONG	P1RN9L6
	.WORD	3
	.LONG	P1RN9L7
	.WORD	3
	.LONG	P1RN9L8
	.WORD	3
	.LONG	0
PWK_UPLFT:	
	.LONG	P1R10L1
	.WORD	FLIPBITS|3,0
	.LONG	P1R10L2
	.WORD	3
	.LONG	P1R10L3
	.WORD	3
	.LONG	P1R10L4
	.WORD	3
	.LONG	P1R10L5
	.WORD	3
	.LONG	P1R10L6
	.WORD	3
	.LONG	P1R10L7
	.WORD	3
	.LONG	0
PWK_DNRGT:	
	.LONG	P1RN8L1
	.WORD	FLIPBITS|3,(M_FLIPH)
	.LONG	P1RN8L2
	.WORD	3
	.LONG	P1RN8L3
	.WORD	3
	.LONG	P1RN8L4
	.WORD	3
	.LONG	P1RN8L5
	.WORD	3
	.LONG	P1RN8L6
	.WORD	3
	.LONG	P1RN8L7
	.WORD	3
	.LONG	P1RN8L8
	.WORD	3
	.LONG	0


FPWK_UP:
	.LONG	P1R12L1
	.WORD	FLIPBITS|1,0
	.LONG	P1R12L2
	.WORD	1
	.LONG	P1R12L3
	.WORD	1
	.LONG	P1R12L4
	.WORD	1
	.LONG	P1R12L5
	.WORD	1
	.LONG	P1R12L6
	.WORD	1
	.LONG	P1R12L7
	.WORD	1
	.LONG	P1R12L8
	.WORD	1
	.LONG	0
FPWK_DN:			
	.LONG	P1RN6L1
	.WORD	FLIPBITS|1,0
	.LONG	P1RN6L2
	.WORD	1
	.LONG	P1RN6L3
	.WORD	1
	.LONG	P1RN6L4
	.WORD	1
	.LONG	P1RN6L5
	.WORD	1
	.LONG	P1RN6L6
	.WORD	1
	.LONG	P1RN6L7
	.WORD	1
	.LONG	P1RN6L8
	.WORD	1
	.LONG	0
FPWK_RGT:	
	.LONG	P1RN9L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	P1RN9L2
	.WORD	1
	.LONG	P1RN9L3
	.WORD	1
	.LONG	P1RN9L4
	.WORD	1
	.LONG	P1RN9L5
	.WORD	1
	.LONG	P1RN9L6
	.WORD	1
	.LONG	P1RN9L7
	.WORD	1
	.LONG	P1RN9L8
	.WORD	1
	.LONG	0
FPWK_UPRGT:	
	.LONG	P1R10L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	P1R10L2
	.WORD	1
	.LONG	P1R10L3
	.WORD	1
	.LONG	P1R10L4
	.WORD	1
	.LONG	P1R10L5
	.WORD	1
	.LONG	P1R10L6
	.WORD	1
	.LONG	P1R10L7
	.WORD	1
	.LONG	0
FPWK_DNLFT:	
	.LONG	P1RN8L1
	.WORD	FLIPBITS|1,0
	.LONG	P1RN8L2
	.WORD	1
	.LONG	P1RN8L3
	.WORD	1
	.LONG	P1RN8L4
	.WORD	1
	.LONG	P1RN8L5
	.WORD	1
	.LONG	P1RN8L6
	.WORD	1
	.LONG	P1RN8L7
	.WORD	1
	.LONG	P1RN8L8
	.WORD	1
	.LONG	0
FPWK_LFT:	
	.LONG	P1RN9L1
	.WORD	FLIPBITS|1,0
	.LONG	P1RN9L2
	.WORD	1
	.LONG	P1RN9L3
	.WORD	1
	.LONG	P1RN9L4
	.WORD	1
	.LONG	P1RN9L5
	.WORD	1
	.LONG	P1RN9L6
	.WORD	1
	.LONG	P1RN9L7
	.WORD	1
	.LONG	P1RN9L8
	.WORD	1
	.LONG	0
FPWK_UPLFT:	
	.LONG	P1R10L1
	.WORD	FLIPBITS|1,0
	.LONG	P1R10L2
	.WORD	1
	.LONG	P1R10L3
	.WORD	1
	.LONG	P1R10L4
	.WORD	1
	.LONG	P1R10L5
	.WORD	1
	.LONG	P1R10L6
	.WORD	1
	.LONG	P1R10L7
	.WORD	1
	.LONG	0
FPWK_DNRGT:	
	.LONG	P1RN8L1
	.WORD	FLIPBITS|1,(M_FLIPH)
	.LONG	P1RN8L2
	.WORD	1
	.LONG	P1RN8L3
	.WORD	1
	.LONG	P1RN8L4
	.WORD	1
	.LONG	P1RN8L5
	.WORD	1
	.LONG	P1RN8L6
	.WORD	1
	.LONG	P1RN8L7
	.WORD	1
	.LONG	P1RN8L8
	.WORD	1
	.LONG	0

TWK_UP:
	.LONG	P1TH12L1
	.WORD	FLIPBITS|4,0
	.LONG	P1TH12L2
	.WORD	4
	.LONG	0
TWK_DN:			
	.LONG	P1TH6L1
	.WORD	FLIPBITS|4,0
	.LONG	P1TH6L2
	.WORD	4
	.LONG	0
TWK_RGT:	
	.LONG	P1TH9L1
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1TH9L2
	.WORD	4
	.LONG	0
TWK_UPRGT:	
	.LONG	P1TH10L1
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1TH10L2
	.WORD	4
	.LONG	0
TWK_DNLFT:	
	.LONG	P1TH8L1
	.WORD	FLIPBITS|4,0
	.LONG	P1TH8L2
	.WORD	4
	.LONG	0
TWK_LFT:	
	.LONG	P1TH9L1
	.WORD	FLIPBITS|4,0
	.LONG	P1TH9L2
	.WORD	4
	.LONG	0
TWK_UPLFT:	
	.LONG	P1TH10L1
	.WORD	FLIPBITS|4,0
	.LONG	P1TH10L2
	.WORD	4
	.LONG	0
TWK_DNRGT:	
	.LONG	P1TH8L1
	.WORD	FLIPBITS|4,(M_FLIPH)
	.LONG	P1TH8L2
	.WORD	4
	.LONG	0




;SUBLZR		.EQU	0001H		;REGULAR LAZER SHOTS
;SUBSPRY	.EQU	0002H		;SPRAY SUB TYPE
;SUBFIRE1	.EQU	0003H		;FIRE BALL WPN
;SUBGRND	.EQU	0004H		;GRENADE
;SUBNOSTP	.EQU	0005H		;NON STOPPING BULLET
;SUBSPDG1	.EQU	0006H		;MACHINE GUN TYP WPN
WPNWALK:
;BULLET SUB TYPES
	.LONG	T_WALK_LIST,T_WALK_LIST,T_WALK_LIST2,T_WALK_LIST3,T_WALK_LIST4
	.LONG	T_WALK_LIST5,T_WALK_LIST6,T_WALK_LIST

T_WALK_LIST:	;REGULAR GUN
	.LONG	P1WG12T1,P1WG12T1,P1WG6T1,P1WG12T1,P1WG9T1,P1WG10T1,P1WG8T1,P1WG9T1
	.LONG	P1WG10T1,P1WG8T1
T_WALK_LIST2:	;SPRAY GUN
	.LONG	P1WG12T1,P1SPRDWG12,P1SPRDWG6,P1SPRDWG12,P1SPRDWG9,P1SPRDWG10
	.LONG	P1SPRDWG8,P1SPRDWG9
	.LONG	P1SPRDWG10,P1SPRDWG8
T_WALK_LIST3:	;FLAME THROWER
	.LONG	P1WG12T1,P1FLAMR12,P1FLAMR6,P1FLAMR12,P1FLAMR9,P1FLAMR10,P1FLAMR8,P1FLAMR9
	.LONG	P1FLAMR10,P1FLAMR8
T_WALK_LIST4:	;GRENADE
	.LONG	P1GR12T1,P1GR12T1,P1GR6T1,P1GR12T1,P1GR9T1,P1GR10T1,P1GR8T1,P1GR9T1
	.LONG	P1GR10T1,P1GR8T1
T_WALK_LIST5:	;NON STOPPING BULLET
	.LONG	P1LARS12,P1LARS12,P1LARS6,P1LARS12,P1LARS9,P1LARS10,P1LARS8,P1LARS9
	.LONG	P1LARS10,P1LARS8
T_WALK_LIST6:	;MACHINE GUN WEAPON
	.LONG	P1MGUN12,P1MGUN12,P1MGUN6,P1MGUN12,P1MGUN9,P1MGUN10,P1MGUN8,P1MGUN9
	.LONG	P1MGUN10,P1MGUN8

T_WALK_FLG:
	.LONG	DMAWNZ+M_NOCOLL,DMAWNZ+M_NOCOLL,DMAWNZ+M_NOCOLL,DMAWNZ+M_NOCOLL,DMAWNZ+M_NOCOLL+M_FLIPH
	.LONG	DMAWNZ+M_NOCOLL+M_FLIPH
	.LONG	DMAWNZ+M_NOCOLL+M_FLIPH,DMAWNZ+M_NOCOLL
	.LONG	DMAWNZ+M_NOCOLL,DMAWNZ+M_NOCOLL
L_WALK_FLG:
	.LONG	DMAWNZ+M_NOCOLL,DMAWNZ+0,DMAWNZ+0,DMAWNZ+M_NOCOLL,DMAWNZ+0+M_FLIPH
	.LONG	DMAWNZ+0+M_FLIPH
	.LONG	DMAWNZ+0+M_FLIPH,DMAWNZ+0
	.LONG	DMAWNZ+0,DMAWNZ+0

TSHK:
	.LONG	PSHOCK1
	.WORD	3
	.LONG	PSHOCK3
	.WORD	3
	.LONG	PSHOCK4
	.WORD	3
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	3
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	4
	.LONG	PSHOCK8
	.WORD	2


;	.LONG	PSHOCK5
;	.WORD	5
;	.LONG	PSHOCK6
;	.WORD	4
;	.LONG	PSHOCK7
;	.WORD	6
;	.LONG	PSHOCK8
;	.WORD	4
;	.LONG	PSHOCK5
;	.WORD	6
;	.LONG	PSHOCK6
;	.WORD	5
;	.LONG	PSHOCK7
;	.WORD	6
;	.LONG	PSHOCK8
;	.WORD	5
	.LONG	PSHOCK5
	.WORD	2
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	2
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	2
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	2
	.LONG	PSHOCK8
	.WORD	2
	.LONG	PSHOCK5
	.WORD	2
	.LONG	PSHOCK6
	.WORD	2
	.LONG	PSHOCK7
	.WORD	2
	.LONG	PSHOCK8
	.WORD	2


;	.LONG	PSHOCK4
;	.WORD	2
;	.LONG	PSHOCK3
;	.WORD	2
;	.LONG	PSHOCK1
;	.WORD	2
	.LONG	0
;


**************************************************************************
;		
; TEMP ROUTINES
;
**************************************************************************
	.IF DEBUG
	
StCpuLft:
	move	@TIMER,A0,W
	jrz	NoBog
	clr	A0
	jruc	GotTime
NoBog:
	move	@vcount,A0
	subi	HSINT,A0	
	jrnn	SkIncCnt
	addi	256,A0
SkIncCnt:
	sll	2,A0
	neg	A0
	addi	1024,A0
GotTime:
	move	A0,@CPULEFT,W

	srl	4,A0
	move	@CPUAVG,A1,W
	move	A1,A2
	srl	4,A2
	sub	A2,A1
	add	A0,A1
	move	A1,@CPUAVG,W

	rets
	.ENDIF





**************************************************************************
*									 *
* ERRORLOG - THIS SHOULD BE CALLED IN PLACE OF ANY JRxx $		 *
*		IN CASE OF ERROR. IF WE ARE IN DEBUG MODE		 *
*		IT WILL HANG, IF NOT, THE ERROR WILL BE LOGGED		 *
*		AND IT WILL RETURN.					 *
*		A1 = RETURN ADDRESS OF CALLING ROUTINE			 *
*		A2 = ERROR CODE 					 *
**************************************************************************
ERRORLOG
;	MMTM	SP,A2,A3,A4,A5,A6,A7
;	SLL	16,A2
ERRLOGG				;A8 IS IN A8

;	MOVE	A13,A7		;PROC. BLOCK IN A7
;	MOVE	*A7(PROCID),A6,W
;	SLL	16,A6
;	MOVE	*A8(OID),A3,W
;	MOVX	A3,A6		;A6 = [PROCID:*A8(OID)]		

;	MOVE	@CIRCUIT,A5,W
;	SLL	16,A5
;	MOVE	@WAVE,A3,W
;	MOVX	A3,A5		;A5 = [CIRCUIT#:WAVE#,)]

;	MOVI	AUD1STRT,A4	;PLAY #
;	CALLR	GETAUD4

;	SLL	16,A4
;	MOVE	*A0(OID),A3,W	;A4 = [STRT#:*A0(OID)]
;	MOVX	A3,A4

;	MOVE	@GAMSTATE,A3,W	;A2 = [STATUS:GAMSTATE]
;	MOVX	A3,A2

;	MOVE	@STATUS,A3,W	;A2 = [ERROR CODE:STATUS]
;	MOVX	A3,A2
				
;	MOVE	*SP(0C0H),A3,L	;A3=GET THE RETURN ADDRESS
;	MOVE	*SP(0E0H),A1,L	;A1=CALLING ADDRESS
;	CALLA	ADD_DUMP

;	MOVE	@SURVCNT,A2,W
;	INC	A2		;INCREMENT THE SURVIVAL COUNT
;	MOVE	A2,@SURVCNT,W

;	MMFM	SP,A2,A3,A4,A5,A6,A7
	RETS

**************************************************************************
*									 *
* GETAUD4 - GET AN AUDIT						 *
* A4 = AUDIT #								 *
* RETURNS:								 *
* A4 = AUDIT								 *
*									 *
**************************************************************************
;GETAUD4
;	MMTM	SP,A0,A1
;	MOVE	A4,A0
;	CALLA	GET_AUD
;	CALLA	DEF_PAGE	     ;POINT AT DEFAULT PAGE.
;	MOVE	A1,A4
;	MMFM	SP,A0,A1
;	RETS



	.END


